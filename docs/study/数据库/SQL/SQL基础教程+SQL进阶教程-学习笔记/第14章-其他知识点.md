# 第14章 其他知识点

------

## 1、生成连续编号

先建一张 Digits 表：

| digit |
| ----- |
| 0     |
| 1     |
| 2     |
| 3     |
| 4     |
| 5     |
| 6     |
| 7     |
| 8     |
| 9     |

```sql
-- 方法一：直接求（如1~542） 

SELECT D1.digit + (D2.digit * 10) + (D3.digit * 100) AS seq
FROM Digits D1 
CROSS JOIN Digits D2
CROSS JOIN Digits D3
WHERE D1.digit + (D2.digit * 10) + (D3.digit * 100) BETWEEN 1 AND 542
ORDER BY seq;

-- 方法二、先生成视图待用

-- 1、生成序列视图（包含0~999）
CREATE VIEW Sequence (seq)
AS SELECT D1.digit + (D2.digit * 10) + (D3.digit * 100)
FROM Digits D1 CROSS JOIN Digits D2
CROSS JOIN Digits D3;

-- 2、从序列视图中获取1~100
SELECT seq
FROM Sequence
WHERE seq BETWEEN 1 AND 100
ORDER BY seq;
```

> 有了这个连续编号，我们可以接着干很多事，具体可参考原书。

## 2、想尽一切办法隐藏地址

精巧的数据结构搭配笨拙的代码，远远好过笨拙的数据结构搭配精巧的代码。——大教堂与集市

### （1）大家一起摆脱地址

即使放眼 SQL 之外的其他编程语言，各个编程语言的历史中也都一直存在着“**如何对程序员隐藏地址**”的课题。**与 C 语言以及汇编语言相比，Pascal、Java、Perl 等新一代的语言都在努力地对用户隐藏指针。在这一点上，关系数据库与 SQL 的发展轨迹是一致的。**

> 如 C 的指针，在 Java / Python 中被`引用`代替。
>
> 引用类似指针，只是不能进行指针运算，比如不能用 p + 1 指向下一个元素。

可能会有人列举出用户可以使用的指针，比如 **Oracle 中的 rowid 或 PostgreSQL 中的 oid** 来反对。确实，用户可以使用这些指针，但是它们都是个别数据库厂商违反 SQL 标准而进行的扩展，而标准 SQL一直在努力摆脱指针。

### （2）为什么要隐藏地址

例如，SQL 和数据库都在极力提升数据在**表现层**的抽象度，以及对用户隐藏**物理层**的概念。

**因此放弃地址的深刻意义是，通过放弃掉系统中没有意义的东西，创造出一个易于人类理解的有意义的世界。**

### （3）隐藏地址要怎么做

《程序设计能从冯·诺依曼风格中解放出来吗？程序的函数风格及其代数》中提到，**只要使用变量，就无法逃出地址的魔咒**。反过来说，之所以SQL 能成为不依赖于地址的自由的语言，也是因为它不使用变量。

> 其实 SQL 还是有变量的，也可以理解成它是个别数据库厂商违反 SQL 标准而进行的扩展吧。

与 SQL 一样不使用变量的语言还有 Lisp。它是一种年龄仅次于 Fortran 的高级语言，已经可以称得上是编程语言中的“老将”。

## 3、SQL 是一种什么语言

SQL 很大程度上是一种`声明式编程`，但是其也**含有过程式编程**的元素。

例如，关联子查询是为了使 SQL 能够实现类似面向过程语言中循环的功能而引入的。

> SQL 在设计之初，就有意地避免了循环。所以 SQL 中没有专门的循环语句。
>
> 虽然可以使用游标实现循环，但是这样的话还是面向过程的做法。

所以，我们用好 SQL，就要有**从面向过程思维向声明式思维、面向集合思维转变**的意识。

## 4、[拓展] 命令式编程 vs 声明式编程

区别：

- `命令式编程（Imperative）`（也叫：**过程式编程**）：详细的去命令机器怎么（How）去处理一件事情以达到你想要的结果（What）
- `声明式编程（Declarative）`：只告诉你想要的结果（What），机器自己摸索过程（How）

例如：

- c / c++，JAVA，JavaScript 等都是命令式编程语言。
- SQL、正则表达式，或者逻辑语言（如 Prolog）等都是声明式语言。

我的观点：

1、**所有的 命令式编程 本质上也是 声明式编程**。底层还是会有交给机器自己处理的（How）步骤。

2、在命令式编程 也可以”创造”出 声明式编程，如 JavaScript 中使用 lodash 库，等于（How）步骤交给 lodash 去处理。
