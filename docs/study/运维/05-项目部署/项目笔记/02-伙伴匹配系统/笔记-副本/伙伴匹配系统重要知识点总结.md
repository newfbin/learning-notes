# ä¼™ä¼´åŒ¹é…ç³»ç»Ÿé‡è¦çŸ¥è¯†ç‚¹æ€»ç»“





> ä¸‹é¢çš„æ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­æ ¹æ®é±¼çš®è¯´çš„é‡è¦çŸ¥è¯†ç‚¹åšä¸€äº›æ€»ç»“ï¼šä¸»è¦æ€»ç»“çš„æ˜¯åç«¯
>



# åç«¯
## 1. åˆ†å¸ƒå¼ Session ç™»å½•
### é—®é¢˜å¼•å…¥
ç§ session çš„æ—¶å€™æ³¨æ„èŒƒå›´ï¼Œcookie.domain



æ¯”å¦‚æˆ‘ç°åœ¨æœ‰ä¸€ä¸‹ä¸¤ä¸ªåŸŸåï¼š  
A.com

B.com

å¦‚æœæˆ‘çš„cookieæ˜¯åœ¨äº†A.com ä¸Šï¼Œå¦‚æœB.comæƒ³è®¿é—®A.comç§çš„cookieèƒ½ä¸èƒ½è®¿é—®å¾—åˆ°ï¼Ÿ

> cookieï¼šå°±æ˜¯å‰ç«¯ç”¨æ¥å­˜å‚¨ä¸€éƒ¨åˆ†æ•°æ®ï¼Œé€šè¿‡Pathå°±èƒ½å‘åå°å‘é€è¯·æ±‚ã€‚
>



+ ç­”æ¡ˆï¼šä¸èƒ½è®¿é—®åˆ°çš„
+ å› ä¸ºæˆ‘ä»¬çš„cookieç§åœ¨çš„A.com çš„åŸŸåä¸Šï¼Œå³ä½¿B.comé€šè¿‡å‰å°å‘é€è¯·æ±‚ç»™åå°ï¼Œå› ä¸ºB.comå‘åå°å‘é€è¯·æ±‚æ—¶æ˜¯ä¸ä¼šå¾…ä¸ŠA.comè¿™ä¸ªcookieçš„ã€‚



å¦‚æœè¦å…±äº« cookieï¼Œå¯ä»¥ç§ä¸€ä¸ªæ›´é«˜å±‚çš„å…¬å…±åŸŸåï¼Œæ¯”å¦‚ shier.com Â  ï¼Œé‚£ä¹ˆåœ¨å­å±‚çš„åŸŸåå°±èƒ½å…±äº«åˆ°cookieï¼ŒA.comå’ŒB.comè¿™ä¸¤ä¸ªåŸŸåå°±èƒ½å…·æœ‰åŒä¸€ä¸ªcookie



### é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šä¸ºä»€ä¹ˆæœåŠ¡å™¨ A ç™»å½•åï¼Œè¯·æ±‚å‘åˆ°æœåŠ¡å™¨ Bï¼Œä¸è®¤è¯†è¯¥ç”¨æˆ·ï¼Ÿ


ç”¨æˆ·åœ¨ A ç™»å½•ï¼Œæ‰€ä»¥ sessionï¼ˆç”¨æˆ·ç™»å½•ä¿¡æ¯ï¼‰å­˜åœ¨äº† A ä¸Šã€‚



å½“ç”¨æˆ·å»è¯·æ±‚ BæœåŠ¡å™¨æ—¶ï¼ŒBæœåŠ¡å™¨ç§å¹¶æ²¡æœ‰å­˜å‚¨åˆ°æ”¹ç”¨æˆ·ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸è®¤è¯†ã€‚  
![1668525160193-9dd27f40-5c5f-4738-9972-15d4629ab6ff.png](./img/tLE1kK_x4TtWawQm/1668525160193-9dd27f40-5c5f-4738-9972-15d4629ab6ff-683420.png)



#### è§£å†³æ–¹æ¡ˆï¼šå®ç°å…±äº«å­˜å‚¨


ç”¨æˆ·aç™»å½•ä¹‹åï¼Œåœ¨aæœåŠ¡å™¨ç™»é™†ä¹‹åï¼Œå¾€è¿™ä¸ªåœ°æ–¹å†™å…¥ç”¨æˆ·ä¿¡æ¯ï¼Œç„¶åç”¨æˆ·Bä»–å°±å»è¯»è¿™ä¸ªç”¨æˆ·ä¿¡æ¯ï¼Œè¿™æ ·å°±èƒ½è®¿é—®åˆ°åŒä¸€ä¸ªå­˜å‚¨å†…å®¹



å°±æ˜¯å°†ç”¨æˆ·çš„ä¿¡æ¯å­˜å‚¨åˆ°ä¸€ä¸ªå…¬å…±çš„æœåŠ¡å™¨å†…å­˜ä¸­ï¼Œä¸è¦å°†ä¿¡æ¯å­˜å‚¨åˆ°å•å°æœåŠ¡å™¨çš„å†…å­˜ä¸­



![1668525160243-e6864277-b56d-4dff-9b38-670cb7f6ab6b.png](./img/tLE1kK_x4TtWawQm/1668525160243-e6864277-b56d-4dff-9b38-670cb7f6ab6b-225325.png)



### å¦‚ä½•å…±äº«æ•°æ®å­˜å‚¨ï¼Ÿå®ç°æ–¹å¼ï¼š


1. Redisï¼ˆåŸºäºå†…å­˜çš„ K / V æ•°æ®åº“ï¼‰ 
    - å› ä¸ºç”¨æˆ·ä¿¡æ¯è¯»å– / æ˜¯å¦ç™»å½•çš„åˆ¤æ–­æå…¶ **é¢‘ç¹** ï¼ŒRedis åŸºäºå†…å­˜ï¼Œè¯»å†™æ€§èƒ½å¾ˆé«˜ï¼Œç®€å•çš„æ•°æ®å•æœº qps 5w - 10w
    - QPSï¼šæ„æ€æ˜¯æ¯ç§’æŸ¥è¯¢ç‡ã€‚æŒ‡ä¸€å°æœåŠ¡å™¨æ¯ç§’èƒ½å¤Ÿå“åº”çš„æŸ¥è¯¢æ¬¡æ•°ï¼Œç”¨äºè¡¡é‡ç‰¹å®šçš„æŸ¥è¯¢æœåŠ¡å™¨åœ¨è§„å®šæ—¶é—´å†…æ‰€å¤„ç†æµé‡å¤šå°‘ï¼Œä¸»è¦é’ˆå¯¹ä¸“é—¨ç”¨äºæŸ¥è¯¢çš„æœåŠ¡å™¨çš„æ€§èƒ½æŒ‡æ ‡
2. MySQL
3. æ–‡ä»¶æœåŠ¡å™¨ ceph



### Redis å®ç° Session å…±äº«


å®˜ç½‘ï¼š[https://redis.io/](https://redis.io/)



Redis 5.0.14 ä¸‹è½½ï¼š



é“¾æ¥ï¼š[https://pan.baidu.com/s/1XcsAIrdeesQAyQU2lE3cOg](https://pan.baidu.com/s/1XcsAIrdeesQAyQU2lE3cOg)



æå–ç ï¼švkoi



redis ç®¡ç†å·¥å…· quick redisï¼š[https://quick123.net/](https://quick123.net/)



1. å¼•å…¥ redisï¼Œèƒ½å¤Ÿæ“ä½œ redisï¼š



```xml
<!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-data-redis -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-redis</artifactId>
    <version>2.6.4</version>
</dependency>
```



2. å¼•å…¥ spring-session å’Œ redis çš„æ•´åˆï¼Œä½¿å¾—è‡ªåŠ¨å°† session å­˜å‚¨åˆ° redis ä¸­ï¼š



```xml
<!-- https://mvnrepository.com/artifact/org.springframework.session/spring-session-data-redis -->
<dependency>
    <groupId>org.springframework.session</groupId>
    <artifactId>spring-session-data-redis</artifactId>
    <version>2.6.3</version>
</dependency>
```



3. ä¿®æ”¹ spring-session å­˜å‚¨é…ç½® `spring.session.store-type`



+  é»˜è®¤æ˜¯ noneï¼Œè¡¨ç¤ºå­˜å‚¨åœ¨å•å°æœåŠ¡å™¨ 
+  store-type: redisï¼Œè¡¨ç¤ºä» redis è¯»å†™ session 

```yaml
# session å¤±æ•ˆæ—¶é—´
session:
  timeout: 86400
  store-type: redis
```

 



JWTä¹Ÿèƒ½å®ç°Sessionå…±äº«æ•°æ®ï¼Œä½†æ˜¯å­˜åœ¨ç¼ºç‚¹ï¼š[https://zhuanlan.zhihu.com/p/108999941](https://zhuanlan.zhihu.com/p/108999941)



## 2. åˆ†å¸ƒå¼é”ï¼ˆåŸºäº redissonï¼‰


[åˆ†å¸ƒå¼é”ä»‹ç»](https://blog.csdn.net/m0_67645544/article/details/124768505)

å•æœºé”ï¼šç”¨äº**ä¸€å°**æœåŠ¡å™¨çš„åŒæ­¥æ‰§è¡Œ

åˆ†å¸ƒå¼é”ï¼šç”¨äº**å¤šå°**æœåŠ¡å™¨ä¹‹é—´çš„åŒæ­¥æ‰§è¡Œ

### 2.1é”ä»‹ç»
æœ‰é™èµ„æºçš„æƒ…å†µä¸‹ï¼Œæ§åˆ¶åŒä¸€æ—¶é—´ï¼ˆæ®µï¼‰åªæœ‰æŸäº›çº¿ç¨‹ï¼ˆç”¨æˆ· / æœåŠ¡å™¨ï¼‰èƒ½è®¿é—®åˆ°èµ„æºã€‚  
Java å®ç°é”ï¼šsynchronized å…³é”®å­—ã€å¹¶å‘åŒ…çš„ç±»  
Java synchronized å®ç°é”å­˜åœ¨é—®é¢˜ï¼šåªå¯¹å•ä¸ª JVM æœ‰æ•ˆ



### 2.2 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”
åˆ†å¸ƒå¼é”ï¼Œå³[åˆ†å¸ƒå¼ç³»ç»Ÿ](https://so.csdn.net/so/search?q=%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F&spm=1001.2101.3001.7020)ä¸­çš„é”ã€‚

åœ¨å•ä½“åº”ç”¨ä¸­æˆ‘ä»¬é€šè¿‡é”è§£å†³çš„æ˜¯**æ§åˆ¶å…±äº«èµ„æºè®¿é—®**çš„é—®é¢˜ï¼Œè€Œåˆ†å¸ƒå¼é”ï¼Œå°±æ˜¯è§£å†³äº†**åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ§åˆ¶å…±äº«èµ„æºè®¿é—®**çš„é—®é¢˜ã€‚ä¸å•ä½“åº”ç”¨ä¸åŒçš„æ˜¯ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ç«äº‰å…±äº«èµ„æºçš„æœ€å°ç²’åº¦ä»çº¿ç¨‹å‡çº§æˆäº†è¿›ç¨‹ã€‚



### 2.3 ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼é”ğŸŒŸğŸŒŸğŸŒŸï¼ˆé¢è¯•è€ƒç‚¹ï¼‰


1. æœ‰é™èµ„æºçš„æƒ…å†µä¸‹ï¼Œæ§åˆ¶åŒä¸€æ—¶é—´ï¼ˆæ®µï¼‰åªæœ‰æŸäº›çº¿ç¨‹ï¼ˆç”¨æˆ· / æœåŠ¡å™¨ï¼‰èƒ½è®¿é—®åˆ°èµ„æºã€‚
2. å•ä¸ªé”åªå¯¹å•ä¸ª JVM æœ‰æ•ˆ
3. åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œä¸€ä¸ªæ–¹æ³•åœ¨åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªæœºå™¨çš„ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ
4. é«˜å¯ç”¨çš„è·å–é”ä¸é‡Šæ”¾é”
5. é«˜æ€§èƒ½çš„è·å–é”ä¸é‡Šæ”¾é”
6. å…·å¤‡å¯é‡å…¥ç‰¹æ€§ï¼ˆå¯ç†è§£ä¸ºé‡æ–°è¿›å…¥ï¼Œç”±å¤šäºä¸€ä¸ªä»»åŠ¡å¹¶å‘ä½¿ç”¨ï¼Œè€Œä¸å¿…æ‹…å¿ƒæ•°æ®é”™è¯¯ï¼‰
7. å…·å¤‡é”å¤±æ•ˆæœºåˆ¶ï¼Œå³è‡ªåŠ¨è§£é”ï¼Œé˜²æ­¢æ­»é”
8. å…·å¤‡éé˜»å¡é”ç‰¹æ€§ï¼Œå³æ²¡æœ‰è·å–åˆ°é”å°†ç›´æ¥è¿”å›è·å–é”å¤±è´¥



### 2.4 åˆ†å¸ƒå¼é”å®ç°
æ€ä¹ˆä¿è¯åŒä¸€æ—¶é—´åªæœ‰ 1 ä¸ªæœåŠ¡å™¨èƒ½æŠ¢åˆ°é”ï¼Ÿ

**æ ¸å¿ƒæ€æƒ³** å°±æ˜¯ï¼šå…ˆæ¥çš„äººå…ˆæŠŠæ•°æ®æ”¹æˆè‡ªå·±çš„æ ‡è¯†ï¼ˆæœåŠ¡å™¨ ipï¼‰ï¼Œåæ¥çš„äººå‘ç°æ ‡è¯†å·²å­˜åœ¨ï¼Œå°±æŠ¢é”å¤±è´¥ï¼Œç»§ç»­ç­‰å¾…ã€‚ç­‰å…ˆæ¥çš„äººæ‰§è¡Œæ–¹æ³•ç»“æŸï¼ŒæŠŠæ ‡è¯†æ¸…ç©ºï¼Œå…¶ä»–çš„äººç»§ç»­æŠ¢é”ã€‚



#### å®ç°æ–¹å¼
[ä¸‰ç§å®ç°æ–¹å¼](https://mp.weixin.qq.com/s?__biz=MzU0OTE4MzYzMw==&mid=2247534770&idx=3&sn=397788f05d0a664495e23959701ab703&chksm=fbb1c14cccc6485aeed1311213f7c06ddb4d15073e8d0c638ea423ea68954fd4c703afb8023e&scene=27)

1. MySQL æ•°æ®åº“ï¼šselect for update è¡Œçº§é”ï¼ˆæœ€ç®€å•ï¼‰
2. âœ” Redis å®ç°ï¼šå†…å­˜æ•°æ®åº“ï¼Œ**è¯»å†™é€Ÿåº¦å¿«** ã€‚æ”¯æŒ **setnx**ã€lua è„šæœ¬ï¼Œæ¯”è¾ƒæ–¹ä¾¿æˆ‘ä»¬å®ç°åˆ†å¸ƒå¼é”ã€‚
3. setnxï¼šset if not exists å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è®¾ç½®ï¼›åªæœ‰è®¾ç½®æˆåŠŸæ‰ä¼šè¿”å› trueï¼Œå¦åˆ™è¿”å› false



### 2.4 åˆ†å¸ƒå¼é”æ³¨æ„äº‹é¡¹
1.  ç”¨å®Œé”è¦é‡Šæ”¾ï¼ˆä¸èƒ½å ç€èŒ…å‘ä¸æ‹‰å±ï¼‰ 
2.  **é”ä¸€å®šè¦åŠ è¿‡æœŸæ—¶é—´ ** 
3.  å¦‚æœæ–¹æ³•æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œé”æå‰è¿‡æœŸäº†ï¼Œé—®é¢˜ï¼š 
    1. è¿é”æ•ˆåº”ï¼šé‡Šæ”¾æ‰åˆ«äººçš„é”
    2. è¿™æ ·è¿˜æ˜¯ä¼šå­˜åœ¨å¤šä¸ªæ–¹æ³•åŒæ—¶æ‰§è¡Œçš„æƒ…å†µ

è§£å†³æ–¹æ¡ˆï¼šç»­æœŸ 



```plain
boolean end = false;
new Thread(() -> {
 Â  Â if (!end)}{
 Â  Â ç»­æœŸ
})
end = true;
```



4.  é‡Šæ”¾é”çš„æ—¶å€™ï¼Œæœ‰å¯èƒ½å…ˆåˆ¤æ–­å‡ºæ˜¯è‡ªå·±çš„é”ï¼Œä½†è¿™æ—¶é”è¿‡æœŸäº†ï¼Œæœ€åè¿˜æ˜¯é‡Šæ”¾äº†åˆ«äººçš„é” 
5.  Redis å¦‚æœæ˜¯é›†ç¾¤ï¼ˆè€Œä¸æ˜¯åªæœ‰ä¸€ä¸ª Redisï¼‰ï¼Œå¦‚æœåˆ†å¸ƒå¼é”çš„æ•°æ®ä¸åŒæ­¥æ€ä¹ˆåŠï¼Ÿ 



```plain
// åŸå­æ“ä½œ
if(get lock == A) {
 Â  Â // set lock B
 Â  Â del lock
}
```



#### çœ‹é—¨ç‹—æœºåˆ¶


> redisson ä¸­æä¾›çš„ç»­æœŸæœºåˆ¶
>



å¼€ä¸€ä¸ªç›‘å¬çº¿ç¨‹ï¼Œå¦‚æœæ–¹æ³•è¿˜æ²¡æ‰§è¡Œå®Œï¼Œå°±å¸®ä½ é‡ç½® redis é”çš„è¿‡æœŸæ—¶é—´ã€‚



åŸç†ï¼š



1. ç›‘å¬å½“å‰çº¿ç¨‹ï¼Œé»˜è®¤è¿‡æœŸæ—¶é—´æ˜¯ 30 ç§’ï¼Œæ¯ 10 ç§’ç»­æœŸä¸€æ¬¡ï¼ˆè¡¥åˆ° 30 ç§’ï¼‰
2. å¦‚æœçº¿ç¨‹æŒ‚æ‰ï¼ˆæ³¨æ„ debug æ¨¡å¼ä¹Ÿä¼šè¢«å®ƒå½“æˆæœåŠ¡å™¨å®•æœºï¼‰ï¼Œåˆ™ä¸ä¼šç»­æœŸ



### 2.5 Redisson å®ç°åˆ†å¸ƒå¼é”
Redisson-å…·æœ‰å†…å­˜æ•°æ®ç½‘æ ¼åŠŸèƒ½çš„Redis Javaå®¢æˆ·ç«¯ã€‚è¶…è¿‡50ä¸ªåŸºäºRedisçš„Javaå¯¹è±¡å’ŒæœåŠ¡ï¼šSetã€Multimapã€SortedSetã€Mapã€Listã€Queueã€Dequeã€Semaphoreã€Lockã€AtomicLongã€MapReduceã€Publish/Subscribeã€Bloom filterã€Spring Cacheã€Tomcatã€Schedulerã€JCache APIã€Hibernateã€MyBatisã€RPCã€æœ¬åœ°ç¼“å­˜ã€‚ã€‚ã€‚



Redisson æ˜¯ä¸€ä¸ª java æ“ä½œ Redis çš„å®¢æˆ·ç«¯ï¼Œ**æä¾›äº†å¤§é‡çš„åˆ†å¸ƒå¼æ•°æ®é›†æ¥ç®€åŒ–å¯¹ Redis çš„æ“ä½œå’Œä½¿ç”¨ï¼Œå¯ä»¥è®©å¼€å‘è€…åƒä½¿ç”¨æœ¬åœ°é›†åˆä¸€æ ·ä½¿ç”¨ Redisï¼Œå®Œå…¨æ„ŸçŸ¥ä¸åˆ° Redis çš„å­˜åœ¨ã€‚**



### ä¼™ä¼´åŒ¹é…ç³»ç»Ÿä¸­çš„åˆ†å¸ƒå¼é”å®ç°è¿‡ç¨‹


1.  å¼•å…¥ä¾èµ– 

```xml
<dependency>
    <groupId>org.redisson</groupId>
    <artifactId>redisson</artifactId>
    <version>3.19.1</version>
</dependency>
```

 

2.  é…ç½® 

```yaml
# redis é…ç½®
spring:
  redis:
    port: 6379
    host: localhost
    database: 1
```

 

3.  RedisConfigç±»å‹ 

```java
import lombok.Data;
import org.redisson.Redisson;
import org.redisson.api.RedissonClient;
import org.redisson.config.Config;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

/**
 * redisson é…ç½®ç±»
 * @author daqi
 * @date 2023/1/22
 */
@Configuration
@ConfigurationProperties("spring.redis")
@Data
public class RedissonConfig {

    private String host;

    private String port; 
    @Bean
    public RedissonClient redissonClient() {
        // 1. Create config object
        Config config = new Config();
        String redisAddress = String.format("redis://%s:%s",host,port);
        config.useSingleServer().setAddress(redisAddress).setDatabase(3);
        RedissonClient redissonClient = Redisson.create(config);
        return redissonClient;

    }
}
```

 

4.  ä½¿ç”¨ 

```java
// é¡¹ç›®ï¼šç±»ï¼šæ–¹æ³•ï¼šé”
RLock lock = redissonClient.getLock("yupao:precachejob:doCache:lock");
try {
    // tryLock ï¼ˆæœ€é•¿å–é”æ—¶é—´ï¼Œè¶…æ—¶ falseï¼›è¿‡æœŸæ—¶é—´ï¼Œæ‰§è¡Œæ—¶é—´è¶…è¿‡è¿‡æœŸæ—¶é—´ï¼Œé”å°†é‡Šæ”¾ï¼›æ—¶é—´å•ä½ï¼‰
    // è¿‡æœŸæ—¶é—´ä½¿ç”¨ -1 å¯ä»¥ç»­æœŸï¼›ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯äººèµ°äº†ï¼Œä¸‹ä¸ªäººè¿›æ¥çš„æ—¶é—´ï¼Œ0 è¡¨ç¤ºåªæ‰§è¡Œä¸€æ¬¡
    if(lock.tryLock(0,-1,TimeUnit.MILLISECONDS)){
        System.out.println("currentLock:" + Thread.currentThread().getId());
        // ä¾‹å­ --------------
        for (Long userId : userIds) {
                    ValueOperations<String, Object> redisOps = redisTemplate.opsForValue();
                    String redisKey = String.format("yupao:user:recommend:%s",userId);
                    QueryWrapper<User> queryWrapper = new QueryWrapper<>();
                    Page<User> userPage = userService.page(new Page<>(1, 20), queryWrapper)
       
            // å­˜å…¥ç¼“å­˜
            try {
                redisOps.set(redisKey,userPage,1, TimeUnit.MINUTES);
            } catch (Exception e) {
                log.error("redis set key error",e);
            }
        }
    }
    // è¦åŠ é”çš„é€»è¾‘ä»£ç  -----------------
} catch (InterruptedException e) {
    log.error("PreCacheJob error",e);
} finally {
    if (lock.isHeldByCurrentThread()) {
        System.out.println("unlock:" + Thread.currentThread().getId());
        lock.unlock();
    }
}
```

 



## 3. ç¼“å­˜ï¼ˆRediså®ç°ï¼‰


### 3.1 ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜
ç”¨æˆ·æ•°é‡å¾ˆå¤§ï¼Œå¯¼è‡´æ•°æ®æŸ¥è¯¢æ…¢ï¼Œå¯¼è‡´é¡µé¢åŠ è½½çš„æ—¶é—´è¿‡é•¿

### 3.2 ç¼“å­˜çš„å®ç°


1. Redisï¼šåˆ†å¸ƒå¼ç¼“å­˜
2. memcachedï¼šåˆ†å¸ƒå¼
3. Etcdï¼šäº‘åŸç”Ÿæ¶æ„çš„ä¸€ä¸ªåˆ†å¸ƒå¼å­˜å‚¨ï¼Œ**å­˜å‚¨é…ç½®**ï¼Œæ‰©å®¹èƒ½åŠ›
4. ehcacheï¼šå•æœº
5. æœ¬åœ°ç¼“å­˜ï¼šJava å†…å­˜ Map
6. Caffeineï¼šJava å†…å­˜ç¼“å­˜ï¼Œé«˜æ€§èƒ½
7. Google Guava



å•æœºç¼“å­˜å­˜åœ¨çš„é—®é¢˜ï¼š



1. å¾—åˆ°çš„æ•°æ®ä¸ä¸€è‡´
2. è·å–ä¸åˆ°èµ„æº



åˆ†å¸ƒå¼ç¼“å­˜ï¼š



1. ç”¨æˆ·è®¿é—®ä¸åŒçš„æœåŠ¡å™¨èƒ½è·å¾—åˆ°ç›¸åŒçš„èµ„æºæ•°æ®
2. ä¹Ÿå°±æ˜¯åœ¨ä¸€ä¸ªå…¬å…±çš„æœåŠ¡å™¨ä¸Šå­˜å‚¨æ•°æ®ï¼Œå…¶ä»–çš„æœåŠ¡å™¨éƒ½è®²æ•°æ®è¯»å†™åœ¨è¿™ä¸ªæœåŠ¡å™¨ä¸Š



### 3.3 ä»€ä¹ˆæ˜¯Redisç¼“å­˜


1. NoSQL æ•°æ®åº“
2. key - value å­˜å‚¨ç³»ç»Ÿï¼ˆåŒºåˆ«äº MySQLï¼Œä»–å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹ï¼‰ 
    - ä¸æ˜¯å­˜é‚£ç§è¡¨æ ¼ä¹‹ç±»çš„æ•°æ®ï¼Œä¸åƒæ•°æ®åº“å­˜å‚¨ä¸€è¡Œä¸€è¡Œçš„æ•°æ®ï¼Œè€Œæ˜¯å­˜å‚¨é”®å€¼å¯¹çš„æ•°æ®

### 3.4 Redisæ•°æ®ç»“æ„ğŸŒŸğŸŒŸğŸŒŸï¼ˆé¢è¯•é«˜é¢‘è€ƒç‚¹ï¼‰
> å­˜å‚¨é”®å€¼å¯¹
>



åŸºæœ¬æ•°æ®ç»“æ„



1. String å­—ç¬¦ä¸²ç±»å‹ï¼š name: "shier"
2. List åˆ—è¡¨ï¼šnames: ["shier", "xiaoshier", "shier1"]ï¼šé•¿åº¦åŠ¨æ€çš„ã€å¯å˜çš„ æ•°ç»„çš„æ˜¯å›ºå®šçš„
3. Set é›†åˆï¼šnames: ["shier", "dogshier"]ï¼š å€¼ä¸èƒ½é‡å¤
4. Hash å“ˆå¸Œï¼šnameAge: { "shier": 1, "dogshier": 2 }
5. Zset é›†åˆï¼šnames: { shier- 9, dogshier - 12 }ï¼ˆé€‚åˆåšæ’è¡Œæ¦œï¼‰Zsetçš„å€¼ä¼šä¸€ä¸ªå…³è”åˆ†æ•°



é«˜çº§æ•°æ®ç»“æ„



1. bloomfilterï¼šå¸ƒéš†è¿‡æ»¤å™¨ï¼Œä¸»è¦ä»å¤§é‡çš„æ•°æ®ä¸­å¿«é€Ÿè¿‡æ»¤å€¼ï¼Œæ¯”å¦‚é‚®ä»¶é»‘åå•æ‹¦æˆª
2. geoï¼šè®¡ç®—åœ°ç†ä½ç½®
3. hyperloglogï¼špv / uv
4. pub / subï¼šå‘å¸ƒè®¢é˜…ï¼Œç±»ä¼¼æ¶ˆæ¯é˜Ÿåˆ—
5. BitMap ï¼š1001010101010101010101010101 äºŒè¿›åˆ¶æ•°æ®



### 3.5Javaé‡ŒRedisçš„å®ç°æ–¹å¼
#### Spring Data Redisï¼ˆæ¨èï¼‰
Spring Dataï¼šé€šç”¨çš„æ•°æ®è®¿é—®æ¡†æ¶ï¼Œå®šä¹‰äº†ä¸€ç»„ **å¢åˆ æ”¹æŸ¥** çš„æ¥å£

#### Jedis
ç‹¬ç«‹äº Spring æ“ä½œ Redis çš„ Java å®¢æˆ·ç«¯  
è¦é…åˆ Jedis Pool ä½¿ç”¨

#### Lettuce
**é«˜é˜¶** çš„æ“ä½œ Redis çš„ Java å®¢æˆ·ç«¯  
å¼‚æ­¥ã€è¿æ¥æ± 

#### Redisson
åˆ†å¸ƒå¼æ“ä½œ Redis çš„ Java å®¢æˆ·ç«¯ï¼Œè®©ä½ åƒåœ¨ä½¿ç”¨æœ¬åœ°çš„é›†åˆä¸€æ ·æ“ä½œ Redisï¼ˆåˆ†å¸ƒå¼ Redis æ•°æ®ç½‘æ ¼ï¼‰

#### JetCache
å®ç°æ–¹å¼å¯¹æ¯”

1. å¦‚æœä½ ç”¨çš„æ˜¯ Springï¼Œå¹¶ä¸”æ²¡æœ‰è¿‡å¤šçš„å®šåˆ¶åŒ–è¦æ±‚ï¼Œå¯ä»¥ç”¨ Spring Data Redisï¼Œæœ€æ–¹ä¾¿
2. å¦‚æœä½ ç”¨çš„ä¸æ˜¯ SPringï¼Œå¹¶ä¸”è¿½æ±‚ç®€å•ï¼Œå¹¶ä¸”æ²¡æœ‰è¿‡é«˜çš„æ€§èƒ½è¦æ±‚ï¼Œå¯ä»¥ç”¨ Jedis + Jedis Pool
3. å¦‚æœä½ çš„é¡¹ç›®ä¸æ˜¯ Springï¼Œå¹¶ä¸”è¿½æ±‚é«˜æ€§èƒ½ã€é«˜å®šåˆ¶åŒ–ï¼Œå¯ä»¥ç”¨ Lettuceï¼Œæ”¯æŒå¼‚æ­¥ã€è¿æ¥æ± 
4. å¦‚æœä½ çš„é¡¹ç›®æ˜¯åˆ†å¸ƒå¼çš„ï¼Œéœ€è¦ç”¨åˆ°ä¸€äº›åˆ†å¸ƒå¼çš„ç‰¹æ€§ï¼ˆæ¯”å¦‚åˆ†å¸ƒå¼é”ã€åˆ†å¸ƒå¼é›†åˆï¼‰ï¼Œæ¨èç”¨ redisson



### 3.6 å®ç°å®šæ—¶é¢„çƒ­ç¼“å­˜
#### ä»€ä¹ˆæ˜¯çƒ­ç¼“å­˜


+ æ•°æ®é‡å¤§æ—¶ï¼Œå¯ä»¥æå‰å°†æ•°æ®æå‰å†™å…¥ç¼“å­˜ï¼Œæé«˜ç¬¬ä¸€æ¬¡è®¿é—®çš„æ•°æ®
+ è§£å†³ç¬¬ä¸€æ¬¡è®¿é—®æ—¶é—´è¿‡é•¿ï¼Œå¤ªé•¿æ—¶é—´åŠ è½½ä¸å‡ºæ¥é¡µé¢ï¼Œä½†æ˜¯åé¢çš„è®¿é—®é¡µé¢å°±ä¸ä¼šå­˜åœ¨è®¿é—®é¡µé¢æ—¶é—´è¿‡é•¿
+ æå‰å°†ç›¸å…³çš„ç¼“å­˜æ•°æ®ç›´æ¥åŠ è½½åˆ°ç¼“å­˜ç³»ç»Ÿã€‚é¿å…åœ¨ç”¨æˆ·è¯·æ±‚çš„æ—¶å€™ï¼Œå…ˆæŸ¥è¯¢æ•°æ®åº“ï¼Œç„¶åå†å°†æ•°æ®ç¼“å­˜çš„é—®é¢˜ï¼ç”¨æˆ·ç›´æ¥æŸ¥è¯¢äº‹å…ˆè¢«é¢„çƒ­çš„ç¼“å­˜æ•°æ®ï¼

#### ä»€ä¹ˆæ—¶å€™ç”¨ç¼“å­˜é¢„çƒ­
1. ç¬¬ä¸€æ¬¡è®¿é—®æ—¶é—´æ¯”è¾ƒé•¿ï¼Œä½†æ˜¯åé¢çš„è®¿é—®æ—¶é—´å°±å¾ˆå¿«ä¸€ç‚¹ã€‚
2. ç¬¬ä¸€æ¬¡è¿›å…¥ç³»ç»Ÿçš„åŠ è½½æ—¶é—´è¿‡é•¿

#### ç¼“å­˜é¢„çƒ­å¸¦æ¥çš„é—®é¢˜
1. å¢åŠ å¼€å‘æˆæœ¬ï¼ˆä½ è¦é¢å¤–çš„å¼€å‘ã€è®¾è®¡ï¼‰
2. é¢„çƒ­çš„æ—¶æœºå’Œæ—¶é—´å¦‚æœé”™äº†ï¼Œæœ‰å¯èƒ½ä½ ç¼“å­˜çš„æ•°æ®ä¸å¯¹æˆ–è€…å¤ªè€
3. éœ€è¦å ç”¨é¢å¤–ç©ºé—´

#### æ€ä¹ˆå®ç°ç¼“å­˜é¢„çƒ­
1. ç›´æ¥å†™ä¸ªç¼“å­˜åˆ·æ–°é¡µé¢ï¼Œä¸Šçº¿æ—¶æ‰‹å·¥æ“ä½œä¸‹ã€‚
2. æ•°æ®é‡ä¸å¤§ï¼Œå¯ä»¥åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨è¿›è¡ŒåŠ è½½ã€‚
3. å®šæ—¶ä»»åŠ¡ï¼Œå®šæ—¶åˆ·æ–°ç¼“å­˜

#### é¢„çƒ­ç¼“å­˜çš„æ³¨æ„ç‚¹
1. ç¼“å­˜é¢„çƒ­çš„æ„ä¹‰ï¼ˆæ–°å¢å°‘ã€æ€»ç”¨æˆ·å¤šï¼‰
2. ç¼“å­˜çš„ç©ºé—´ä¸èƒ½å¤ªå¤§ï¼Œè¦é¢„ç•™ç»™å…¶ä»–ç¼“å­˜ç©ºé—´
3. ç¼“å­˜æ•°æ®çš„å‘¨æœŸï¼ˆæ­¤å¤„æ¯å¤©ä¸€æ¬¡ï¼‰



#### ç¼“å­˜é¢„çƒ­ - å®šæ—¶ä»»åŠ¡
1. åœ¨å¯åŠ¨ç±»ä¸ŠåŠ æ³¨è§£



```java
@EnableScheduling
public class UserCenterApplication {
    public static void main(String[] args) {
        SpringApplication.run(UserCenterApplication.class, args);
    }
}
```



2.  åœ¨æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£ 

```java
// cron ç§’ åˆ† æ—¶ æ—¥ æœˆ å¹´ï¼ˆæ¯å¤©è¿™ä¸€åˆ»æ‰§è¡Œï¼‰
@Scheduled(cron = "0 26 22 * * *")
public void doPreCacheRecommendUser() {}
```

 



### ä¼™ä¼´åŒ¹é…ç³»ç»Ÿé¡¹ç›®ä¸­Redisä½¿ç”¨è¯´æ˜


> ä½¿ç”¨ spring-boot-starter-data-redis æ“ä½œ redis
>



1. å¼•å…¥ä¾èµ–



```xml

<!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-data-redis -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-redis</artifactId>
    <version>2.6.4</version>
</dependency>
```



2.  ä½¿ç”¨ 

```java
// å­˜å€¼
redisTemplate.opsForValue().set("yupiInt",1);
// å–å€¼
String yupiString = (String) redisTemplate.opsForValue().get("yupiString");
```

 

3.  å…¶ä»–é…ç½®ï¼ˆä½¿æ”¯æŒ RedisTemplate<String,Object>ï¼‰ 

```java
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.serializer.RedisSerializer;

@Configuration
public class RedisTemplateConfig {

    @Bean
    public RedisTemplate<String,Object> redisTemplate(RedisConnectionFactory redisConnectionFactory) {
        RedisTemplate<String, Object> redisTemplate = new RedisTemplate<>();
        redisTemplate.setConnectionFactory(redisConnectionFactory);
        redisTemplate.setKeySerializer(RedisSerializer.string());
        return redisTemplate;
    }
}
```

 



> ä½¿ç”¨ spring-session-data-redis **è‡ªåŠ¨åŒæ­¥** session æ•°æ®åˆ° redis ä¸­ï¼Œå®ç° **session å…±äº«**
>



1. ä¾èµ–



```xml
<!-- https://mvnrepository.com/artifact/org.springframework.session/spring-session-data-redis -->
<dependency>
    <groupId>org.springframework.session</groupId>
    <artifactId>spring-session-data-redis</artifactId>
    <version>2.6.3</version>
</dependency>
```



2.  é…ç½® 

```yaml
spring:
  # session é…ç½®ï¼Œè¿‡æœŸæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
  session:
    timeout: 86400
    store-type: redis
```

 

3.  ä½¿ç”¨ 

```java
request.getSession().setAttribute(USER_LOGIN_STATE, safetyUser);
```

 



![](https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16782/image-20230126193925931.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_37%2Ctext_U2hpZXI%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10)



## 4. Swagger + knife4j æ¥å£æ–‡æ¡£
> ä¸ªäººæ„Ÿè§‰è¿˜æ˜¯Knife4jæ¥å£æ–‡æ¡£çœ‹èµ·æ¥æ›´åŠ æ¸…æ™°ä¸€ç‚¹ï¼Œçœ‹èµ·æ¥èˆ’æœä¸€ç‚¹ï¼Œå’Œpostmantå·®ä¸å¤šï¼ŒåŠŸèƒ½ä¸åŒ
>

### 4.1 æ¥å£æ–‡æ¡£ä»‹ç»ï¼š
#### ä»€ä¹ˆæ˜¯æ¥å£æ–‡æ¡£
å†™æ¥å£ä¿¡æ¯çš„æ–‡æ¡£ï¼Œå…¶ä¸­æ¯æ¡æ¥å£åŒ…æ‹¬ä¸€ä¸‹çš„å‚æ•°ä¿¡æ¯ï¼š

+ è¯·æ±‚å‚æ•°
+ å“åº”å‚æ•° 
    - é”™è¯¯ç 
+ æ¥å£åœ°å€
+ æ¥å£åç§°
+ è¯·æ±‚ç±»å‹
+ è¯·æ±‚æ ¼å¼
+ å¤‡æ³¨ç­‰ç­‰



> ä¸€èˆ¬æ˜¯åç«¯æˆ–è€…è´Ÿè´£äººæ¥æä¾›ï¼Œåç«¯å’Œå‰ç«¯éƒ½è¦ä½¿ç”¨
>



#### ä¸ºä»€ä¹ˆéœ€è¦æ¥å£æ–‡æ¡£ï¼Ÿ


+ æœ‰ä¸ªä¹¦é¢å†…å®¹ï¼ˆèƒŒä¹¦æˆ–è€…å½’æ¡£ï¼‰ï¼Œä¾¿äºå¤§å®¶å‚è€ƒå’ŒæŸ¥é˜…ï¼Œä¾¿äº **æ²‰æ·€å’Œç»´æŠ¤** ï¼Œæ‹’ç»å£å£ç›¸ä¼ 
+ æ¥å£æ–‡æ¡£ä¾¿äºå‰ç«¯å’Œåç«¯å¼€å‘å¯¹æ¥ï¼Œå‰åç«¯è”è°ƒçš„ **ä»‹è´¨** ã€‚åç«¯ => æ¥å£æ–‡æ¡£ <= å‰ç«¯
+ å¥½çš„æ¥å£æ–‡æ¡£æ”¯æŒåœ¨çº¿è°ƒè¯•ã€åœ¨çº¿æµ‹è¯•ï¼Œå¯ä»¥ä½œä¸ºå·¥å…·æé«˜æˆ‘ä»¬çš„å¼€å‘æµ‹è¯•æ•ˆç‡

#### æ€ä¹ˆåšæ¥å£æ–‡æ¡£ï¼Ÿ
+ æ‰‹å†™ï¼ˆæ¯”å¦‚è…¾è®¯æ–‡æ¡£ã€Markdown ç¬”è®°ï¼‰
+ è‡ªåŠ¨åŒ–æ¥å£æ–‡æ¡£ç”Ÿæˆï¼šè‡ªåŠ¨æ ¹æ®é¡¹ç›®ä»£ç ç”Ÿæˆå®Œæ•´çš„æ–‡æ¡£æˆ–åœ¨çº¿è°ƒè¯•çš„ç½‘é¡µã€‚Swaggerï¼ŒPostmanï¼ˆä¾§é‡æ¥å£ç®¡ç†ï¼‰ï¼ˆå›½å¤–ï¼‰ï¼›apifoxã€apipostã€eolinkï¼ˆå›½äº§ï¼‰

#### æ¥å£æ–‡æ¡£æœ‰å“ªäº›æŠ€å·§ï¼Ÿ
Swagger åŸç†ï¼š



1. å¼•å…¥ä¾èµ–ï¼ˆSwagger æˆ– Knife4jï¼šhttps://doc.xiaominfo.com/knife4j/documentation/get_start.htmlï¼‰
2. è‡ªå®šä¹‰ Swagger é…ç½®ç±»
3. å®šä¹‰éœ€è¦ç”Ÿæˆæ¥å£æ–‡æ¡£çš„ä»£ç ä½ç½®ï¼ˆControllerï¼‰
4. åƒä¸‡æ³¨æ„ï¼šçº¿ä¸Šç¯å¢ƒä¸è¦æŠŠæ¥å£æš´éœ²å‡ºå»ï¼ï¼ï¼å¯ä»¥é€šè¿‡åœ¨ SwaggerConfig é…ç½®æ–‡ä»¶å¼€å¤´åŠ ä¸Š `@Profile({"dev", "test"})` é™å®šé…ç½®ä»…åœ¨éƒ¨åˆ†ç¯å¢ƒå¼€å¯
5. å¯åŠ¨å³å¯
6. å¯ä»¥é€šè¿‡åœ¨ controller æ–¹æ³•ä¸Šæ·»åŠ  [@Apiã€@ApiImplicitParam(name ](/Apiã€@ApiImplicitParam(name ) = "name",value = "å§“å",required = true) Â  Â [@ApiOperation(value ](/ApiOperation(value ) = "å‘å®¢äººé—®å¥½") ç­‰æ³¨è§£æ¥è‡ªå®šä¹‰ç”Ÿæˆçš„æ¥å£æè¿°ä¿¡æ¯ 



### å®ç°æ­¥éª¤


1.  ä¾èµ– 

```xml
<dependency>
    <groupId>com.github.xiaoymin</groupId>
    <artifactId>knife4j-openapi2-spring-boot-starter</artifactId>
    <version>4.0.0</version>
</dependency>
```

 

2.  é€šè¿‡applicationè¿›è¡Œé…ç½®  
é¢„è§ˆï¼šhttp://localhost:8080/api/doc.htmlï¼ˆä¾‹å­ä¸­ç«¯å£è¦æ›´æ”¹ï¼Œ/api/ æ˜¯é¡¹ç›®ä¸­åŠ çš„è·¯å¾„ï¼‰ 

```yaml
knife4j:
  enable: true
  # å¼€å¯ç”Ÿäº§ç¯å¢ƒå±è”½
#  production: true
  openapi:
    title: é±¼çš®ç”¨æˆ·ä¸­å¿ƒç®¡ç†
    description: ç”¨æˆ·ä¸­å¿ƒ
    # aaa"
    email: xiaoymin@foxmail.com
    concat: å…«ä¸€èœåˆ€
    url: https://cymgc.top
    version: v4.0
    license: Apache 2.0
    license-url: https://stackoverflow.com/
    terms-of-service-url: https://stackoverflow.com/
    group:
      test1:
        group-name: ç”¨æˆ·ä¸­å¿ƒ api
        api-rule: package
        api-rule-resources:
          - com.yupi.usercenter.controller
```

3.  é€šè¿‡Javaå†™Configç±»æ¥å®ç°ï¼ˆç¬¬äºŒå’Œç¬¬ä¸‰æœ‰ä¸€ç§å³å¯ï¼‰ 

```java
package com.shier.partner.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.ApiInfo;
import springfox.documentation.service.Contact;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;

/**
 * @author Shier
 * @date 2023/02/02
 * è‡ªå®šä¹‰ Swagger æ¥å£æ–‡æ¡£çš„é…ç½®
 */

@Configuration
@EnableSwagger2WebMvc
@Profile({"dev", "test"})   //ç‰ˆæœ¬æ§åˆ¶è®¿é—®
public class SwaggerConfig {

    @Bean(value = "defaultApi2")
    public Docket defaultApi2() {
        return new Docket(DocumentationType.SWAGGER_2)
                .apiInfo(apiInfo())
                .select()
                // è¿™é‡Œä¸€å®šè¦æ ‡æ³¨ä½ æ§åˆ¶å™¨çš„ä½ç½®
                .apis(RequestHandlerSelectors.basePackage("com.shier.partner.controller"))
                .paths(PathSelectors.any())
                .build();
    }

    /**
     * api ä¿¡æ¯
     * @return
     */
    private ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title("ç”¨æˆ·ä¸­å¿ƒ-ä¼™ä¼´åŒ¹é…ç³»ç»Ÿ") // æ¥å£æ–‡æ¡£çš„æ ‡é¢˜
                .description("ç”¨æˆ·ä¸­å¿ƒæ¥å£æ–‡æ¡£-ä¼™ä¼´åŒ¹é…ç³»ç»Ÿ") // æ¥å£æ–‡æ¡£çš„æè¿°ä¿¡æ¯
                .termsOfServiceUrl("https://github.com/kongshier") // æä¾›æœåŠ¡çš„æ˜¯è°ï¼Ÿå¯ä»¥å¡«å†™ä½ è‡ªå·±çš„åœ°å€å› ä¸ºæ˜¯ä½ è‡ªå·±æä¾›çš„æœåŠ¡
                .contact(new Contact("shier", "https://blog.csdn.net/qq_56098191?spm=1000.2115.3001.5343", "2927527234@qq.com"))
                .version("1.0") // ç‰ˆæœ¬
                .build(); // æ„å»º
    }
}
```



## 5. Json åºåˆ—åŒ– ï¼ˆGsonï¼‰
è§£æ JSON å­—ç¬¦ä¸²ï¼š

+  åºåˆ—åŒ–ï¼šjavaå¯¹è±¡è½¬æˆ json 
+  ååºåˆ—åŒ–ï¼šæŠŠ json è½¬ä¸º java å¯¹è±¡ 



Javajson åºåˆ—åŒ–åº“æœ‰å¾ˆå¤šï¼š



1.  **gson**ï¼ˆgoogle çš„ï¼‰ 
2.  fastjson alibabaï¼ˆali å‡ºå“ï¼Œå¿«ï¼Œä½†æ˜¯æ¼æ´å¤ªå¤šï¼‰ 
3.  jackson 
4.  kryo 



```java
Gson gson = new Gson();
int[] ints = {1, 2, 3, 4, 5};
String[] strings = {"abc", "def", "ghi"};

// åºåˆ—åŒ–å
gson.toJson(ints);     //  [1,2,3,4,5]
gson.toJson(strings);  //  ["abc", "def", "ghi"]
```



1.  ä¾èµ– 

```xml
<!-- https://mvnrepository.com/artifact/com.google.code.gson/gson -->
<dependency>
    <groupId>com.google.code.gson</groupId>
    <artifactId>gson</artifactId>
    <version>2.9.0</version>
</dependency>
```

 

2.  ä½¿ç”¨ 

```java
Gson gson = new Gson();
// 3. æ ‡ç­¾åˆ—è¡¨è½¬ä¸º java å¯¹è±¡ï¼Œéå†ç”¨æˆ·ä¼ è¿‡æ¥çš„æ ‡ç­¾åå­—ï¼Œåˆ¤æ–­æ˜¯å¦åŒ…å«åœ¨æ ‡ç­¾åˆ—è¡¨ä¸­
Set<String> tempTagSet = gson.fromJson(tagJsonStr, new TypeToken<Set<String>>() {
}.getType());
tempTagSet = Optional.ofNullable(tempTagSet).orElse(new HashSet<>())
```

 

## 6. è·¨åŸŸé—®é¢˜
> ä¸€èˆ¬æ˜¯åœ¨åç«¯è§£å†³è·¨åŸŸé—®é¢˜å¥½ä¸€ç‚¹
>
>  
>
> + JSONP
> + CORS
>



### 6.1 å‰ç«¯è§£å†³è·¨åŸŸ
è¯¦æƒ…çœ‹æ–‡æ¡£https://blog.csdn.net/qq_56098191/article/details/128473269?spm=1001.2014.3001.5501

### 6.2 åç«¯è§£å†³è·¨åŸŸ


åœ¨æ§åˆ¶å™¨ï¼ˆControllerï¼‰ç±»ä¸Šæ·»åŠ  [@CrossOrigin ](/CrossOrigin ) æ³¨è§£ï¼Œå¹¶å…è®¸ cookie ä¼ é€’ 



```java
@RestController
@RequestMapping("/user")
@CrossOrigin(origins = {"http://localhost:3000"},allowCredentials = "true")
public class UserController {}
```



## 9. ç¼–è¾‘è·ç¦»ç®—æ³•
ç¼–è¾‘è·ç¦»ç®—æ³•ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­ä¸ç›®æ ‡æœ€ç›¸ä¼¼çš„å€¼ï¼Œè¿”å›éœ€è¦é€šè¿‡å¢åˆ æ”¹æ“ä½œåå˜æˆç›®æ ‡å€¼çš„æœ€å°æ­¥éª¤



> æœ€å°ç¼–è¾‘è·ç¦»ï¼šå­—ç¬¦ä¸²1 é€šè¿‡æœ€å°‘å¤šå°‘æ¬¡å¢åˆ æ”¹å­—ç¬¦çš„æ“ä½œå¯ä»¥å˜æˆ å­—ç¬¦ä¸²2
>
>  
>
> 1. ["Java","ç”·","å¤§ä¸€","ç¯®çƒ"]
> 2. ["Python","å¥³","å¤§å››","è¶³çƒ","è·‘æ­¥"]	5æ¬¡
> 3. ["Java","å¥³","å¤§ä¸‰","ä¹’ä¹“çƒ"] Â  3æ¬¡
> 4. ["Java","ç”·","å¤§äºŒ","ä¹’ä¹“çƒ"] Â 2æ¬¡
> 5. ["Python","å¥³","å¤§å››","ä¹’ä¹“çƒ"] Â 4æ¬¡
> 6. ["Java","ç”·","å¤§äºŒ","ç¯®çƒ"] 1æ¬¡
>
>  
>
> åœ¨ç¬¬ä¸€æ¡æ”¹å˜åˆ°å…¶ä»–äº”æ¡ï¼ˆä¸åŒ…æ‹¬ç¬¬ä¸€æ¡ï¼‰ï¼Œæ”¹å˜æ¬¡æ•°æœ€å°çš„åœ¨å‰é¢ï¼Œæœ€åçš„é¡ºåº(åºå·æ’åº)æ˜¯ï¼š6=>4=>3=>5=>2
>
>  
>
> æ“ä½œæ¬¡æ•°è¶Šå°ï¼Œè¶Šé è¿‘ã€‚
>



```java
import java.util.List;
import java.util.Objects;

/**
 * @author daqi
 * @date 2023/1/25
 */
public class AlgorithmUtils {

    public static int minDistance(List<String> tagList1, List<String> tagList2){
        int n = tagList1.size();
        int m = tagList2.size();

        if(n * m == 0)
            return n + m;

        int[][] d = new int[n + 1][m + 1];
        for (int i = 0; i < n + 1; i++){
            d[i][0] = i;
        }

        for (int j = 0; j < m + 1; j++){
            d[0][j] = j;
        }

        for (int i = 1; i < n + 1; i++){
            for (int j = 1; j < m + 1; j++){
                int left = d[i - 1][j] + 1;
                int down = d[i][j - 1] + 1;
                int left_down = d[i - 1][j - 1];
                if (!Objects.equals(tagList1.get(i - 1), tagList2.get(j - 1)))
                    left_down += 1;
                d[i][j] = Math.min(left, Math.min(down, left_down));
            }
        }
        return d[n][m];
    }

    /**
     * ç¼–è¾‘ç®—æ³•ï¼Œåˆ¤æ–­ç›¸ä¼¼å­—ç¬¦ä¸²
     * @param word1
     * @param word2
     * @return
     */
    public static int minDistance(String word1, String word2){
        int n = word1.length();
        int m = word2.length();

        if(n * m == 0)
            return n + m;

        int[][] d = new int[n + 1][m + 1];
        for (int i = 0; i < n + 1; i++){
            d[i][0] = i;
        }

        for (int j = 0; j < m + 1; j++){
            d[0][j] = j;
        }

        for (int i = 1; i < n + 1; i++){
            for (int j = 1; j < m + 1; j++){
                int left = d[i - 1][j] + 1;
                int down = d[i][j - 1] + 1;
                int left_down = d[i - 1][j - 1];
                if (word1.charAt(i - 1) != word2.charAt(j - 1))
                    left_down += 1;
                d[i][j] = Math.min(left, Math.min(down, left_down));
            }
        }
        return d[n][m];
    }
}
```



## 10. äº‹åŠ¡
åœ¨æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£ @Transactionalï¼ŒrollbackFor ä¸ºå‘ç”ŸæŒ‡å®šçš„å¼‚å¸¸å°±å›æ»š

```java
@Transactional(rollbackFor = Exception.class)
public long addTeam(Team team, User userLogin) {}
```

# å‰ç«¯
Vantç»„ä»¶åº“ï¼š [https://vant-contrib.gitee.io/vant/#/zh-CN/home](https://vant-contrib.gitee.io/vant/#/zh-CN/home)

Viteæ‰“åŒ…å·¥å…·ï¼š[https://cn.vitejs.dev/](https://cn.vitejs.dev/)

## 1. å†™ css ä»£ç 
å¯ä»¥åœ¨æµè§ˆå™¨ä½¿ç”¨å¼€å‘è€…æ¨¡å¼ï¼ˆF12ï¼‰å†™æ ·å¼ï¼Œç„¶åç²˜è´´åˆ°ä»£ç ä¸­

## 2. è·¯ç”±
1. routerï¼šè´Ÿè´£è½¬å‘è·¯ç”±ï¼Œé¡µé¢ä¹‹é—´çš„è·³è½¬
2. routeï¼šè´Ÿè´£è·å–è·¯ç”±ä¼ é€’çš„æ•°æ®ï¼Œé¡µé¢ä¹‹é—´çš„æ•°æ®

## 3. å¼€å¯æºå¸¦ cookie
myAxios æ˜¯å¯¹ axios çš„è‡ªå®šä¹‰å°è£…

```javascript
// è®¾ç½®è¶…æ—¶æ—¶é—´
myAxios.defaults.timeout = 50000
// å¼€å¯æºå¸¦ cookie
myAxios.defaults.withCredentials = true
```

## 4. éƒ¨ç½²
### å‰ç«¯éƒ¨ç½²
Vercelï¼ˆå…è´¹ï¼‰

[https://vercel.com/](https://vercel.com/)

### åç«¯éƒ¨ç½²
å¾®ä¿¡äº‘æ‰˜ç®¡ï¼ˆéƒ¨ç½²å®¹å™¨çš„å¹³å°ï¼Œä»˜è´¹ï¼‰

[https://cloud.weixin.qq.com/cloudrun/service](https://cloud.weixin.qq.com/cloudrun/service)

ï¼ˆå…å¤‡æ¡ˆï¼ï¼ï¼ï¼‰



> æ›´æ–°: 2023-02-10 09:29:42  
> åŸæ–‡: <https://www.yuque.com/shierkcs/catstudy/rg6bx2u8nxkr1ts5>