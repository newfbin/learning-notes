## æœ¬èŠ‚é‡ç‚¹

å‰ç«¯é¡µé¢å¼€å‘ï¼Œè·‘é€šå‰åç«¯æ ¸å¿ƒä¸šåŠ¡æµç¨‹ï¼Œä¸»è¦åŒ…æ‹¬ï¼š

- åŸºç¡€é¡µé¢å¼€å‘
- - ç”¨æˆ·æ¨¡å—
  - é¢˜åº“ç®¡ç†é¡µé¢
  - é¢˜ç›®ç®¡ç†é¡µé¢
- æ ¸å¿ƒé¡µé¢å¼€å‘
- - ä¸»é¡µ
  - é¢˜åº“åˆ—è¡¨é¡µ
  - é¢˜ç›®æœç´¢é¡µ
  - é¢˜åº“è¯¦æƒ…é¡µ
  - é¢˜ç›®è¯¦æƒ…é¡µ
- é¢˜ç›®é¢˜åº“ç»‘å®šï¼ˆç®¡ç†å‘˜ï¼‰
- - æŒ‰ç…§é¢˜åº“æŸ¥è¯¢é¢˜ç›®
  - ä¿®æ”¹é¢˜ç›®æ‰€å±é¢˜åº“

## å‡†å¤‡å·¥ä½œ

åœ¨æœ¬ç« å¼€å§‹ä¹‹å‰ï¼Œå¯ä»¥å…ˆå‡†å¤‡ä¸€äº›ç¤ºä¾‹æ•°æ®ï¼Œä¾¿äºå‰ç«¯å¼€å‘æ—¶æŸ¥çœ‹æ•ˆæœã€‚

```scilab
-- åˆå§‹æ•°æ®
use mianshiya;

-- ç”¨æˆ·è¡¨åˆå§‹æ•°æ®ï¼ˆå¯†ç æ˜¯ 12345678ï¼‰
INSERT INTO user (id, userAccount, userPassword, unionId, mpOpenId, userName, userAvatar, userProfile, userRole)
VALUES (1, 'user1', 'b0dd3697a192885d7c055db46155b26a', 'unionId1', 'mpOpenId1', 'user1',
        'https://www.code-nav.cn/logo.png', 'å–œæ¬¢ç¼–ç¨‹çš„å°ç™½', 'user'),
       (2, 'user2', 'b0dd3697a192885d7c055db46155b26a', 'unionId2', 'mpOpenId2', 'user2',
        'https://www.code-nav.cn/logo.png', 'å…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆ', 'user'),
       (3, 'user3', 'b0dd3697a192885d7c055db46155b26a', 'unionId3', 'mpOpenId3', 'user3',
        'https://www.code-nav.cn/logo.png', 'å‰ç«¯çˆ±å¥½è€…', 'user'),
       (4, 'user4', 'b0dd3697a192885d7c055db46155b26a', 'unionId4', 'mpOpenId4', 'user4',
        'https://www.code-nav.cn/logo.png', 'åç«¯å¼€å‘å·¥ç¨‹å¸ˆ', 'user'),
       (5, 'yupi', 'b0dd3697a192885d7c055db46155b26a', NULL, NULL, 'ç¨‹åºå‘˜é±¼çš®', 'https://www.code-nav.cn/logo.png',
        'ç³»ç»Ÿç®¡ç†å‘˜', 'admin');

-- é¢˜åº“è¡¨åˆå§‹æ•°æ®
INSERT INTO question_bank (title, description, picture, userId)
VALUES ('JavaScript åŸºç¡€', 'åŒ…å« JavaScript çš„åŸºç¡€çŸ¥è¯†é¢˜ç›®',
        'https://pic.code-nav.cn/mianshiya/question_bank_picture/1777886594896760834/JldkWf9w_JavaScript.png', 1),
       ('CSS æ ·å¼', 'åŒ…å« CSS ç›¸å…³çš„æ ·å¼é—®é¢˜',
        'https://pic.code-nav.cn/mianshiya/question_bank_picture/1777886594896760834/QatnFmEN_CSS.png', 2),
       ('HTML åŸºç¡€', 'HTML æ ‡è®°è¯­è¨€çš„åŸºæœ¬çŸ¥è¯†', 'https://www.mianshiya.com/logo.png', 3),
       ('å‰ç«¯æ¡†æ¶', 'React, Vue, Angular ç­‰æ¡†æ¶ç›¸å…³çš„é¢˜ç›®', 'https://www.mianshiya.com/logo.png', 1),
       ('ç®—æ³•ä¸æ•°æ®ç»“æ„', 'æ•°æ®ç»“æ„å’Œç®—æ³•é¢˜ç›®', 'https://www.mianshiya.com/logo.png', 2),
       ('æ•°æ®åº“åŸç†', 'SQL è¯­å¥å’Œæ•°æ®åº“è®¾è®¡', 'https://www.mianshiya.com/logo.png', 3),
       ('æ“ä½œç³»ç»Ÿ', 'æ“ä½œç³»ç»Ÿçš„åŸºæœ¬æ¦‚å¿µ', 'https://www.mianshiya.com/logo.png', 1),
       ('ç½‘ç»œåè®®', 'HTTP, TCP/IP ç­‰ç½‘ç»œåè®®é¢˜ç›®', 'https://www.mianshiya.com/logo.png', 2),
       ('è®¾è®¡æ¨¡å¼', 'å¸¸è§è®¾è®¡æ¨¡å¼åŠå…¶åº”ç”¨', 'https://www.mianshiya.com/logo.png', 3),
       ('ç¼–ç¨‹è¯­è¨€æ¦‚è¿°', 'å¤šç§ç¼–ç¨‹è¯­è¨€çš„åŸºç¡€çŸ¥è¯†', 'https://www.mianshiya.com/logo.png', 1),
       ('ç‰ˆæœ¬æ§åˆ¶', 'Git å’Œ SVN çš„ä½¿ç”¨', 'https://www.mianshiya.com/logo.png', 2),
       ('å®‰å…¨ä¸åŠ å¯†', 'ç½‘ç»œå®‰å…¨å’ŒåŠ å¯†æŠ€æœ¯', 'https://www.mianshiya.com/logo.png', 3),
       ('äº‘è®¡ç®—', 'äº‘æœåŠ¡å’Œæ¶æ„', 'https://www.mianshiya.com/logo.png', 1),
       ('å¾®æœåŠ¡æ¶æ„', 'å¾®æœåŠ¡çš„è®¾è®¡ä¸å®ç°', 'https://www.mianshiya.com/logo.png', 2),
       ('å®¹å™¨æŠ€æœ¯', 'Docker å’Œ Kubernetes ç›¸å…³çŸ¥è¯†', 'https://www.mianshiya.com/logo.png', 3),
       ('DevOps å®è·µ', 'æŒç»­é›†æˆä¸æŒç»­äº¤ä»˜', 'https://www.mianshiya.com/logo.png', 1),
       ('æ•°æ®åˆ†æ', 'æ•°æ®åˆ†æå’Œå¯è§†åŒ–', 'https://www.mianshiya.com/logo.png', 2),
       ('äººå·¥æ™ºèƒ½', 'æœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ åŸºç¡€', 'https://www.mianshiya.com/logo.png', 3),
       ('åŒºå—é“¾æŠ€æœ¯', 'åŒºå—é“¾çš„åŸºæœ¬åŸç†å’Œåº”ç”¨', 'https://www.mianshiya.com/logo.png', 1),
       ('é¡¹ç›®ç®¡ç†', 'è½¯ä»¶å¼€å‘é¡¹ç›®çš„ç®¡ç†å’Œæ‰§è¡Œ', 'https://www.mianshiya.com/logo.png', 2);

-- é¢˜ç›®è¡¨åˆå§‹æ•°æ®
INSERT INTO question (title, content, tags, answer, userId)
VALUES ('JavaScript å˜é‡æå‡', 'è¯·è§£é‡Š JavaScript ä¸­çš„å˜é‡æå‡ç°è±¡ã€‚', '["JavaScript", "åŸºç¡€"]',
        'å˜é‡æå‡æ˜¯æŒ‡åœ¨ JavaScript ä¸­ï¼Œå˜é‡å£°æ˜ä¼šè¢«æå‡åˆ°ä½œç”¨åŸŸçš„é¡¶éƒ¨ã€‚', 1),
       ('CSS Flexbox å¸ƒå±€', 'å¦‚ä½•ä½¿ç”¨ CSS å®ç°ä¸€ä¸ªæ°´å¹³å±…ä¸­çš„ç›’å­ï¼Ÿ', '["CSS", "å¸ƒå±€"]',
        'å¯ä»¥ä½¿ç”¨ Flexbox å¸ƒå±€ï¼Œé€šè¿‡è®¾ç½®çˆ¶å®¹å™¨ display ä¸º flexï¼Œå¹¶ä½¿ç”¨ justify-content: center; å¯¹é½å­å…ƒç´ ã€‚', 2),
       ('HTML ä¸­çš„è¯­ä¹‰åŒ–', 'ä»€ä¹ˆæ˜¯ HTML çš„è¯­ä¹‰åŒ–ï¼Ÿä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ', '["HTML", "è¯­ä¹‰åŒ–"]',
        'HTML è¯­ä¹‰åŒ–æ˜¯ä½¿ç”¨æ­£ç¡®çš„æ ‡ç­¾æ¥æè¿°å†…å®¹çš„æ„ä¹‰ï¼Œèƒ½å¤Ÿæé«˜å¯è®¿é—®æ€§å’Œ SEO æ•ˆæœã€‚', 3),
       ('React ä¸­çš„çŠ¶æ€ç®¡ç†', 'å¦‚ä½•åœ¨ React ä¸­ç®¡ç†ç»„ä»¶çŠ¶æ€ï¼Ÿ', '["React", "çŠ¶æ€ç®¡ç†"]',
        'å¯ä»¥ä½¿ç”¨ React çš„ useState æˆ– useReducer é’©å­æ¥ç®¡ç†ç»„ä»¶çŠ¶æ€ï¼Œæˆ–ä½¿ç”¨ Redux è¿›è¡Œå…¨å±€çŠ¶æ€ç®¡ç†ã€‚', 1),
       ('ç®—æ³•ï¼šäºŒåˆ†æŸ¥æ‰¾', 'è¯·å®ç°ä¸€ä¸ªäºŒåˆ†æŸ¥æ‰¾ç®—æ³•ã€‚', '["ç®—æ³•", "æ•°æ®ç»“æ„"]',
        'äºŒåˆ†æŸ¥æ‰¾æ˜¯ä¸€ç§åœ¨æœ‰åºæ•°ç»„ä¸­æŸ¥æ‰¾ç‰¹å®šå…ƒç´ çš„ç®—æ³•ï¼Œé€šè¿‡ä¸æ–­æŠ˜åŠçš„æ–¹å¼ç¼©å°æŸ¥æ‰¾èŒƒå›´ã€‚', 2),
       ('æ•°æ®åº“ç´¢å¼•çš„ä½œç”¨', 'ä»€ä¹ˆæ˜¯æ•°æ®åº“ç´¢å¼•ï¼Ÿå®ƒçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ', '["æ•°æ®åº“", "ç´¢å¼•"]',
        'æ•°æ®åº“ç´¢å¼•æ˜¯ç”¨äºåŠ å¿«æŸ¥è¯¢é€Ÿåº¦çš„æ•°æ®ç»“æ„ï¼Œå®ƒé€šè¿‡ä¼˜åŒ–æŸ¥æ‰¾è·¯å¾„å‡å°‘æŸ¥è¯¢æ—¶é—´ã€‚', 3),
       ('HTTP ä¸ HTTPS çš„åŒºåˆ«', 'è¯·è§£é‡Š HTTP å’Œ HTTPS ä¹‹é—´çš„ä¸»è¦åŒºåˆ«ã€‚', '["ç½‘ç»œ", "åè®®"]',
        'HTTPS æ˜¯åŠ å¯†çš„ HTTPï¼Œé€šè¿‡ SSL/TLS æä¾›æ›´å®‰å…¨çš„æ•°æ®ä¼ è¾“ã€‚', 1),
       ('è®¾è®¡æ¨¡å¼ï¼šå•ä¾‹æ¨¡å¼', 'è¯·è§£é‡Šå•ä¾‹æ¨¡å¼çš„å®ç°åŠåº”ç”¨åœºæ™¯ã€‚', '["è®¾è®¡æ¨¡å¼", "å•ä¾‹"]',
        'å•ä¾‹æ¨¡å¼ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›å…¨å±€è®¿é—®ç‚¹ã€‚å¸¸ç”¨äºé…ç½®ç±»ç­‰åªéœ€ä¸€ä¸ªå®ä¾‹çš„åœºæ™¯ã€‚', 2),
       ('Git ä¸­çš„åˆ†æ”¯ç®¡ç†', 'å¦‚ä½•åœ¨ Git ä¸­ç®¡ç†åˆ†æ”¯ï¼Ÿ', '["ç‰ˆæœ¬æ§åˆ¶", "Git"]',
        'Git ä¸­é€šè¿‡ branch å‘½ä»¤åˆ›å»ºåˆ†æ”¯ï¼Œä½¿ç”¨ checkout åˆ‡æ¢åˆ†æ”¯ï¼Œä½¿ç”¨ merge åˆå¹¶åˆ†æ”¯ã€‚', 3),
       ('Docker çš„åŸºæœ¬å‘½ä»¤', 'åˆ—ä¸¾å¹¶è§£é‡Šå‡ ä¸ªå¸¸ç”¨çš„ Docker å‘½ä»¤ã€‚', '["å®¹å™¨æŠ€æœ¯", "Docker"]',
        'å¸¸ç”¨å‘½ä»¤åŒ…æ‹¬ docker run, docker build, docker ps, docker stop ç­‰ã€‚', 1),
       ('å‰ç«¯æ€§èƒ½ä¼˜åŒ–', 'åˆ—ä¸¾å‡ ä¸ªå‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„æ‰‹æ®µã€‚', '["å‰ç«¯", "æ€§èƒ½ä¼˜åŒ–"]',
        'åŒ…æ‹¬ä»£ç åˆ†å‰²ã€èµ„æºå‹ç¼©ã€ç¼“å­˜ç­–ç•¥ã€æ‡’åŠ è½½ç­‰ã€‚', 2),
       ('JavaScript é—­åŒ…çš„åº”ç”¨', 'ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿä¸¾ä¾‹è¯´æ˜é—­åŒ…çš„å®é™…åº”ç”¨ã€‚', '["JavaScript", "é«˜çº§"]',
        'é—­åŒ…æ˜¯æŒ‡å‡½æ•°èƒ½å¤Ÿè®°ä½åˆ›å»ºæ—¶çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå¸¸ç”¨äºæ•°æ®éšè—å’Œæ¨¡å—åŒ–ç¼–ç¨‹ã€‚', 3),
       ('æ•°æ®åº“äº‹åŠ¡çš„ç‰¹æ€§', 'è¯·è§£é‡Šæ•°æ®åº“äº‹åŠ¡çš„ ACID ç‰¹æ€§ã€‚', '["æ•°æ®åº“", "äº‹åŠ¡"]',
        'ACID ä»£è¡¨åŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§å’ŒæŒä¹…æ€§ï¼Œæ˜¯äº‹åŠ¡å¤„ç†çš„å››å¤§ç‰¹æ€§ã€‚', 1),
       ('CSS çš„ BEM å‘½åè§„èŒƒ', 'ä»€ä¹ˆæ˜¯ BEMï¼Ÿå¦‚ä½•ä½¿ç”¨ BEM è¿›è¡Œ CSS å‘½åï¼Ÿ', '["CSS", "å‘½åè§„èŒƒ"]',
        'BEM ä»£è¡¨å—ï¼ˆBlockï¼‰ã€å…ƒç´ ï¼ˆElementï¼‰å’Œä¿®é¥°ç¬¦ï¼ˆModifierï¼‰ï¼Œæ˜¯ä¸€ç§ CSS å‘½åè§„èŒƒã€‚', 2),
       ('JavaScript åŸå‹é“¾', 'è¯·è§£é‡Š JavaScript ä¸­çš„åŸå‹é“¾æœºåˆ¶ã€‚', '["JavaScript", "åŸå‹é“¾"]',
        'åŸå‹é“¾æ˜¯ JavaScript å®ç°ç»§æ‰¿çš„æœºåˆ¶ï¼Œå¯¹è±¡é€šè¿‡åŸå‹é“¾å¯ä»¥ç»§æ‰¿å…¶ä»–å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚', 3),
       ('React ç”Ÿå‘½å‘¨æœŸ', 'è¯·è¯´æ˜ React ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚', '["React", "ç”Ÿå‘½å‘¨æœŸ"]',
        'React ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬åˆå§‹åŒ–ã€æ›´æ–°å’Œå¸è½½ä¸‰ä¸ªé˜¶æ®µï¼Œå„é˜¶æ®µæœ‰ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚', 1),
       ('HTTP çŠ¶æ€ç  404 ä¸ 500 çš„åŒºåˆ«', 'è¯·è§£é‡Š HTTP çŠ¶æ€ç  404 å’Œ 500 çš„å«ä¹‰ã€‚', '["ç½‘ç»œ", "HTTP"]',
        '404 è¡¨ç¤ºæœªæ‰¾åˆ°èµ„æºï¼Œ500 è¡¨ç¤ºæœåŠ¡å™¨å†…éƒ¨é”™è¯¯ã€‚', 2),
       ('Python ä¸ Java çš„åŒºåˆ«', 'æ¯”è¾ƒ Python å’Œ Java çš„ä¸»è¦åŒºåˆ«ã€‚', '["ç¼–ç¨‹è¯­è¨€", "Python", "Java"]',
        'Python æ˜¯åŠ¨æ€ç±»å‹è¯­è¨€ï¼Œè¯­æ³•ç®€æ´ï¼Œè€Œ Java æ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œæ³¨é‡ä¸¥è°¨æ€§å’Œæ€§èƒ½ã€‚', 3),
       ('Vue çš„åŒå‘æ•°æ®ç»‘å®š', 'è¯·è§£é‡Š Vue.js æ˜¯å¦‚ä½•å®ç°åŒå‘æ•°æ®ç»‘å®šçš„ã€‚', '["Vue", "æ•°æ®ç»‘å®š"]',
        'Vue.js é€šè¿‡æ•°æ®åŠ«æŒå’Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼å®ç°äº†åŒå‘æ•°æ®ç»‘å®šã€‚', 1),
       ('å‰ç«¯å·¥ç¨‹åŒ–çš„æ„ä¹‰', 'ä¸ºä»€ä¹ˆéœ€è¦å‰ç«¯å·¥ç¨‹åŒ–ï¼Ÿ', '["å‰ç«¯", "å·¥ç¨‹åŒ–"]',
        'å‰ç«¯å·¥ç¨‹åŒ–èƒ½å¤Ÿæé«˜å¼€å‘æ•ˆç‡ã€ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ï¼Œè§„èŒƒå¼€å‘æµç¨‹ã€‚', 2);

-- é¢˜åº“é¢˜ç›®å…³è”åˆå§‹æ•°æ®
INSERT INTO question_bank_question (questionBankId, questionId, userId)
VALUES (1, 1, 1),
       (1, 2, 1),
       (1, 3, 1),
       (1, 4, 1),
       (1, 5, 1),
       (1, 6, 1),
       (1, 7, 1),
       (1, 8, 1),
       (1, 9, 1),
       (1, 10, 1),
       (2, 2, 2),
       (2, 14, 2),
       (3, 3, 3),
       (3, 13, 3),
       (4, 4, 1),
       (4, 16, 1),
       (5, 5, 2),
       (5, 18, 2),
       (6, 6, 3),
       (6, 19, 3),
       (7, 7, 1),
       (7, 11, 1),
       (8, 8, 2),
       (8, 10, 2),
       (9, 9, 3),
       (9, 17, 3),
       (10, 12, 1),
       (10, 20, 1);
```

å¦‚æœéœ€è¦æ›´å¤šå›¾æ ‡ï¼Œå¯ä»¥åœ¨ [IconFont](https://www.iconfont.cn/) è·å–ã€‚

## ä¸€ã€åŸºç¡€é¡µé¢å¼€å‘

### ç”¨æˆ·æ¨¡å—

å„é¡¹ç›®é€šç”¨

åœ¨ app ä¸‹æ–°å»ºç”¨æˆ·ç›¸å…³é¡µé¢çš„ç›®å½•ï¼ŒNext.js ä¼šè‡ªåŠ¨æ˜ å°„æˆè·¯ç”±ï¼š

- ç”¨æˆ·ç™»å½•é¡µï¼š/user/login
- ç”¨æˆ·æ³¨å†Œé¡µï¼š/user/register

![img](./assets/04-å‰ç«¯å¼€å‘/7j9K2EXQGBcOr9R2-1737277028365-44.webp)

#### 1ã€ç”¨æˆ·ç™»å½•é¡µé¢

è¯¥é¡µé¢æ²¡æœ‰å±•ç¤ºç±»å†…å®¹ï¼Œä¸éœ€è¦ SEOï¼Œè€Œä¸”ä»¥åŠ¨æ€äº¤äº’ï¼ˆè¾“å…¥è¡¨å•ï¼‰ä¸ºä¸»ï¼Œæ‰€ä»¥ä½¿ç”¨å®¢æˆ·ç«¯æ¸²æŸ“ï¼Œè·Ÿå¼€å‘ä¼ ç»Ÿçš„ React é¡¹ç›®ä¸€æ ·ã€‚

å¯ä»¥ä½¿ç”¨ Ant Design ProComponents çš„ ProForm è¡¨å•ç»„ä»¶ï¼Œå…ˆå®‰è£…ï¼š

```vue
npm i @ant-design/pro-form
```

å®‰è£…å¤±è´¥çš„è¯ä½¿ç”¨ï¼š

```vue
npm i @ant-design/pro-form --force
```

é¡µé¢ä»£ç å¦‚ä¸‹ï¼š

```vue
"use client";

import React from "react";
import { LoginForm, ProForm, ProFormText } from "@ant-design/pro-form";
import { message } from "antd";
import { LockOutlined, UserOutlined } from "@ant-design/icons";
import { userLoginUsingPost } from "@/api/userController";
import { useRouter } from "next/navigation";
import Link from "next/link";
import Image from "next/image";
import { AppDispatch } from "@/stores";
import { setLoginUser } from "@/stores/loginUser";
import { useDispatch } from "react-redux";
import "./index.css";

/**
 * ç”¨æˆ·ç™»å½•é¡µé¢
 * @param props
 */
const UserLoginPage: React.FC = (props) => {
  const [form] = ProForm.useForm();
  const router = useRouter();
  const dispatch = useDispatch<AppDispatch>();

  /**
   * æäº¤
   * @param values
   */
  const doSubmit = async (values: any) => {
    try {
      const res = await userLoginUsingPost(values);
      if (res.data) {
        message.success("ç™»å½•æˆåŠŸï¼");
        // ä¿å­˜ç”¨æˆ·ç™»å½•æ€
        dispatch(setLoginUser(res.data));
        router.replace("/");
        form.resetFields();
      }
    } catch (e: any) {
      message.error('ç™»å½•å¤±è´¥ï¼Œ' + e.message);
    }
  };

  return (
    <div id="userLoginPage">
      <LoginForm<API.UserAddRequest>
        form={form}
        logo={
          <Image src="/assets/logo.png" alt="é¢è¯•é¸­" width={44} height={44} />
        }
        title="é¢è¯•é¸­ - ç”¨æˆ·ç™»å½•"
        subTitle="ç¨‹åºå‘˜é¢è¯•åˆ·é¢˜ç½‘ç«™"
        onFinish={doSubmit}
        submitter={{
          searchConfig: {
            submitText: "ç™»å½•",
          },
        }}
      >
        <ProFormText
          name="userAccount"
          fieldProps={{
            size: "large",
            prefix: <UserOutlined />,
          }}
          placeholder={"è¯·è¾“å…¥ç”¨æˆ·è´¦å·"}
          rules={[
            {
              required: true,
              message: "è¯·è¾“å…¥ç”¨æˆ·è´¦å·!",
            },
          ]}
        />
        <ProFormText.Password
          name="userPassword"
          fieldProps={{
            size: "large",
            prefix: <LockOutlined />,
          }}
          placeholder={"è¯·è¾“å…¥å¯†ç "}
          rules={[
            {
              required: true,
              message: "è¯·è¾“å…¥å¯†ç ï¼",
            },
          ]}
        />
        <div
          style={{
            marginBlockEnd: 24,
            textAlign: "end",
          }}
        >
          è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ
          <Link prefetch={false} href={"/user/register"}>
            å»æ³¨å†Œ
          </Link>
        </div>
      </LoginForm>
    </div>
  );
};

export default UserLoginPage;
```

ä¸Šè¿°ä»£ç ä¸­ï¼Œå½“ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œä¼šå°†ä¿¡æ¯å­˜æ”¾åˆ°å…¨å±€çŠ¶æ€ç®¡ç†ä¸­ã€‚

æ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/G6uN2yjESKxak6Vk-1737277028365-46.webp)

æˆ‘ä»¬æ¯æ¬¡åº”ç”¨åˆå§‹åŒ–ï¼ˆé¡µé¢åˆ·æ–°ï¼‰æ—¶ï¼Œéƒ½éœ€è¦è°ƒç”¨åç«¯è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼Œå¹¶ä¸”æ³¨æ„æ›´æ–°å…¨å±€ç”¨æˆ·çŠ¶æ€ã€‚

ç¡®ä¿ InitLayout çš„ä»£ç å¦‚ä¸‹ï¼š

```tsx
// åˆå§‹åŒ–å…¨å±€ç”¨æˆ·çŠ¶æ€
const doInitLoginUser = useCallback(async () => {
  const res = await getLoginUserUsingGet();
  if (res.data) {
    // æ›´æ–°å…¨å±€ç”¨æˆ·çŠ¶æ€
    dispatch(setLoginUser(res.data));
  }
}, []);
```

ç‚¹å‡»å³ä¸Šè§’å¯¼èˆªæ çš„ â€œæœªç™»å½•â€ æ—¶ï¼Œåº”è¯¥è¦è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µã€‚ä¿®æ”¹ BasicLayout å¦‚ä¸‹ï¼Œæ ¹æ®ç”¨æˆ· id åŒºåˆ†ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œå±•ç¤ºå‡ºä¸åŒçš„å†…å®¹ï¼š

```tsx
const loginUser = useSelector((state: RootState) => state.loginUser);
const router = useRouter();

avatarProps={{
  src: loginUser.userAvatar || "/assets/logo.png",
  size: "small",
  title: loginUser.userName || "é±¼çš®é¸­",
  render: (props, dom) => {
    return loginUser.id ? (
      <Dropdown
        menu={{
          items: [
            {
              key: "logout",
              icon: <LogoutOutlined />,
              label: "é€€å‡ºç™»å½•",
            },
          ],
        }}
        >
        {dom}
      </Dropdown>
    ) : (
      <div onClick={() => router.push("/user/login")}>{dom}</div>
    );
  },
}}
```

#### 2ã€ç”¨æˆ·æ³¨å†Œé¡µé¢

å‚è€ƒç”¨æˆ·ç™»å½•é¡µé¢ï¼Œä¹Ÿæ˜¯å®¢æˆ·ç«¯æ¸²æŸ“ï¼ŒåŒæ ·ä½¿ç”¨é«˜çº§è¡¨å•ç»„ä»¶ã€‚æ³¨æ„ï¼Œéœ€è¦è®©æ³¨å†Œå’Œç™»å½•è¿™ä¸¤ä¸ªé¡µé¢ä¹‹é—´èƒ½å¤Ÿç›¸äº’è·³è½¬ã€‚

é¡µé¢ä»£ç å¦‚ä¸‹ï¼š

```tsx
"use client";

import React from "react";
import { LoginForm, ProForm, ProFormText } from "@ant-design/pro-form";
import { message } from "antd";
import { LockOutlined, UserOutlined } from "@ant-design/icons";
import { userRegisterUsingPost } from "@/api/userController";
import Link from "next/link";
import { useRouter } from "next/navigation";
import Image from "next/image";
import "./index.css";

/**
 * ç”¨æˆ·æ³¨å†Œé¡µé¢
 * @param props
 */
const UserRegisterPage: React.FC = (props) => {
  const [form] = ProForm.useForm();
  const router = useRouter();

  /**
   * æäº¤
   * @param values
   */
  const doSubmit = async (values: any) => {
    try {
      const res = await userRegisterUsingPost(values);
      if (res.data) {
        message.success("æ³¨å†ŒæˆåŠŸï¼Œè¯·ç™»å½•");
        // å‰å¾€ç™»å½•é¡µ
        router.push("/user/login");
      }
    } catch (e) {
      message.error("æ³¨å†Œå¤±è´¥ï¼Œ" + e.message);
    }
  };

  return (
    <div id="userRegisterPage">
      <LoginForm<API.UserAddRequest>
        form={form}
        logo={
          <Image src="/assets/logo.png" alt="é¢è¯•é¸­" width={44} height={44} />
        }
        title="é¢è¯•é¸­ - ç”¨æˆ·æ³¨å†Œ"
        subTitle="ç¨‹åºå‘˜é¢è¯•åˆ·é¢˜ç½‘ç«™"
        onFinish={doSubmit}
        submitter={{
          searchConfig: {
            submitText: "æ³¨å†Œ",
          },
        }}
      >
        <ProFormText
          fieldProps={{
            size: "large",
            prefix: <UserOutlined />,
          }}
          name="userAccount"
          placeholder={"è¯·è¾“å…¥ç”¨æˆ·å"}
          rules={[
            {
              required: true,
              message: "è¯·è¾“å…¥ç”¨æˆ·åï¼",
            },
          ]}
        />
        <ProFormText.Password
          name="userPassword"
          fieldProps={{
            size: "large",
            prefix: <LockOutlined />,
          }}
          placeholder={"è¯·è¾“å…¥å¯†ç "}
          rules={[
            {
              required: true,
              message: "è¯·è¾“å…¥å¯†ç ï¼",
            },
          ]}
        />
        <ProFormText.Password
          name="checkPassword"
          fieldProps={{
            size: "large",
            prefix: <LockOutlined />,
          }}
          placeholder={"ç¡®è®¤å¯†ç "}
          rules={[
            {
              required: true,
              message: "è¯·å†æ¬¡è¾“å…¥å¯†ç ï¼",
            },
          ]}
        />
        <div
          style={{
            marginBlockEnd: 24,
            textAlign: "end",
          }}
        >
          å·²æœ‰è´¦å·ï¼Ÿ
          <Link prefetch={false} href={"/user/login"}>
            å»ç™»å½•
          </Link>
        </div>
      </LoginForm>
    </div>
  );
};

export default UserRegisterPage;
```

æ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/VAYAyjvF9JGHYEw0-1737277028365-48.webp)

#### 3ã€ç”¨æˆ·æ³¨é”€

ç¼–å†™é€€å‡ºç™»å½•é€»è¾‘ï¼Œé€€å‡ºç™»å½•æˆåŠŸæ—¶ï¼Œåº”è¯¥å°†å…¨å±€çŠ¶æ€é‡ç½®ä¸º â€œé»˜è®¤ç”¨æˆ·â€ï¼Œä»£ç å¦‚ä¸‹ï¼š

```tsx
/**
 * ç”¨æˆ·æ³¨é”€
 */
const userLogout = async () => {
  try {
    await userLogoutUsingPost();
    message.success("å·²é€€å‡ºç™»å½•");
    dispatch(setLoginUser(DEFAULT_USER));
    router.push("/user/login");
  } catch (e) {
    message.error("æ“ä½œå¤±è´¥ï¼Œ" + e.message);
  }
  return;
}
```

ç”±äºé»˜è®¤ç”¨æˆ·åœ¨å¤šä¸ªä½ç½®ä½¿ç”¨ï¼Œå¯ä»¥å®šä¹‰ä¸ºå¸¸é‡ï¼Œæ”¾åœ¨ `src/constants/user.ts` ä¸­ï¼š

```tsx
import AccessEnum from "@/access/accessEnum";

export const DEFAULT_USER: API.LoginUserVO = {
    userName: "æœªç™»å½•",
    userProfile: "æš‚æ— ç®€ä»‹",
    userAvatar: "/assets/notLoginUser.png",
    userRole: AccessEnum.NOT_LOGIN,
};
```

ç»™ç”¨æˆ·å¤´åƒä¸‹æ‹‰èœå•ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼š

```tsx
<Dropdown
  menu={{
    items: [
      {
        key: "logout",
        icon: <LogoutOutlined />,
        label: "é€€å‡ºç™»å½•",
      },
    ],
    onClick: async (event: { key: React.Key }) => {
      const { key } = event;
      // é€€å‡ºç™»å½•
      if (key === "logout") {
        userLogout();
      }
    },
  }}
>
  {dom}
</Dropdown>
```

#### 4ã€ç”¨æˆ·ç®¡ç†é¡µé¢

éœ€æ±‚ï¼šç®¡ç†ç”¨æˆ· - å¢åˆ æ”¹æŸ¥ï¼ˆä»…ç®¡ç†å‘˜å¯ç”¨ï¼‰P1

é¡µé¢é¢„æœŸæ•ˆæœï¼šä¸Šæ–¹æœç´¢æ ï¼Œä¸‹æ–¹è¡¨æ ¼ï¼Œæ˜¯ä¸€ä¸ªå¾ˆæ ‡å‡†çš„ç®¡ç†é¡µé¢å¸ƒå±€ã€‚å¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/WOPlPJBPLe0HUnZ1-1737277028365-50.webp)

å½“ç”¨æˆ·ç‚¹å‡»æ–°å»ºå’Œä¿®æ”¹æŒ‰é’®æ—¶ï¼Œèƒ½å¤Ÿæ‰“å¼€å¼¹çª—ï¼Œè®©ç”¨æˆ·å¡«å†™ä¿¡æ¯ã€‚

ä¸ºäº†ç®€åŒ–å¼€å‘ï¼Œå¯ä»¥ä½¿ç”¨ Ant Design ProComponents çš„é«˜çº§è¡¨æ ¼ç»„ä»¶å®ç°ã€‚å‚è€ƒæ–‡æ¡£ï¼šhttps://procomponents.ant.design/components/table

[ç¼–ç¨‹å¯¼èˆª](https://www.code-nav.cn/) çš„ä¸‡ç”¨å‰ç«¯æ¨¡æ¿ä¹Ÿæä¾›äº†ç°æˆçš„ç®¡ç†é¡µé¢ï¼Œå¯ä»¥ç›´æ¥åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œæ•ˆç‡ä¼šæ›´é«˜ä¸€äº›ï¼Œæ²¡å¿…è¦é‡å¤ä» 0 å¼€å‘ã€‚

å‰ç«¯ä¸‡ç”¨æ¨¡æ¿ï¼šhttps://www.code-nav.cn/course/1826803928691945473/section/1826872004326240257?type=

æ³¨æ„ï¼Œç®¡ç†å‘˜é¡µé¢ä¸éœ€è¦ SEOã€å¯¹æ€§èƒ½ä¹Ÿæ²¡æœ‰ç‰¹åˆ«é«˜çš„è¦æ±‚ï¼Œä½¿ç”¨å®¢æˆ·ç«¯æ¸²æŸ“å°±è¡Œï¼Œå¼€å‘é™åˆ¶ä¼šå°‘ä¸€äº›ã€‚

1ï¼‰åˆ›å»ºé¡µé¢æ—¶ï¼Œå…ˆæ–°å¢è·¯ç”±ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/YPLLIKb9TLS1m3yS-1737277028365-52.webp)

æ–°å»ºèœå•é¡¹é…ç½®ï¼Œæœ‰ç®¡ç†å‘˜æƒé™æ‰å¯è®¿é—®ï¼š

```typescript
{
  path: "/admin",
  name: "ç®¡ç†",
  icon: <CrownOutlined />,
  access: ACCESS_ENUM.ADMIN,
  children: [
    {
      path: "/admin/user",
      name: "ç”¨æˆ·ç®¡ç†",
      access: ACCESS_ENUM.ADMIN,
    },
  ],
}
```

2ï¼‰å®‰è£…è¡¨æ ¼ç»„ä»¶ä¾èµ–ï¼š

```typescript
npm i @ant-design/pro-table
```

å®‰è£…å¤±è´¥çš„è¯ï¼Œå°±åœ¨å‘½ä»¤ååŠ  `--force`ï¼š

```typescript
npm i @ant-design/pro-table --force
```

3ï¼‰å¼€å‘é¡µé¢ã€‚å…ˆåœ¨é¡µé¢å¼€å¤´å¢åŠ  "use client" å£°æ˜ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯æ¸²æŸ“ã€‚

åŸºäºè¡¨æ ¼ç»„ä»¶çš„å¼€å‘è§„èŒƒï¼Œå…ˆå®šä¹‰è¦å±•ç¤ºå“ªäº›è¡¨æ ¼åˆ—ï¼Œå¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š[https://procomponents.ant.design/components/table#columns-%E5%88%97%E5%AE%9A%E4%B9%89](https://procomponents.ant.design/components/table#columns-åˆ—å®šä¹‰)

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```typescript
const columns: ProColumns<API.User>[] = [
  {
    title: "id",
    dataIndex: "id",
    valueType: "text",
    hideInForm: true,
  },
  {
    title: "è´¦å·",
    dataIndex: "userAccount",
    valueType: "text",
  },
  {
    title: "ç”¨æˆ·å",
    dataIndex: "userName",
    valueType: "text",
  },
  {
    title: "å¤´åƒ",
    dataIndex: "userAvatar",
    valueType: "image",
    fieldProps: {
      width: 64,
    },
    hideInSearch: true,
  },
  {
    title: "ç®€ä»‹",
    dataIndex: "userProfile",
    valueType: "textarea",
  },
  {
    title: "æƒé™",
    dataIndex: "userRole",
    valueEnum: {
      user: {
        text: "ç”¨æˆ·",
      },
      admin: {
        text: "ç®¡ç†å‘˜",
      },
    },
  },
  {
    title: "åˆ›å»ºæ—¶é—´",
    sorter: true,
    dataIndex: "createTime",
    valueType: "dateTime",
    hideInSearch: true,
    hideInForm: true,
  },
  {
    title: "æ›´æ–°æ—¶é—´",
    sorter: true,
    dataIndex: "updateTime",
    valueType: "dateTime",
    hideInSearch: true,
    hideInForm: true,
  },
  {
    title: "æ“ä½œ",
    dataIndex: "option",
    valueType: "option",
    render: (_, record) => (
      <Space size="middle">
        <Typography.Link
          onClick={() => {
            setCurrentRow(record);
            setUpdateModalVisible(true);
          }}
        >
          ä¿®æ”¹
        </Typography.Link>
        <Typography.Link type="danger" onClick={() => handleDelete(record)}>
          åˆ é™¤
        </Typography.Link>
      </Space>
    ),
  },
];
```

å…¶ä¸­ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰äº†æ“ä½œåˆ—ï¼Œæä¾›ä¿®æ”¹å’Œåˆ é™¤ä¸¤ä¸ªæŒ‰é’®ã€‚å¯¹äºä¿®æ”¹æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦ currentRow å˜é‡æ¥è®°å½•ç”¨æˆ·è¦ä¿®æ”¹å“ªæ¡æ•°æ®ï¼Œä¾¿äºä¿®æ”¹çš„æ—¶å€™å±•ç¤ºè€æ•°æ®ã€‚

```typescript
// å½“å‰ç”¨æˆ·ç‚¹å‡»çš„æ•°æ®
const [currentRow, setCurrentRow] = useState<API.User>();
```

4ï¼‰ä½¿ç”¨é«˜çº§è¡¨æ ¼ç»„ä»¶ï¼Œç¼–å†™è¯·æ±‚å‡½æ•°ã€æ–°å»ºæ“ä½œå·¥å…·æ ç­‰ã€‚

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```typescript
<ProTable<API.User>
  headerTitle={"æŸ¥è¯¢è¡¨æ ¼"}
  actionRef={actionRef}
  toolBarRender={() => [
    <Button
      type="primary"
      key="primary"
      onClick={() => {
        setCreateModalVisible(true);
      }}
    >
      <PlusOutlined /> æ–°å»º
    </Button>,
  ]}
  request={async (params, sort, filter) => {
    const sortField = Object.keys(sort)?.[0];
    const sortOrder = sort?.[sortField];

    const { data, code } = await listUserByPageUsingPost({
      ...params,
      sortField,
      sortOrder,
      ...filter,
    } as API.UserQueryRequest);

    return {
      success: code === 0,
      data: data.records || [],
      total: Number(data.total) || 0,
    };
  }}
  columns={columns}
/>
```

5ï¼‰å®ç°åˆ é™¤åŠŸèƒ½ã€‚ä¸»è¦æ˜¯ç¼–å†™åˆ é™¤å‡½æ•°ï¼š

```tsx
const handleDelete = async (row: API.User) => {
  const hide = message.loading("æ­£åœ¨åˆ é™¤");
  if (!row) return true;
  try {
    await deleteUserUsingPost({
      id: row.id as any,
    });
    hide();
    message.success("åˆ é™¤æˆåŠŸ");
    // åˆ é™¤æˆåŠŸååˆ·æ–°è¡¨æ ¼
    actionRef?.current?.reload();
    return true;
  } catch (error: any) {
    hide();
    message.error("åˆ é™¤å¤±è´¥ï¼Œ" + error.message);
    return false;
  }
};
```

ç»™åˆ é™¤æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼š

```tsx
<Typography.Link type="danger" onClick={() => handleDelete(record)}>
  åˆ é™¤
</Typography.Link>
```

æ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/9hT2ivgp8MQCt38P-1737277028365-54.webp)

6ï¼‰å¼€å‘åˆ›å»ºæ•°æ®å¼¹çª—ç»„ä»¶ã€‚

ğŸ’¡ è¯¥ç»„ä»¶ç”±äºåªè¢«ç”¨æˆ·ç®¡ç†é¡µé¢ä½¿ç”¨ï¼Œä¸ç”¨ä½œä¸ºå…¨å±€ç»„ä»¶ï¼Œè€Œæ˜¯æ”¾åœ¨ `admin/user` ç›®å½•ä¸‹çš„ components ç›®å½•ä¸­å³å¯ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/MB2XTVgFlcSQL9tv-1737277028365-58.webp)

é¦–å…ˆå®šä¹‰å±æ€§ï¼Œç”¨äºæ§åˆ¶å¼¹çª—çš„æ˜¾éšã€ä»¥åŠæˆåŠŸæäº¤æˆ–å–æ¶ˆå¼¹çª—äº‹ä»¶ï¼š

```tsx
interface Props {
  visible: boolean;
  columns: ProColumns<API.User>[];
  onSubmit: (values: API.UserAddRequest) => void;
  onCancel: () => void;
}
```

åŸºäºé«˜çº§è¡¨æ ¼è‡ªå¸¦çš„è¡¨å•ç±»å‹ï¼Œä¼ å…¥ç®¡ç†è¡¨æ ¼é¡µé¢å·²ç»å®šä¹‰å¥½çš„ columnsï¼Œèƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆè¡¨å•é¡¹ã€‚

```tsx
<Modal
  destroyOnClose
  title={"åˆ›å»º"}
  open={visible}
  footer={null}
  onCancel={() => {
    onCancel?.();
  }}
>
  <ProTable
    type="form"
    columns={columns}
    onSubmit={async (values: API.UserAddRequest) => {
      const success = await handleAdd(values);
      if (success) {
        onSubmit?.(values);
      }
    }}
  />
</Modal>
```

æœ€åç¼–å†™æäº¤å‡½æ•°ï¼Œè°ƒç”¨åç«¯å®ç°æ•°æ®åˆ›å»ºï¼š

```tsx
const handleAdd = async (fields: API.UserAddRequest) => {
  const hide = message.loading("æ­£åœ¨æ·»åŠ ");
  try {
    await addUserUsingPost(fields);
    hide();
    message.success("åˆ›å»ºæˆåŠŸ");
    return true;
  } catch (error: any) {
    hide();
    message.error("åˆ›å»ºå¤±è´¥ï¼Œ" + error.message);
    return false;
  }
};
```

åœ¨ç”¨æˆ·ç®¡ç†é¡µé¢å¼•å…¥è¯¥ç»„ä»¶ï¼Œé€šè¿‡å®šä¹‰ visible çŠ¶æ€æ¥æ§åˆ¶å¼¹çª—çš„æ˜¾éšï¼š

```tsx
// æ˜¯å¦æ˜¾ç¤ºæ–°å»ºçª—å£
const [createModalVisible, setCreateModalVisible] = useState<boolean>(false);
const actionRef = useRef<ActionType>();

<CreateModal
  visible={createModalVisible}
  columns={columns}
  onSubmit={() => {
    setCreateModalVisible(false);
    actionRef.current?.reload();
  }}
  onCancel={() => {
    setCreateModalVisible(false);
  }}
/>
```

ç‚¹å‡»å·¥å…·æ ä¸Šçš„æ–°å»ºæŒ‰é’®æ—¶ï¼Œä¼šæ‰“å¼€å¼¹çª—ï¼ˆè®¾ç½® visible çŠ¶æ€ä¸º trueï¼‰ï¼š

```tsx
<Button
  type="primary"
  key="primary"
  onClick={() => {
    setCreateModalVisible(true);
  }}
>
  <PlusOutlined /> æ–°å»º
</Button>
```

æ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/NyckxEfy7bS9vi6x-1737277028365-56.webp)

7ï¼‰å¼€å‘ä¿®æ”¹æ•°æ®å¼¹çª—ç»„ä»¶ã€‚

è¿‡ç¨‹è·Ÿä¸Šä¸€æ­¥ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºéœ€è¦ç»™ç»„ä»¶å¤šä¼ å…¥ â€œè€æ•°æ®â€ï¼š

```tsx
interface Props {
  oldData?: API.User;
  visible: boolean;
  columns: ProColumns<API.User>[];
  onSubmit: (values: API.UserUpdateRequest) => void;
  onCancel: () => void;
}
```

éœ€è¦ç»™è¡¨å•è¡¥å……åˆå§‹æ•°æ®ï¼Œå¹¶ä¸”åœ¨æäº¤æ—¶ï¼Œéœ€è¦æ ¡éªŒè€æ•°æ®æ˜¯å¦å­˜åœ¨ï¼š

```tsx
<ProTable
  type="form"
  columns={columns}
  form={{
    initialValues: oldData,
  }}
  onSubmit={async (values: API.UserUpdateRequest) => {
    if (!oldData?.id || !onSubmit) {
      return;
    }
    const success = await handleUpdate({
      ...values,
      id: oldData.id,
    });
    if (success) {
      onSubmit(values);
    }
  }}
/>
```

è‡³æ­¤ï¼Œç”¨æˆ·æ¨¡å—å¼€å‘å®Œæˆã€‚

#### æ‰©å±•

1ï¼‰ç”¨æˆ·ç®¡ç†é¡µé¢å¯ä»¥é€šè¿‡ç»™åˆ é™¤å¢åŠ äºŒæ¬¡ç¡®è®¤ï¼Œå‡å°‘è¯¯æ“ä½œæ¦‚ç‡ã€‚

ä½¿ç”¨ Popconfirm ç»„ä»¶å¯è½»æ¾å®ç°ï¼šhttps://ant-design.antgroup.com/components/popconfirm-cn

2ï¼‰ç”¨æˆ·ç®¡ç†é¡µé¢å®ç°å¤šåˆ—æ’åºåŠŸèƒ½

å‰ç«¯ ProTable å·²ç»é»˜è®¤æ”¯æŒäº†ï¼Œé€šè¿‡ request å‡½æ•°çš„ sort å‚æ•°å¯ä»¥è·å–åˆ°æ’åºæ¡ä»¶ï¼Œéœ€è¦è®©åç«¯æ”¯æŒå¤„ç†å¤šåˆ—æ’åºã€‚

### é¢˜åº“ç®¡ç†é¡µé¢

å¯¹åº”éœ€æ±‚ï¼šã€ç®¡ç†å‘˜ã€‘ç®¡ç†é¢˜åº“ - å¢åˆ æ”¹æŸ¥

å…¶ä»–ç®¡ç†é¡µé¢è·Ÿç”¨æˆ·ç®¡ç†é¡µé¢æå…¶ç›¸ä¼¼ï¼Œæ²¡ä»€ä¹ˆæŠ€æœ¯è¦ç‚¹ï¼Œå¤åˆ¶ç”¨æˆ·ç®¡ç†é¡µé¢åç•¥åšä¿®æ”¹å³å¯ï¼Œè¯·å¤§å®¶è‡ªè¡Œå¼€å‘ã€‚

æ·»åŠ èœå•é¡¹é…ç½®ï¼š

```tsx
{
  path: "/admin",
  name: "ç®¡ç†",
  icon: <CrownOutlined />,
  access: ACCESS_ENUM.ADMIN,
  children: [
    {
      path: "/admin/user",
      name: "ç”¨æˆ·ç®¡ç†",
      access: ACCESS_ENUM.ADMIN,
    },
    {
      path: "/admin/bank",
      name: "é¢˜åº“ç®¡ç†",
      access: ACCESS_ENUM.ADMIN,
    }
  ],
},
```

å¼€å‘é¡µé¢ï¼Œå…³é”®æ˜¯ columns è¡¨æ ¼åˆ—é…ç½®ï¼š

```tsx
const columns: ProColumns<API.QuestionBank>[] = [
  {
    title: "id",
    dataIndex: "id",
    valueType: "text",
    hideInForm: true,
  },
  {
    title: "æ ‡é¢˜",
    dataIndex: "title",
    valueType: "text",
  },
  {
    title: "æè¿°",
    dataIndex: "description",
    valueType: "text",
  },
  {
    title: "å›¾ç‰‡",
    dataIndex: "picture",
    valueType: "image",
    fieldProps: {
      width: 64,
    },
    hideInSearch: true,
  },
  {
    title: "åˆ›å»ºæ—¶é—´",
    sorter: true,
    dataIndex: "createTime",
    valueType: "dateTime",
    hideInSearch: true,
    hideInForm: true,
  },
  {
    title: "ç¼–è¾‘æ—¶é—´",
    sorter: true,
    dataIndex: "editTime",
    valueType: "dateTime",
    hideInSearch: true,
    hideInForm: true,
  },
  {
    title: "æ›´æ–°æ—¶é—´",
    sorter: true,
    dataIndex: "updateTime",
    valueType: "dateTime",
    hideInSearch: true,
    hideInForm: true,
  },
  {
    title: "æ“ä½œ",
    dataIndex: "option",
    valueType: "option",
    render: (_, record) => (
      <Space size="middle">
        <Typography.Link
          onClick={() => {
            setCurrentRow(record);
            setUpdateModalVisible(true);
          }}
        >
          ä¿®æ”¹
        </Typography.Link>
        <Typography.Link type="danger" onClick={() => handleDelete(record)}>
          åˆ é™¤
        </Typography.Link>
      </Space>
    ),
  },
];
```

æ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/tuccgAHKJy9oSA3G-1737277028365-60.webp)

### é¢˜ç›®ç®¡ç†é¡µé¢

å¯¹åº”éœ€æ±‚ï¼šã€ç®¡ç†å‘˜ã€‘ç®¡ç†é¢˜ç›® - å¢åˆ æ”¹æŸ¥

#### 1ã€åŸºç¡€è¡¨æ ¼å¼€å‘

æ·»åŠ èœå•é¡¹é…ç½®ï¼š

```javascript
{
  path: "/admin",
  name: "ç®¡ç†",
  icon: <CrownOutlined />,
  access: ACCESS_ENUM.ADMIN,
  children: [
    {
      path: "/admin/user",
      name: "ç”¨æˆ·ç®¡ç†",
      access: ACCESS_ENUM.ADMIN,
    },
    {
      path: "/admin/bank",
      name: "é¢˜åº“ç®¡ç†",
      access: ACCESS_ENUM.ADMIN,
    },
    {
      path: "/admin/question",
      name: "é¢˜ç›®ç®¡ç†",
      access: ACCESS_ENUM.ADMIN,
    },
  ],
}
```

è¡¨æ ¼åˆ—é…ç½®ï¼š

```tsx
const columns: ProColumns<API.Question>[] = [
  {
    title: "id",
    dataIndex: "id",
    valueType: "text",
    hideInForm: true,
  },
  {
    title: "æ ‡é¢˜",
    dataIndex: "title",
    valueType: "text",
  },
  {
    title: "å†…å®¹",
    dataIndex: "content",
    valueType: "text",
    hideInSearch: true,
    width: 240,
  },
  {
    title: "ç­”æ¡ˆ",
    dataIndex: "answer",
    valueType: "text",
    hideInSearch: true,
    width: 640,
  },
  {
    title: "æ ‡ç­¾",
    dataIndex: "tags",
    valueType: "select",
    fieldProps: {
      mode: "tags",
    }
  },
  {
    title: "åˆ›å»ºç”¨æˆ·",
    dataIndex: "userId",
    valueType: "text",
    hideInForm: true,
  },

  {
    title: "åˆ›å»ºæ—¶é—´",
    sorter: true,
    dataIndex: "createTime",
    valueType: "dateTime",
    hideInSearch: true,
    hideInForm: true,
  },
  {
    title: "ç¼–è¾‘æ—¶é—´",
    sorter: true,
    dataIndex: "editTime",
    valueType: "dateTime",
    hideInSearch: true,
    hideInForm: true,
  },
  {
    title: "æ›´æ–°æ—¶é—´",
    sorter: true,
    dataIndex: "updateTime",
    valueType: "dateTime",
    hideInSearch: true,
    hideInForm: true,
  },
  {
    title: "æ“ä½œ",
    dataIndex: "option",
    valueType: "option",
    render: (_, record) => (
      <Space size="middle">
        <Typography.Link
          onClick={() => {
            setCurrentRow(record);
            setUpdateModalVisible(true);
          }}
          >
          ä¿®æ”¹
        </Typography.Link>
        <Typography.Link type="danger" onClick={() => handleDelete(record)}>
          åˆ é™¤
        </Typography.Link>
      </Space>
    ),
  },
];
```

#### 2ã€å¤„ç†ç‰¹æ®Šé€»è¾‘

1ï¼‰è‡ªå®šä¹‰æ ‡ç­¾æ¸²æŸ“ï¼ŒæŠŠå­—ç¬¦ä¸²è½¬ä¸ºæ ‡ç­¾åˆ—è¡¨ï¼š

```tsx
{
  title: "æ ‡ç­¾",
  dataIndex: "tags",
  valueType: "select",
  fieldProps: {
    mode: "tags",
  },
  render: (_, record) => {
    const tagList = JSON.parse(record.tags || "[]");
    return <TagList tagList={tagList} />;
  },
},
```

TagList æ˜¯ç”¨äºæ¸²æŸ“æ ‡ç­¾åˆ—è¡¨çš„ç»„ä»¶ï¼š

```tsx
import { Tag } from "antd";
import "./index.css";

interface Props {
  tagList?: string[];
}

/**
 * æ ‡ç­¾åˆ—è¡¨ç»„ä»¶
 * @param props
 * @constructor
 */
const TagList = (props: Props) => {
  const { tagList = [] } = props;

  return (
    <div className="tag-list">
      {tagList.map((tag) => {
        return <Tag key={tag}>{tag}</Tag>;
      })}
    </div>
  );
};

export default TagList;
```

2ï¼‰éœ€è¦ä¿®æ”¹é¢˜ç›®å†…å®¹å’Œç­”æ¡ˆçš„è¾“å…¥æ¡†ä¸ºæˆ‘ä»¬å°è£…çš„ MdEditor ç¼–è¾‘å™¨ï¼Œå¯å‚è€ƒ ProTable å®˜æ–¹æ–‡æ¡£çš„ [è‡ªå®šä¹‰è¡¨å•é¡¹æ¸²æŸ“](https://procomponents.ant.design/components/table?tab=api&current=1&pageSize=5#æœç´¢è¡¨å•è‡ªå®šä¹‰)ã€‚

```tsx
{
  title: "å†…å®¹",
  dataIndex: "content",
  valueType: "text",
  hideInSearch: true,
  width: 240,
  renderFormItem: (
    _,
    { type, defaultRender, formItemProps, fieldProps, ...rest },
    form,
  ) => {
    return (
      // value å’Œ onchange ä¼šé€šè¿‡ form è‡ªåŠ¨æ³¨å…¥ã€‚
      <MdEditor
        // ç»„ä»¶çš„é…ç½®
        {...fieldProps}
      />
    );
  },
},
```

#### 3ã€é—®é¢˜ä¿®å¤ï¼ˆå®Œå–„æ¥å£ï¼‰

æµ‹è¯•æ—¶ï¼Œå‘ç°åˆ›å»ºå’Œæ›´æ–°é¢˜ç›®çš„æ ‡ç­¾å¤±è´¥ï¼Œè¿™æ˜¯å› ä¸ºåç«¯æ¥å£æ²¡æœ‰è¡¥å…… tags å­—ç¬¦ä¸²åˆ° tagList åˆ—è¡¨çš„è½¬æ¢ï¼Œéœ€è¦ç»™ addQuestion å’Œ updateQuestion æ¥å£è¡¥å……è½¬æ¢é€»è¾‘ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```java
Question question = new Question();
BeanUtils.copyProperties(questionAddRequest, question);
List<String> tags = questionAddRequest.getTags();
if (tags != null) {
    question.setTags(JSONUtil.toJsonStr(tags));
}
```

æ³¨æ„ï¼Œæ›´æ–°æ•°æ®æ—¶ï¼Œéœ€è¦å°† tags è½¬æ¢æˆæ•°ç»„åä½œä¸ºè¡¨å•åˆå§‹å€¼ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸åŒæ­¥åˆ°è¡¨å•ã€‚å¯ä»¥åœ¨ UpdateModal ä¸­è‡ªå·±å®šä¹‰åˆå§‹å€¼å¯¹è±¡ï¼š

```typescript
// è¡¨å•è½¬æ¢
let initValues = { ...oldData };
if (oldData.tags) {
  initValues.tags = JSON.parse(oldData.tags) || [];
}
```

ç„¶ååœ¨ ProTable ç»„ä»¶ä¸­ä½¿ç”¨åˆå§‹å€¼å¯¹è±¡ï¼š

```tsx
<ProTable
  type="form"
  columns={columns}
  form={{
    initialValues: initValues,
  }}
/>
```

é¡µé¢æœ€ç»ˆæ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/XWuBrXRH4zGWgrWI-1737277028365-62.webp)

é¡µé¢å®Œæ•´ä»£ç å¦‚ä¸‹ï¼Œä»…ä¾›å‚è€ƒï¼š

```tsx
"use client";

import CreateModal from "./components/CreateModal";
import UpdateModal from "./components/UpdateModal";
import {
  deleteQuestionUsingPost,
  listQuestionByPageUsingPost,
} from "@/api/questionController";
import { PlusOutlined } from "@ant-design/icons";
import type { ActionType, ProColumns } from "@ant-design/pro-components";
import { PageContainer, ProTable } from "@ant-design/pro-components";
import { Button, message, Space, Typography } from "antd";
import React, { useRef, useState } from "react";
import TagList from "@/components/TagList";
import MdEditor from "@/components/MdEditor";

/**
 * é¢˜ç›®ç®¡ç†é¡µé¢
 *
 * @constructor
 */
const QuestionAdminPage: React.FC = () => {
  // æ˜¯å¦æ˜¾ç¤ºæ–°å»ºçª—å£
  const [createModalVisible, setCreateModalVisible] = useState<boolean>(false);
  // æ˜¯å¦æ˜¾ç¤ºæ›´æ–°çª—å£
  const [updateModalVisible, setUpdateModalVisible] = useState<boolean>(false);
  const actionRef = useRef<ActionType>();
  // å½“å‰ç‚¹å‡»çš„æ•°æ®
  const [currentRow, setCurrentRow] = useState<API.Question>();

  /**
   * åˆ é™¤èŠ‚ç‚¹
   *
   * @param row
   */
  const handleDelete = async (row: API.Question) => {
    const hide = message.loading("æ­£åœ¨åˆ é™¤");
    if (!row) return true;
    try {
      await deleteQuestionUsingPost({
        id: row.id as any,
      });
      hide();
      message.success("åˆ é™¤æˆåŠŸ");
      actionRef?.current?.reload();
      return true;
    } catch (error: any) {
      hide();
      message.error("åˆ é™¤å¤±è´¥ï¼Œ" + error.message);
      return false;
    }
  };

  /**
   * è¡¨æ ¼åˆ—é…ç½®
   */
  const columns: ProColumns<API.Question>[] = [
    {
      title: "id",
      dataIndex: "id",
      valueType: "text",
      hideInForm: true,
    },
    {
      title: "æ ‡é¢˜",
      dataIndex: "title",
      valueType: "text",
    },
    {
      title: "å†…å®¹",
      dataIndex: "content",
      valueType: "text",
      hideInSearch: true,
      width: 240,
      renderFormItem: (
        _,
        { type, defaultRender, formItemProps, fieldProps, ...rest },
        form,
      ) => {
        return (
          // value å’Œ onchange ä¼šé€šè¿‡ form è‡ªåŠ¨æ³¨å…¥ã€‚
          <MdEditor
            // ç»„ä»¶çš„é…ç½®
            {...fieldProps}
          />
        );
      },
    },
    {
      title: "ç­”æ¡ˆ",
      dataIndex: "answer",
      valueType: "text",
      hideInSearch: true,
      width: 640,
      renderFormItem: (
        _,
        { type, defaultRender, formItemProps, fieldProps, ...rest },
        form,
      ) => {
        return (
          // value å’Œ onchange ä¼šé€šè¿‡ form è‡ªåŠ¨æ³¨å…¥ã€‚
          <MdEditor
            // ç»„ä»¶çš„é…ç½®
            {...fieldProps}
          />
        );
      },
    },
    {
      title: "æ ‡ç­¾",
      dataIndex: "tags",
      valueType: "select",
      fieldProps: {
        mode: "tags",
      },
      render: (_, record) => {
        const tagList = JSON.parse(record.tags || "[]");
        return <TagList tagList={tagList} />;
      },
    },
    {
      title: "åˆ›å»ºç”¨æˆ·",
      dataIndex: "userId",
      valueType: "text",
      hideInForm: true,
    },

    {
      title: "åˆ›å»ºæ—¶é—´",
      sorter: true,
      dataIndex: "createTime",
      valueType: "dateTime",
      hideInSearch: true,
      hideInForm: true,
    },
    {
      title: "ç¼–è¾‘æ—¶é—´",
      sorter: true,
      dataIndex: "editTime",
      valueType: "dateTime",
      hideInSearch: true,
      hideInForm: true,
    },
    {
      title: "æ›´æ–°æ—¶é—´",
      sorter: true,
      dataIndex: "updateTime",
      valueType: "dateTime",
      hideInSearch: true,
      hideInForm: true,
    },
    {
      title: "æ“ä½œ",
      dataIndex: "option",
      valueType: "option",
      render: (_, record) => (
        <Space size="middle">
          <Typography.Link
            onClick={() => {
              setCurrentRow(record);
              setUpdateModalVisible(true);
            }}
          >
            ä¿®æ”¹
          </Typography.Link>
          <Typography.Link type="danger" onClick={() => handleDelete(record)}>
            åˆ é™¤
          </Typography.Link>
        </Space>
      ),
    },
  ];

  return (
    <PageContainer>
      <ProTable<API.Question>
        headerTitle={"é¢˜ç›®ç®¡ç†"}
        actionRef={actionRef}
        toolBarRender={() => [
          <Button
            type="primary"
            key="primary"
            onClick={() => {
              setCreateModalVisible(true);
            }}
          >
            <PlusOutlined /> æ–°å»º
          </Button>,
        ]}
        request={async (params, sort, filter) => {
          const sortField = Object.keys(sort)?.[0];
          const sortOrder = sort?.[sortField];

          const { data, code } = await listQuestionByPageUsingPost({
            ...params,
            sortField,
            sortOrder,
            ...filter,
          } as API.QuestionQueryRequest);

          return {
            success: code === 0,
            data: data.records || [],
            total: Number(data.total) || 0,
          };
        }}
        columns={columns}
      />
      <CreateModal
        visible={createModalVisible}
        columns={columns}
        onSubmit={() => {
          setCreateModalVisible(false);
          actionRef.current?.reload();
        }}
        onCancel={() => {
          setCreateModalVisible(false);
        }}
      />
      <UpdateModal
        visible={updateModalVisible}
        columns={columns}
        oldData={currentRow}
        onSubmit={() => {
          setUpdateModalVisible(false);
          setCurrentRow(undefined);
          actionRef.current?.reload();
        }}
        onCancel={() => {
          setUpdateModalVisible(false);
        }}
      />
    </PageContainer>
  );
};
export default QuestionAdminPage;
```

## äºŒã€æ ¸å¿ƒé¡µé¢å¼€å‘

### ä¸»é¡µ

éœ€æ±‚ï¼šå±•ç¤ºæœ‰å¸å¼•åŠ›çš„å†…å®¹ï¼Œæ¯”å¦‚å±•ç¤ºéƒ¨åˆ†æœ€æ–°é¢˜åº“ã€éƒ¨åˆ†æœ€æ–°é¢˜ç›®

é¡µé¢ç»“æ„ï¼šä»ä¸Šåˆ°ä¸‹ï¼Œä¾æ¬¡æ˜¯æœ€æ–°é¢˜åº“å’Œæœ€æ–°é¢˜ç›®æ¿å—ï¼Œæ¯ä¸ªç‰ˆå—å±•ç¤º 12 æ¡æ•°æ®ã€‚

ğŸ’¡ åˆ†é¡µæ¡æ•°å°½é‡æ˜¯ 3ã€4 çš„å€æ•°ï¼Œæ¯”å¦‚ 12 å’Œ 24ï¼Œå¯ä»¥åŒæ—¶å…¼å®¹ 3 åˆ—ã€4 åˆ—ã€‚

#### 1ã€é¡µé¢æ•´ä½“ç»“æ„å¼€å‘

1ï¼‰å…ˆç¼–å†™é¡µé¢ç»“æ„ï¼š

```tsx
"use server";
import Title from "antd/es/typography/Title";
import { Divider } from "antd";
import "./index.css";

/**
 * ä¸»é¡µ
 * @constructor
 */
export default async function HomePage() {
  return <div id="homePage">
    <Title level={3}>
      æœ€æ–°é¢˜åº“
    </Title>
    <div>
      é¢˜åº“åˆ—è¡¨
    </div>
    <Divider />
    <Title level={3}>
      æœ€æ–°é¢˜ç›®
    </Title>
    <div>
      é¢˜ç›®åˆ—è¡¨
    </div>
  </div>;
}
```

2ï¼‰ä½¿ç”¨ [Ant Design çš„ Flex ç»„ä»¶](https://ant-design.antgroup.com/components/flex-cn#flex-demo-basic)ï¼Œåœ¨æ ‡é¢˜å³ä¾§è¡¥å…… â€œæŸ¥çœ‹æ›´å¤šâ€ åˆ°é¢˜åº“åˆ—è¡¨é¡µçš„è·³è½¬ï¼š

```tsx
<Flex justify="space-between" align="center">
  <Title level={3}>æœ€æ–°é¢˜åº“</Title>
  <Link href={"/banks"}>æŸ¥çœ‹æ›´å¤š</Link>
</Flex>
```

3ï¼‰è¯·æ±‚é¢˜åº“å’Œé¢˜ç›®åˆ—è¡¨æ•°æ®å¹¶å±•ç¤ºï¼š

```tsx
export default async function HomePage() {

  let questionBankList = [];
  let questionList = [];

  try {
    const questionBankRes = await listQuestionBankVoByPageUsingPost({
      pageSize: 12,
      sortField: 'createTime',
      sortOrder: 'descend',
    })
    questionBankList = questionBankRes.data.records ?? [];
  } catch (e) {
    console.error('è·å–é¢˜åº“åˆ—è¡¨å¤±è´¥ï¼Œ' + e.message);
  }

  try {
    const questionListRes = await listQuestionVoByPageUsingPost({
      pageSize: 12,
      sortField: 'createTime',
      sortOrder: 'descend',
    })
    questionList = questionListRes.data.records ?? [];
  } catch (e) {
    console.error('è·å–é¢˜ç›®åˆ—è¡¨å¤±è´¥ï¼Œ' + e.message);
  }
}
```

å¯ä»¥å…ˆåœ¨é¡µé¢ä¸­å±•ç¤ºè·å–åˆ°çš„æ•°æ®ï¼Œç¡®ä¿è°ƒç”¨æ­£å¸¸ï¼š

```tsx
{JSON.stringify(questionBankList)}
{JSON.stringify(questionList)}
```

#### 2ã€é¢˜ç›®åˆ—è¡¨ç»„ä»¶

æ–°å»ºé¢˜åº“åˆ—è¡¨å’Œé¢˜ç›®åˆ—è¡¨ 2 ä¸ªç»„ä»¶ï¼Œå±•ç¤ºè·å–åˆ°çš„æ•°æ®ï¼Œä¾¿äºå¤ç”¨ã€‚

ğŸ’¡ æ³¨æ„ï¼Œç»„ä»¶è¦ä½¿ç”¨å®¢æˆ·ç«¯æ¸²æŸ“ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/IPmwgmjDGB7H9hgO-1737277028365-64.webp)

å¼€å‘é¢˜åº“åˆ—è¡¨ç»„ä»¶çš„æ³¨æ„äº‹é¡¹ï¼š

1. ä½¿ç”¨ Ant Design çš„ Card.Meta å±•ç¤ºå•ä¸ªé¢˜åº“ï¼Œ[å‚è€ƒæ–‡æ¡£](https://ant-design.antgroup.com/components/card-cn#card-demo-meta)
2. ç”±äºé¢˜åº“æœ‰å›¾ç‰‡ï¼Œåç§°ä¸é•¿ï¼Œé€‚åˆä½¿ç”¨å“åº”å¼æ …æ ¼åˆ—è¡¨ç»„ä»¶ Listï¼Œé€šè¿‡ç¼–å†™ grid å®ç°å“åº”å¼å¸ƒå±€ï¼Œ[å‚è€ƒæ–‡æ¡£](https://ant-design.antgroup.com/components/list-cn#list-demo-grid)
3. ä½¿ç”¨æ–‡æœ¬çœç•¥ç»„ä»¶ï¼Œè®©æè¿°æ˜¾ç¤ºä¸è¶…è¿‡ä¸€è¡Œï¼Œ[å‚è€ƒæ–‡æ¡£](https://ant-design.antgroup.com/components/typography-cn#typography-demo-ellipsisï¼Œ)
4. ç‚¹å‡»é¢˜åº“åï¼Œå¯ä»¥è·³è½¬åˆ°é¢˜åº“è¯¦æƒ…é¡µï¼Œä½¿ç”¨ Next.js çš„ Link ç»„ä»¶å³å¯

ä»£ç å¦‚ä¸‹ï¼š

```tsx
"use client";
import { Avatar, Card, List, Typography } from "antd";
import "./index.css";
import Link from "next/link";

interface Props {
  questionBankList: API.QuestionBankVO[];
}

/**
 * é¢˜åº“åˆ—è¡¨ç»„ä»¶
 * @param props
 * @constructor
 */
const QuestionBankList = (props: Props) => {
  const { questionBankList = [] } = props;

  return (
    <div className="question-bank-list">
      <List
        grid={{
          gutter: 16,
          column: 4,
          xs: 1,
          sm: 2,
          md: 3,
          lg: 3,
        }}
        dataSource={questionBankList}
        renderItem={(item: API.QuestionBankVO) => (
          <List.Item>
            <Card>
              <Link href={`/bank/${item.id}`}>
                <Card.Meta
                  avatar={<Avatar src={item.picture} />}
                  title={item.title}
                  description={
                    <Typography.Paragraph
                      type="secondary"
                      ellipsis={{ rows: 1 }}
                      style={{ marginBottom: 0 }}
                    >
                      {item.description}
                    </Typography.Paragraph>
                  }
                />
              </Link>
            </Card>
          </List.Item>
        )}
      />
    </div>
  );
};

export default QuestionBankList;
```

#### 3ã€é¢˜ç›®åˆ—è¡¨ç»„ä»¶

å¼€å‘é¢˜ç›®åˆ—è¡¨ç»„ä»¶çš„æ³¨æ„äº‹é¡¹ï¼š

1. é¢˜ç›®æ²¡æœ‰å›¾ç‰‡ï¼Œåç§°è¾ƒé•¿ï¼Œé€‚åˆä½¿ç”¨æ°´å¹³åŸºç¡€åˆ—è¡¨ç»„ä»¶ Listï¼Œ[å‚è€ƒæ–‡æ¡£](https://ant-design.antgroup.com/components/list-cn#list-demo-basic)
2. ç‚¹å‡»é¢˜ç›®åï¼Œå¯ä»¥è·³è½¬åˆ°é¢˜ç›®è¯¦æƒ…é¡µ

ä»£ç å¦‚ä¸‹ï¼š

```tsx
"use client";
import { Card, List, Tag } from "antd";
import "./index.css";
import Link from "next/link";

interface Props {
  questionList: API.QuestionVO[];
}

/**
 * é¢˜ç›®åˆ—è¡¨ç»„ä»¶
 * @param props
 * @constructor
 */
const QuestionList = (props: Props) => {
  const { questionList = [] } = props;

  const tagList = (tags: string[] = []) => {
    return tags.map((tag) => {
      return <Tag key={tag}>{tag}</Tag>;
    });
  };

  return (
    <Card className="question-list">
      <List
        dataSource={questionList}
        renderItem={(item: API.QuestionVO) => (
          <List.Item extra={tagList(item.tagList)}>
            <List.Item.Meta
              title={<Link href={`/question/${item.id}`}>{item.title}</Link>}
            />
          </List.Item>
        )}
      />
    </Card>
  );
};

export default QuestionList;
```

å…¶ä¸­ï¼ŒTagList å¯ä»¥å•ç‹¬å°è£…ä¸ºä¸€ä¸ªç»„ä»¶ï¼Œä¾¿äºå¤ç”¨ï¼ˆé¢˜ç›®è¯¦æƒ…é¡µä¹Ÿè¦ç”¨ï¼‰ã€‚ä»£ç å¦‚ä¸‹ï¼š

```tsx
import { Tag } from "antd";
import "./index.css";

interface Props {
  tagList?: string[];
}

/**
 * æ ‡ç­¾åˆ—è¡¨ç»„ä»¶
 * @param props
 * @constructor
 */
const TagList = (props: Props) => {
  const { tagList = [] } = props;

  return (
    <div className="tag-list">
      {tagList.map((tag) => {
        return <Tag key={tag}>{tag}</Tag>;
      })}
    </div>
  );
};

export default TagList;
```

#### 4ã€å…¶ä»–ä¼˜åŒ–

ç”±äºé¡µé¢å¯è§†åŒºåŸŸè¿‡å®½ï¼Œä¼šè®©ç”¨æˆ·çš„è§†é‡è¿‡äºåˆ†æ•£ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/24E6TBPATQKSeWqy-1737277028365-66.webp)

å¯ä»¥é™åˆ¶ä¸‹é¡µé¢æœ€å¤§å®½åº¦ï¼Œåœ¨ `app/globals.css` ä¸­å†™ä¸€ä¸ªé™åˆ¶å®½åº¦çš„é€šç”¨ç±»åï¼š

```css
.max-width-content {
  max-width: 1200px;
  margin: 0 auto;
}
```

ç»™éœ€è¦é™åˆ¶å®½åº¦çš„é¡µé¢å¢åŠ è¯¥ç±»åå³å¯ï¼š

```tsx
<div id="homePage" className="max-width-content">
  ...
</div>
```

æœ€ç»ˆï¼Œä¸»é¡µæ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/WJR9PukLybGoyX7e-1737277028365-68.webp)

#### æ‰©å±•

1ï¼‰å½“é¢˜åº“å’Œé¢˜ç›®è¾ƒå¤šæ—¶ï¼Œå¯ä»¥å…è®¸ç”¨æˆ·æŒ‰ç…§æœ€æ–°ã€çƒ­åº¦ã€ç²¾é€‰ç­‰æ–¹å¼å¯¹é¢˜åº“å’Œé¢˜ç›®è¿›è¡Œæ’åºã€‚

2ï¼‰å¯ä»¥ç»™ä¸»é¡µå¢åŠ å¸å¼•äººçš„ banner å›¾ç‰‡ï¼Œæˆ–è€…æ·»åŠ å…¬å‘Šæ æ¥é€šçŸ¥ç”¨æˆ·æ´»åŠ¨ä¿¡æ¯

### é¢˜åº“åˆ—è¡¨é¡µ

éœ€æ±‚ï¼šå±•ç¤ºæ‰€æœ‰é¢˜åº“åˆ—è¡¨

é¡µé¢ç»“æ„ï¼šè·Ÿä¸»é¡µçš„é¢˜åº“åˆ—è¡¨ç±»ä¼¼ï¼Œå¤ç”¨é¢˜åº“åˆ—è¡¨ç»„ä»¶å³å¯è½»æ¾å®Œæˆå¼€å‘ã€‚

å› ä¸ºè€ƒè™‘åˆ°ç³»ç»Ÿé¢˜åº“æ•°é‡ä¸å¤šï¼Œå¯ä»¥ä¸éœ€è¦åˆ†é¡µå®ç°ï¼Œå‡å°‘å¼€å‘æˆæœ¬ï¼Œè®©åç«¯æ”¯æŒè¿”å›æ›´å¤šé¢˜åº“å³å¯ã€‚

1ï¼‰ä¿®æ”¹åç«¯è·å–é¢˜åº“åˆ—è¡¨æ¥å£ï¼Œæå‡å…è®¸æŠ“å–çš„é¡µé¢å¤§å°ä¸º 200ï¼š

```java
@PostMapping("/list/page/vo")
public BaseResponse<Page<QuestionBankVO>> listQuestionBankVOByPage(
    @RequestBody QuestionBankQueryRequest questionBankQueryRequest,
    HttpServletRequest request) {
    long current = questionBankQueryRequest.getCurrent();
    long size = questionBankQueryRequest.getPageSize();
    // é™åˆ¶çˆ¬è™«
    ThrowUtils.throwIf(size > 200, ErrorCode.PARAMS_ERROR);
    // ...
}
```

2ï¼‰å¼€å‘é¡µé¢ï¼ŒåŸºæœ¬ç›´æ¥å¤åˆ¶ä¸»é¡µä»£ç å°±èƒ½å®Œæˆã€‚ä»£ç å¦‚ä¸‹ï¼š

```tsx
"use server";
import Title from "antd/es/typography/Title";
import { listQuestionBankVoByPageUsingPost } from "@/api/questionBankController";
import QuestionBankList from "@/components/QuestionBankList";
import "./index.css";

/**
 * é¢˜åº“åˆ—è¡¨é¡µé¢
 * @constructor
 */
export default async function BanksPage() {
  let questionBankList = [];
  // é¢˜åº“æ•°é‡ä¸å¤šï¼Œç›´æ¥å…¨é‡è·å–
  const pageSize = 200;

  try {
    const questionBankRes = await listQuestionBankVoByPageUsingPost({
      pageSize,
      sortField: "createTime",
      sortOrder: "descend",
    });
    questionBankList = questionBankRes.data.records ?? [];
  } catch (e) {
    console.error("è·å–é¢˜åº“åˆ—è¡¨å¤±è´¥ï¼Œ" + e.message);
  }

  return (
    <div id="banksPage" className="max-width-content">
      <Title level={3}>é¢˜åº“å¤§å…¨</Title>
      <QuestionBankList questionBankList={questionBankList} />
    </div>
  );
}
```

é¢˜åº“åˆ—è¡¨é¡µçš„æ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/ZcbKEie1SIRioUIj.webp)

### é¢˜ç›®æœç´¢é¡µ

éœ€æ±‚ï¼šé¢˜ç›®æœç´¢é¡µå’Œé¢˜ç›®å¤§å…¨é¡µæœ¬è´¨ä¸Šæ˜¯åŒä¸€ä¸ªé¡µé¢ï¼Œéƒ½æ˜¯èƒ½è®©ç”¨æˆ·é€šè¿‡å„ç§æ¡ä»¶æœç´¢é¢˜ç›®ã€‚ä¸ºäº†é™ä½å¼€å‘æˆæœ¬ï¼Œå¯ä»¥ç»Ÿä¸€ã€‚

ç»“æ„ï¼šå¯ä»¥ç”¨è¡¨æ ¼çš„å½¢å¼å±•ç¤ºé¢˜ç›®åˆ—è¡¨ï¼Œç”±äºé¢˜ç›®æ•°è¾ƒå¤šï¼Œéœ€è¦æ”¯æŒåˆ†é¡µã€‚

éœ€è¦æ”¯æŒçš„æœç´¢æ¡ä»¶ï¼š

- é¢˜ç›®åç§°
- æ ‡ç­¾

#### 1ã€é¡µé¢æ•´ä½“ç»“æ„å¼€å‘

å‚è€ƒä¸»é¡µï¼Œå¼€å‘åŸºç¡€é¡µé¢ç»“æ„ï¼Œå¹¶è·å–åˆ°é¢˜ç›®åˆ—è¡¨æ•°æ®ï¼š

```tsx
import Title from "antd/es/typography/Title";
import QuestionTable from "@/components/QuestionTable";
import { listQuestionVoByPageUsingPost } from "@/api/questionController";
import "./index.css";

/**
 * é¢˜ç›®åˆ—è¡¨é¡µé¢
 * @constructor
 */
export default async function QuestionsPage() {
  let questionList = [];
  let total = 0;

  try {
    const questionRes = await listQuestionVoByPageUsingPost({
      pageSize: 12,
      sortField: "createTime",
      sortOrder: "descend",
    });
    questionList = questionRes.data.records ?? [];
    total = questionRes.data.total ?? 0;
  } catch (e) {
    console.error("è·å–é¢˜ç›®åˆ—è¡¨å¤±è´¥ï¼Œ" + e.message);
  }

  return (
    <div id="questionsPage" className="max-width-content">
      <Title level={3}>é¢˜ç›®å¤§å…¨</Title>
      <div>é¢˜ç›®å†…å®¹</div>
    </div>
  );
}
```

#### 2ã€é¢˜ç›®è¡¨æ ¼ç»„ä»¶

å¯ä»¥å°è£… QuestionTable é¢˜ç›®è¡¨æ ¼ç»„ä»¶ï¼Œä½œä¸ºå…¬å…±ç»„ä»¶ï¼Œä¾¿äºåç»­å¤ç”¨ã€‚

è·Ÿç®¡ç†é¡µé¢å¼€å‘ç±»ä¼¼ï¼Œä½¿ç”¨ [Ant Design ProComponents çš„é«˜çº§è¡¨æ ¼ç»„ä»¶](https://procomponents.ant.design/components/table)ï¼Œå¯ä»¥è½»æ¾å®Œæˆã€‚

é¦–å…ˆè¦æ‰§è¡Œå‘½ä»¤å®‰è£…ç»„ä»¶ï¼š

```shell
npm i @ant-design/pro-table --force
```

ç”±äºè¯¥ç»„ä»¶æ¶‰åŠåˆ°åˆ†é¡µï¼ˆå®¢æˆ·ç«¯äº¤äº’ï¼‰ï¼Œè¦ä½¿ç”¨å®¢æˆ·ç«¯æ¸²æŸ“ï¼Œå¼€å‘ä½“éªŒè·Ÿä½¿ç”¨æ™®é€šçš„ Vueã€React æ¡†æ¶ç±»ä¼¼ã€‚

1ï¼‰é€šè¿‡é«˜çº§è¡¨å•ç»„ä»¶è‡ªå·±çš„è§„åˆ™ï¼Œæ”¹å†™ request è¯·æ±‚å‡½æ•°ï¼Œå³å¯å®ç°è¯·æ±‚æ¡ä»¶æ”¹å˜æ—¶è‡ªåŠ¨è§¦å‘æŸ¥è¯¢ï¼Œè‡ªåŠ¨æ”¯æŒåˆ†é¡µå’Œç­›é€‰ã€‚ä»£ç å¦‚ä¸‹ï¼š

```tsx
"use client";

interface Props {
}

/**
 * é¢˜ç›®è¡¨æ ¼ç»„ä»¶
 * @constructor
 */
export default function QuestionTable(props: Props) {
  const actionRef = useRef<ActionType>();

  /**
   * è¡¨æ ¼åˆ—é…ç½®
   */
  const columns: ProColumns<API.QuestionVO>[] = [
    {
      title: "é¢˜ç›®",
      dataIndex: "title",
      render(_, record) {
        return <Link href={`/question/${record.id}`}>{record.title}</Link>;
      },
    },
    {
      title: "æ ‡ç­¾",
      dataIndex: "tagList",
      valueType: "select",
      fieldProps: {
        mode: "tags"
      },
      render: (_, record) => <TagList tagList={record.tagList} />,
    },
  ];

  return (
    <div className="question-table">
      <ProTable
        actionRef={actionRef}
        columns={columns}
        size="large"
        search={{
          labelWidth: "auto",
        }}
        pagination={
          {
            pageSize: 12,
            showTotal: (total) => `æ€»å…± ${total} æ¡`,
            showSizeChanger: false,
          } as TablePaginationConfig
        }
        request={async (params, sort, filter) => {
          const sortField = Object.keys(sort)?.[0];
          const sortOrder = sort?.[sortField];
          // è¯·æ±‚
          const { data, code } = await listQuestionVoByPageUsingPost({
            ...params,
            sortField,
            sortOrder,
            ...filter,
          } as API.UserQueryRequest);
          // æ›´æ–°ç»“æœ
          const newTotal = Number(data.total) || 0;
          const newData = data.records || [];
          return {
            success: code === 0,
            data: newData,
            total: newTotal,
          };
        }}
        />
    </div>
  );
}
```

#### 3ã€ä½¿ç”¨è¡¨æ ¼ç»„ä»¶

åœ¨é¢˜ç›®åˆ—è¡¨é¡µå¼•å…¥ç»„ä»¶ï¼š

```css
<QuestionTable />
```

éœ€è¦å°†é¡µé¢å®½åº¦è°ƒæ•´ä¸º 100%ï¼Œå¦åˆ™è¡¨æ ¼å®½åº¦ä¼šåŠ¨æ€å˜åŒ–ã€‚ä»£ç å¦‚ä¸‹ï¼š

```css
#questionsPage {
  width: 100%;
}
```

æ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/QoWZHsN14dXc7c1L-1737277028365-70.webp)

#### 4ã€æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“

éœ€è¦æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“ï¼Œå¤–å±‚é¡µé¢å¦‚æœå·²ç»åœ¨æœåŠ¡ç«¯å–å¾—äº†æ•°æ®ï¼Œå¯ä»¥ç›´æ¥å±•ç¤ºï¼Œè€Œä¸ç”¨ç­‰åˆ°å®¢æˆ·ç«¯æ¸²æŸ“æ—¶å†å‘èµ·è¯·æ±‚ã€‚

è§£å†³æ–¹æ¡ˆå¾ˆç®€å•ï¼Œç»™é¢˜ç›®è¡¨æ ¼ç»„ä»¶æ–°å¢é»˜è®¤é¢˜ç›®åˆ—è¡¨ã€é»˜è®¤æ€»æ•°è¿™ 2 ä¸ªå±æ€§ï¼Œå¤–å±‚é¡µé¢ä¼ é€’å·²è·å–åˆ°çš„æ•°æ®ï¼Œä½œä¸ºè¡¨æ ¼ç»„ä»¶çš„åˆå§‹æ•°æ®çŠ¶æ€å³å¯ã€‚

```css
interface Props {
  defaultQuestionList?: API.QuestionVO[];
  defaultTotal?: number;
}
```

åœ¨è¡¨æ ¼ç»„ä»¶ä¸­ï¼Œå°† questionList å’Œ total å®šä¹‰ä¸ºçŠ¶æ€ï¼Œç„¶ååœ¨ request å‡½æ•°ä¸­æ”¹å˜çŠ¶æ€ï¼Œç›¸å½“äºå°† ProTable ä½œä¸ºå—æ§ç»„ä»¶ä½¿ç”¨ã€‚

ä¿®æ”¹çš„ä»£ç å¦‚ä¸‹ï¼š

```tsx
interface Props {
  defaultQuestionList?: API.QuestionVO[];
  defaultTotal?: number;
}

/**
 * é¢˜ç›®è¡¨æ ¼ç»„ä»¶
 * @constructor
 */
export default function QuestionTable(props: Props) {
  const { defaultQuestionList, defaultTotal } = props;
  const [questionList, setQuestionList] = useState<API.QuestionVO[]>(
    defaultQuestionList || [],
  );
  const [total, setTotal] = useState<number>(defaultTotal || 0);

  return (
    <div className="question-table">
      <ProTable
        dataSource={questionList}
        pagination={
          {
            pageSize: 12,
            showTotal: (total) => `æ€»å…± ${total} æ¡`,
            showSizeChanger: false,
            total,
          } as TablePaginationConfig
        }
        request={async (params, sort, filter) => {
          // æ›´æ–°ç»“æœ
          const newTotal = Number(data.total) || 0;
          setTotal(newTotal);
          const newData = data.records || [];
          setQuestionList(newData);
          return {
            success: code === 0,
            data: newData,
            total: newTotal,
          };
        }}
      />
    </div>
  );
}
```

ä½†è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œé¦–æ¬¡æœåŠ¡ç«¯å·²ç»è·å¾—äº†æ•°æ®ï¼Œå®¢æˆ·ç«¯å°±æ²¡å¿…è¦å†è¯·æ±‚ä¸€æ¬¡äº†ï¼Œå¯ä»¥æ–°å¢ init å˜é‡è¿›è¡Œåˆ¤æ–­ã€‚

ä»£ç å¦‚ä¸‹ï¼š

```tsx
const [init, setInit] = useState<boolean>(true);
```

åœ¨ request å‡½æ•°å¼€å¤´æ·»åŠ åˆ¤æ–­é€»è¾‘ï¼š

```tsx
// é¦–æ¬¡è¯·æ±‚
if (init) {
  setInit(false);
  // å¦‚æœå·²æœ‰å¤–å±‚ä¼ æ¥çš„é»˜è®¤æ•°æ®ï¼Œæ— éœ€å†æ¬¡æŸ¥è¯¢
  if (defaultQuestionList && defaultTotal) {
    return;
  }
}
```

#### 5ã€å’Œä¸Šæ–¹æœç´¢æ¡è”åŠ¨

1ï¼‰ä¿®æ”¹ BasicLayout çš„æœç´¢è¾“å…¥æ¡†ï¼Œæœç´¢æ—¶æºå¸¦æœç´¢æ–‡æœ¬è·³è½¬åˆ°é¢˜ç›®æœç´¢é¡µï¼š

```tsx
/**
 * æœç´¢æ¡
 * @constructor
 */
const SearchInput = () => {
  const router = useRouter();

  return (
    <div
      key="SearchOutlined"
      aria-hidden
      style={{
        display: "flex",
        alignItems: "center",
        marginInlineEnd: 24,
      }}
    >
      <Input.Search
        style={{
          borderRadius: 4,
          marginInlineEnd: 12,
        }}
        placeholder="æœç´¢é¢˜ç›®"
        onSearch={(value) => {
          router.push(`/questions?q=${value}`);
        }}
      />
    </div>
  );
};
```

å¯ä»¥å°†æœç´¢è¾“å…¥æ¡†æŠ½è±¡ä¸ºç‹¬ç«‹ç»„ä»¶ï¼Œåœ¨ BasicLayout ä¸‹æ–°å»º componentsï¼Œå› ä¸ºè¯¥æœç´¢ç»„ä»¶ç›®å‰åªæœ‰è¯¥å¸ƒå±€ç”¨åˆ°ã€‚

![img](./assets/04-å‰ç«¯å¼€å‘/zFwQMrtllm6VN8YY-1737277028365-72.webp)

2ï¼‰é¢˜ç›®å¤§å…¨é¡µé¢éœ€è¦è·å–æŸ¥è¯¢æ–‡æœ¬ï¼Œè¿›è¡Œæ“ä½œã€‚

åœ¨ Next.js ä¸­ï¼Œå¯ä»¥é€šè¿‡ searchParams è½»æ¾è·å–åˆ° url çš„æŸ¥è¯¢å‚æ•°ï¼š

```tsx
export default async function QuestionsPage({ searchParams }) {
  const { q: searchText } = searchParams;
  // ...
}
```

ç„¶åè¦åœ¨ 2 ä¸ªåœ°æ–¹ä½¿ç”¨æœç´¢æ–‡æœ¬å‚æ•°ï¼Œä¸€æ–¹é¢æ˜¯æ ¹æ®æœç´¢æ–‡æœ¬åœ¨æœåŠ¡ç«¯æ—¶æŸ¥è¯¢åˆ°åˆå§‹æ•°æ®ï¼š

```tsx
try {
  const questionRes = await listQuestionVoByPageUsingPost({
    title: searchText,
    pageSize: 12,
    sortField: "createTime",
    sortOrder: "descend",
  });
  questionList = questionRes.data.records ?? [];
  total = questionRes.data.total ?? 0;
} catch (e) {
  console.error("è·å–é¢˜ç›®åˆ—è¡¨å¤±è´¥ï¼Œ" + e.message);
}
```

å¦ä¸€æ–¹é¢éœ€è¦å°†å…¶ä¼ é€’ç»™é¢˜ç›®è¡¨æ ¼ç»„ä»¶ï¼Œä½œä¸ºé»˜è®¤æœç´¢æ¡ä»¶ã€‚ä¸ºäº†é€šç”¨æ€§ï¼Œå®šä¹‰ defaultSearchParams å¯¹è±¡ç±»å‹çš„å±æ€§ï¼Œå¯ä¼ é€’å¤šä¸ªé»˜è®¤æœç´¢æ¡ä»¶å­—æ®µã€‚

é¢˜ç›®è¡¨æ ¼ç»„ä»¶çš„å±æ€§æ–°å¢å­—æ®µï¼š

```tsx
interface Props {
  // ...
  // é»˜è®¤æœç´¢æ¡ä»¶
  defaultSearchParams?: API.QuestionQueryRequest;
}
```

åˆ©ç”¨ ProTable çš„åˆå§‹å€¼å±æ€§ initialValuesï¼Œå¯ä»¥å°†é»˜è®¤æœç´¢æ¡ä»¶ä½œä¸ºåˆå§‹å€¼ä¼ é€’ç»™æœç´¢è¡¨å•ï¼š

```tsx
<ProTable
  actionRef={actionRef}
  columns={columns}
  form={{
    initialValues: defaultSearchParams,
  }}
/>
```

3ï¼‰é¢˜ç›®åˆ—è¡¨é¡µé¢ä¼ å…¥æœç´¢æ¡ä»¶ï¼š

```tsx
<QuestionTable defaultQuestionList={questionList} defaultTotal={total} defaultSearchParams={{
  title: searchText,
}} />
```

### é¢˜åº“è¯¦æƒ…é¡µ

éœ€æ±‚ï¼šä»ä¸Šåˆ°ä¸‹å±•ç¤ºé¢˜åº“ä¿¡æ¯ã€ä»¥åŠé¢˜åº“å†…çš„é¢˜ç›®åˆ—è¡¨

#### 1ã€åŸºç¡€é¡µé¢å¼€å‘

æ–°å»ºåŠ¨æ€è·¯ç”±é¡µé¢ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/vd24TRSSc3DHAiOx-1737277028365-77.webp)

åœ¨é¡µé¢ä¸­å¯ä»¥é€šè¿‡ params è·å–åˆ°åŠ¨æ€å‚æ•°ï¼š

```tsx
export default async function BankPage({ params }) {
  const { questionBankId } = params;
}
```

å…ˆè¯·æ±‚é¢˜åº“è¯¦æƒ…æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„æ•°æ®ï¼Œç›´æ¥è¿”å›ä¸€æ®µæ–‡æ¡ˆä½œä¸ºé”™è¯¯å¤„ç†ç»“æœã€‚

ğŸ’¡ ä¹Ÿå¯ä»¥ä½¿ç”¨ Next.js æ”¯æŒçš„å…¨å±€é”™è¯¯å¤„ç† ErrorBoundaryã€‚

ä»£ç å¦‚ä¸‹ï¼š

```tsx
let bank = undefined;

try {
  const bankRes = await getQuestionBankVoByIdUsingGet({
    id: questionBankId,
    needQueryQuestionList: true,
    pageSize: 200,
  });
  bank = bankRes.data;
} catch (e) {
  console.error("è·å–é¢˜åº“è¯¦æƒ…å¤±è´¥ï¼Œ" + e.message);
}

if (!bank) {
  return <div>è·å–é¢˜åº“è¯¦æƒ…å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>;
}
```

ğŸ’¡ æ³¨æ„ï¼ŒæœåŠ¡ç«¯æ¸²æŸ“æ— æ³•ä½¿ç”¨ <AA.BB> å¼•å…¥å­åŒ…çš„ç»„ä»¶ï¼Œå¯ä»¥ç›´æ¥å¼•å…¥

æœ‰äº†æ•°æ®åï¼Œå°±å¯ä»¥å¼€å‘é¡µé¢äº†ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ³¨æ„äº‹é¡¹ï¼š

1. é¡µé¢ä¸Šæ–¹å¤ç”¨ Ant Design çš„ Card.Meta ç»„ä»¶å±•ç¤ºé¢˜åº“ä¿¡æ¯
2. é¡µé¢ä¸‹æ–¹å¤ç”¨ QuestionList é¢˜ç›®åˆ—è¡¨ç»„ä»¶ï¼Œå±•ç¤ºé¢˜ç›®åˆ—è¡¨

æ­¤å¤„æ˜¯è€ƒè™‘åˆ°åŒä¸€é¢˜åº“å†…çš„é¢˜ç›®æ•°é‡ä¸å¤šï¼Œæ‰€ä»¥æš‚æ—¶ä¸éœ€è¦åˆ†é¡µï¼Œå¯ä»¥å°† pageSize è°ƒæ•´å¤§ä¸€äº›ï¼Œç›´æ¥ä½¿ç”¨é¢˜ç›®åˆ—è¡¨ç»„ä»¶å³å¯ã€‚å¦‚æœéœ€è¦å®ç°åˆ†é¡µï¼Œå¯ä»¥ä½¿ç”¨ä¹‹å‰å°è£…çš„ QuestionTable é¢˜ç›®è¡¨æ ¼ç»„ä»¶ã€‚

é¡µé¢ä»£ç å¦‚ä¸‹ï¼š

```tsx
import Title from "antd/es/typography/Title";
import { getQuestionBankVoByIdUsingGet } from "@/api/questionBankController";
import QuestionList from "@/components/QuestionList";
import { Avatar, Button, Card } from "antd";
import Meta from "antd/es/card/Meta";
import Paragraph from "antd/es/typography/Paragraph";
import "./index.css";

/**
 * é¢˜åº“è¯¦æƒ…é¡µé¢
 * @constructor
 */
export default async function BankPage({ params }) {
  const { questionBankId } = params;

  let bank = undefined;

  try {
    const bankRes = await getQuestionBankVoByIdUsingGet({
      id: questionBankId,
      needQueryQuestionList: true,
      pageSize: 200,
    });
    bank = bankRes.data;
  } catch (e) {
    console.error("è·å–é¢˜åº“è¯¦æƒ…å¤±è´¥ï¼Œ" + e.message);
  }

  if (!bank) {
    return <div>è·å–é¢˜åº“è¯¦æƒ…å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>;
  }

  return (
    <div id="bankPage" className="max-width-content">
      <Card>
        <Meta
          avatar={<Avatar src={bank.picture} size={72} />}
          title={
            <Title level={3} style={{ marginBottom: 0 }}>
              {bank.title}
            </Title>
          }
          description={
            <Paragraph type="secondary">{bank.description}</Paragraph>
          }
        ></Meta>
      </Card>
      <div style={{ marginBottom: 16 }} />
      <QuestionList
        questionList={bank.questionPage?.records || []}
      />
    </div>
  );
}
```

#### 2ã€é—®é¢˜ä¿®å¤å’Œä¼˜åŒ–

è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‘ç°ä¸€äº›é—®é¢˜ã€‚

1ï¼‰éœ€è¦ä¿®å¤æ¥å£é—®é¢˜ï¼šåœ¨ getQuestionBankVOById æ¥å£ä¸­ï¼Œæ²¡æœ‰æŠŠæŸ¥è¯¢è¯·æ±‚çš„åˆ†é¡µæ¡ä»¶å’Œå…¶ä»–è¿‡æ»¤æ¡ä»¶ä¼ é€’ç»™ questionService.listQuestionByPage æ–¹æ³•ï¼Œå¯ä»¥æŒ‰éœ€è°ƒæ•´ã€‚

è¿˜è¦å°†è¯¥æ¥å£è¿”å›å€¼çš„ questionPage ç±»å‹ä» Question æ”¹ä¸º QuestionVOï¼Œè·Ÿä¸»é¡µè·å–é¢˜ç›®åˆ†é¡µåˆ—è¡¨æ¥å£ä¿æŒä¸€è‡´ã€‚

ä¿®æ”¹åçš„æ¥å£ä»£ç å¦‚ä¸‹ï¼š

```java
@GetMapping("/get/vo")
public BaseResponse<QuestionBankVO> getQuestionBankVOById(QuestionBankQueryRequest questionBankQueryRequest, HttpServletRequest request) {
    ThrowUtils.throwIf(questionBankQueryRequest == null, ErrorCode.PARAMS_ERROR);
    Long id = questionBankQueryRequest.getId();
    ThrowUtils.throwIf(id <= 0, ErrorCode.PARAMS_ERROR);
    // æŸ¥è¯¢æ•°æ®åº“
    QuestionBank questionBank = questionBankService.getById(id);
    ThrowUtils.throwIf(questionBank == null, ErrorCode.NOT_FOUND_ERROR);
    // æŸ¥è¯¢é¢˜åº“å°è£…ç±»
    QuestionBankVO questionBankVO = questionBankService.getQuestionBankVO(questionBank, request);
    // æ˜¯å¦è¦å…³è”æŸ¥è¯¢é¢˜åº“ä¸‹çš„é¢˜ç›®åˆ—è¡¨
    boolean needQueryQuestionList = questionBankQueryRequest.isNeedQueryQuestionList();
    if (needQueryQuestionList) {
        QuestionQueryRequest questionQueryRequest = new QuestionQueryRequest();
        questionQueryRequest.setQuestionBankId(id);
        // å¯ä»¥æŒ‰éœ€ä¼ é€’æ›´å¤šå‚æ•°
        questionQueryRequest.setPageSize(questionBankQueryRequest.getPageSize());
        questionQueryRequest.setCurrent(questionBankQueryRequest.getCurrent());
        // å°è£… question => questionVO
        Page<Question> questionPage = questionService.listQuestionByPage(questionQueryRequest);
        questionBankVO.setQuestionPage(questionService.getQuestionVOPage(questionPage, request));
    }
    // è·å–å°è£…ç±»
    return ResultUtils.success(questionBankVO);
}
```

2ï¼‰ ç»™ QuestionList é¢˜ç›®åˆ—è¡¨ç»„ä»¶è¡¥å…… cardTitle å±æ€§ï¼Œæ›´ä¼˜é›…åœ°å±•ç¤ºæ ‡é¢˜ã€‚

```tsx
interface Props {
  cardTitle?: React.ReactNode;
  questionList: API.QuestionVO[];
}
```

åº”ç”¨åˆ°ç»„ä»¶å†… Card çš„ title å±æ€§ï¼š

```tsx
<Card className="question-list" title={cardTitle}>
```

ç„¶åå¯ä»¥åœ¨é¡µé¢ä¸­ä½¿ç”¨å±æ€§ï¼Œå±•ç¤º â€œé¢˜ç›®åˆ—è¡¨â€ 4 ä¸ªå­—å’Œå½“å‰é¢˜åº“ä¸‹çš„é¢˜ç›®æ€»æ•°ï¼š

```tsx
<QuestionList
  questionList={bank.questionPage?.records || []}
  cardTitle={`é¢˜ç›®åˆ—è¡¨ï¼ˆ${bank.questionPage?.total || 0}ï¼‰`}
  questionBankId={questionBankId}
/>
```

3ï¼‰å¦‚æœé¢˜åº“ä¸ºç©ºï¼Œæ¥å£è¿˜æ˜¯ä¼šè¿”å›æ‰€æœ‰é¢˜ç›®æ•°æ®ã€‚è¿™æ˜¯å› ä¸ºä¹‹å‰åç«¯ service ä¸­åˆ†é¡µè·å–é¢˜ç›®åˆ—è¡¨çš„ listQuestionByPage æ–¹æ³•æœ‰è¯¯ã€‚å½“æŸ¥è¯¢ä¸åˆ°é¢˜åº“é¢˜ç›®å…³ç³»æ—¶ï¼Œåº”è¯¥ç›´æ¥è¿”å›ç©ºé¡µé¢ï¼Œè€Œä¸æ˜¯ä¸é™å®š questionId in çš„æ¡ä»¶ï¼Œå¯¼è‡´äº†å…¨é‡æŸ¥è¯¢ã€‚

ä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š

```java
if (CollUtil.isNotEmpty(questionList)) {
    // å–å‡ºé¢˜ç›® id é›†åˆ
    Set<Long> questionIdSet = questionList.stream()
            .map(QuestionBankQuestion::getQuestionId)
            .collect(Collectors.toSet());
    // å¤ç”¨åŸæœ‰é¢˜ç›®è¡¨çš„æŸ¥è¯¢æ¡ä»¶
    queryWrapper.in("id", questionIdSet);
} else {
    // é¢˜åº“ä¸ºç©ºï¼Œåˆ™è¿”å›ç©ºåˆ—è¡¨
    return new Page<>(current, size, 0);
}
```

#### 3ã€è¶…é“¾æ¥è·³è½¬

æä¾› 2 ç§è·³è½¬åˆ°é¢˜ç›®è¯¦æƒ…é¡µè¿›è¡Œåˆ·é¢˜çš„æ–¹å¼ã€‚

1ï¼‰è¡¥å……å¼€å§‹åˆ·é¢˜æŒ‰é’®ï¼Œé»˜è®¤è·³è½¬åˆ°ç¬¬ä¸€é“é¢˜ç›®ï¼Œæ²¡æœ‰é¢˜ç›®åˆ™ç¦ç”¨ï¼š

```tsx
// è·å–ç¬¬ä¸€é“é¢˜ç›®ï¼Œç”¨äº â€œå¼€å§‹åˆ·é¢˜â€ æŒ‰é’®è·³è½¬
let firstQuestionId;
if (bank.questionPage?.records && bank.questionPage.records.length > 0) {
  firstQuestionId = bank.questionPage.records[0].id;
}
```

æŒ‰é’®ä»£ç å¦‚ä¸‹ï¼š

```tsx
<Button
  type="primary"
  shape="round"
  disabled={!firstQuestionId}
  href={`/bank/${questionBankId}/question/${firstQuestionId}`}
  target="_blank"
>
  å¼€å§‹åˆ·é¢˜
</Button>
```

2ï¼‰ä¹‹å‰çš„é¢˜ç›®åˆ—è¡¨é¡µè·³è½¬åˆ°çš„æ˜¯å•ä¸ªé¢˜ç›®è¯¦æƒ…ï¼Œè€Œä»é¢˜åº“ç‚¹å¼€çš„é¢˜ç›®åº”è¯¥æ˜¯è¿›åˆ°é¢˜åº“é¢˜ç›®è¯¦æƒ…é¡µï¼Œä¼šé¢å¤–åœ¨å·¦ä¾§å±•ç¤ºé¢˜åº“å†…çš„å…¶ä»–é¢˜ç›®ã€‚æ‰€ä»¥éœ€è¦åŒºåˆ†é¢˜åº“è¯¦æƒ…é¡µä¸­é¢˜ç›®åˆ—è¡¨é¡¹çš„ç‚¹å‡»è·³è½¬åœ°å€ã€‚

ç»™é¢˜ç›®åˆ—è¡¨ç»„ä»¶å¢åŠ  questionBankId å±æ€§ï¼š

```tsx
interface Props {
  questionBankId?: number;
  cardTitle?: React.ReactNode;
  questionList: API.QuestionVO[];
}
```

å¯ä»¥æ ¹æ®é¢˜åº“ id æ˜¯å¦å­˜åœ¨ï¼Œæ¥åŒºåˆ†è·³è½¬åœ°å€ï¼š

```tsx
<Link
  href={
    questionBankId
      ? `/bank/${questionBankId}/question/${item.id}`
      : `/question/${item.id}`
  }
>
  {item.title}
</Link>
```

é¢˜åº“è¯¦æƒ…é¡µçš„æ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/cHsnkgE1B7oM2cMD.webp)

#### æ‰©å±•

å½“é¢˜åº“è¿‡å¤šæ—¶ï¼Œå¯ä»¥é‡‡ç”¨æ»šåŠ¨ä¸‹æ‹‰åˆ†é¡µåŠ è½½ã€‚React æœ‰ç°æˆçš„æ— é™æ»šåŠ¨åŠ è½½ç»„ä»¶ã€‚

### é¢˜ç›®è¯¦æƒ…é¡µ

éœ€æ±‚ï¼šæœ‰ä¸¤ç§ä¸åŒçš„é¢˜ç›®è¯¦æƒ…é¡µ

1. ä»é¢˜åº“è¿›å…¥çš„é¢˜ç›®è¯¦æƒ…é¡µï¼šå·¦ä¾§éœ€è¦å±•ç¤ºé¢˜åº“å†…çš„é¢˜ç›®åˆ—è¡¨ã€‚è·¯ç”±ï¼š/bank/[bankId]/question/[questionId]
2. ä»å…¶ä»–ä½ç½®ï¼ˆæ¯”å¦‚ä¸»é¡µã€æœç´¢é¡µï¼‰è¿›å…¥çš„é¢˜ç›®è¯¦æƒ…é¡µï¼Œä¸éœ€è¦å±•ç¤ºé¢˜åº“åˆ—è¡¨ã€‚è·¯ç”±ï¼š/question/[questionId]

è¿™ä¸¤ä¸ªé¡µé¢æä¸ºç›¸ä¼¼ï¼Œå¯ä»¥ç›´æ¥å¼€å‘é¢å¤–å±•ç¤ºé¢˜ç›®åˆ—è¡¨çš„é¢˜ç›®è¯¦æƒ…é¡µï¼Œå¦ä¸€ä¸ªé¡µé¢å¤åˆ¶å¹¶åˆ å‡å³å¯ã€‚

#### 1ã€é¡µé¢æ•´ä½“ç»“æ„å¼€å‘

1ï¼‰é€‰æ‹© Flex ä¸€è¡Œä¸¤åˆ—å¸ƒå±€ï¼Œå·¦è¾¹ Sider ä¾§è¾¹æ å±•ç¤ºé¢˜ç›®åˆ—è¡¨ã€å³è¾¹ Content å±•ç¤ºå†…å®¹ï¼Œå¯ä»¥ [å‚è€ƒå®˜æ–¹æ–‡æ¡£](https://ant-design.antgroup.com/components/layout-cn#layout-demo-top-side-2) å®ç°å¸ƒå±€ã€‚

```tsx
<div id="bankQuestionPage">
  <Flex gap={24}>
    <Sider width={240} theme="light" style={{ padding: "24px 0" }}>
      <Title level={4} style={{ padding: "0 20px" }}>
        é¢˜åº“æ ‡é¢˜
      </Title>
      <Menu />
    </Sider>
    <Content>
      é¢˜ç›®è¯¦æƒ…
    </Content>
  </Flex>
</div>
```

2ï¼‰ä» url ä¸­è·å–é¢˜åº“ id å’Œé¢˜ç›® idï¼Œç„¶åè¯·æ±‚è¯¦æƒ…æ•°æ®ï¼š

```tsx
export default async function BankQuestionPage({ params }) {
  const { questionBankId, questionId } = params;

  let bank = undefined;
  try {
    const bankRes = await getQuestionBankVoByIdUsingGet({
      id: questionBankId,
      needQueryQuestionList: true,
      pageSize: 200,
    });
    bank = bankRes.data;
  } catch (e) {
    console.error("è·å–é¢˜åº“è¯¦æƒ…å¤±è´¥ï¼Œ" + e.message);
  }
  if (!bank) {
    return <div>è·å–é¢˜åº“è¯¦æƒ…å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>;
  }

  let question = undefined;
  try {
    const questionRes = await getQuestionVoByIdUsingGet({
      id: questionId,
    });
    question = questionRes.data;
  } catch (e) {
    console.error("è·å–é¢˜ç›®è¯¦æƒ…å¤±è´¥ï¼Œ" + e.message);
  }
  if (!question) {
    return <div>è·å–é¢˜ç›®è¯¦æƒ…å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>;
  }
}
```

æ¥ä¸‹æ¥å°±å¯ä»¥ä¾æ¬¡å®ç°å·¦ä¾§èœå•å’Œå³ä¾§å†…å®¹çš„å±•ç¤ºäº†ã€‚

#### 2ã€é¢˜ç›®åˆ—è¡¨èœå•

èœå•éœ€è¦æ”¯æŒç‚¹å‡»å’Œé«˜äº®ï¼Œå¯ä»¥ä½¿ç”¨ Ant Design çš„ Menu ç»„ä»¶ï¼Œå‚è€ƒ [å®˜æ–¹æ–‡æ¡£](https://ant-design.antgroup.com/components/menu-cn)ã€‚

é¦–å…ˆè·å–é¢˜ç›®èœå•åˆ—è¡¨ï¼Œå°†é¢˜ç›®åˆ—è¡¨æ•°æ®è½¬ä¸º Menu æ¥å—çš„æ•°æ®æ ¼å¼å³å¯ï¼š

```tsx
// é¢˜ç›®èœå•åˆ—è¡¨
const questionMenuItemList = (bank.questionPage?.records || []).map(
  (q) => {
    return {
      label: q.title,
      key: q.id,
    };
  },
);
```

ç„¶åä¼ é€’ç»™ Menu ç»„ä»¶ï¼š

```tsx
<Menu items={questionMenuItemList} />
```

#### 3ã€é¢˜ç›®è¯¦æƒ…ç»„ä»¶

ç”±äºä¸¤ç§é¢˜ç›®è¯¦æƒ…é¡µéƒ½éœ€è¦å±•ç¤ºé¢˜ç›®è¯¦æƒ…ï¼Œæ‰€ä»¥å°è£…ä¸ºç‹¬ç«‹ç»„ä»¶ã€‚

ä»ä¸Šåˆ°ä¸‹å±•ç¤ºé¢˜ç›®ä¿¡æ¯å³å¯ï¼Œæ³¨æ„å±•ç¤ºé¢˜ç›®å†…å®¹å’Œç­”æ¡ˆæ—¶ä½¿ç”¨ MdViewer ç»„ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š

```tsx
"use client";
import { Card } from "antd";
import Title from "antd/es/typography/Title";
import MdViewer from "@/components/MdViewer";
import "./index.css";
import TagList from "@/components/TagList";

interface Props {
  question: API.QuestionVO;
}

/**
 * é¢˜ç›®å¡ç‰‡ç»„ä»¶
 * @param props
 * @constructor
 */
const QuestionCard = (props: Props) => {
  const { question } = props;

  return (
    <div className="question-card">
      <Card bordered={false}>
        <Title level={1} style={{ fontSize: 24 }}>
          {question.title}
        </Title>
        <TagList tagList={question.tagList} />
        <div style={{ marginBottom: 16 }} />
        <MdViewer value={question.content} />
      </Card>
      <div style={{ marginBottom: 16 }} />
      <Card title="æ¨èç­”æ¡ˆ" bordered={false}>
        <MdViewer value={question.answer} />
      </Card>
    </div>
  );
};

export default QuestionCard;
```

#### 4ã€åˆ‡æ¢å’Œé«˜äº®é¢˜ç›®

ç‚¹å‡»èœå•æ—¶ï¼Œéœ€è¦åˆ‡æ¢é¢˜ç›®ï¼Œç»™èœå•ç»„ä»¶å¢åŠ è¶…é“¾æ¥å³å¯ï¼š

```tsx
// é¢˜ç›®èœå•åˆ—è¡¨
const questionMenuItemList = (bank.questionPage?.records || []).map(
  (question) => {
    return {
      label: <Link href={`/bank/${bank.id}/question/${question.id}`} prefetch={false}>{question.title}</Link>,
      key: question.id,
    };
  },
);
```

è¿˜éœ€è¦åœ¨èœå•ä¸­é«˜äº®å½“å‰é¢˜ç›®ï¼Œå¯ä»¥é€šè¿‡ Menu ç»„ä»¶çš„ selectedKeys å±æ€§å®ç°é€‰ä¸­é«˜äº®ã€‚æ ¹æ® questionId è¿›è¡ŒåŒ¹é…ï¼Œä»£ç å¦‚ä¸‹ï¼š

```tsx
<Menu items={questionMenuItemList} selectedKeys={[questionId]} />
```

#### 5ã€ä¼˜åŒ– MdViewer å±•ç¤ºæ•ˆæœ

ç›®å‰ç¼–è¾‘å™¨çš„å±•ç¤ºæ•ˆæœä¸ä½³ï¼Œå¯ä»¥å‚è€ƒ ByteMD ç»„ä»¶çš„æŒ‡å¼•ï¼Œä¸‹è½½ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œæ¯”å¦‚ GitHub çš„ä¸»é¢˜ï¼šhttps://github.com/sindresorhus/github-markdown-css

å‚è€ƒä¸Šæ–¹æ–‡æ¡£å®‰è£…ä¹‹åï¼Œåœ¨ MdViewer å’Œ MdEditor ä¸­å¼•å…¥æ ·å¼æ–‡ä»¶ï¼š

```tsx
import 'github-markdown-css/github-markdown-light.css';
```

æ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/e9p8xTZCXRsi2G3h-1737277028365-75.webp)

ç›´æ¥æŠŠå¼€å‘å¥½çš„ question ç›®å½•å¤åˆ¶åˆ° app ç›®å½•ä¸‹ï¼Œåˆ é™¤èœå•æ å’Œé¢˜åº“è·å–é€»è¾‘ï¼Œå³å¯å¾—åˆ°å•ä¸ªé¢˜ç›®è¯¦æƒ…é¡µï¼Œä»£ç å¦‚ä¸‹ï¼š

```tsx
import { getQuestionBankVoByIdUsingGet } from "@/api/questionBankController";
import { Flex } from "antd";
import React from "react";
import { getQuestionVoByIdUsingGet } from "@/api/questionController";
import QuestionCard from "@/components/QuestionCard";
import "./index.css";

/**
 * é¢˜ç›®è¯¦æƒ…é¡µé¢
 * @constructor
 */
export default async function QuestionPage({ params }) {
  const { questionId } = params;

  let question = undefined;
  try {
    const questionRes = await getQuestionVoByIdUsingGet({
      id: questionId,
    });
    question = questionRes.data;
  } catch (e) {
    console.error("è·å–é¢˜ç›®è¯¦æƒ…å¤±è´¥ï¼Œ" + e.message);
  }
  if (!question) {
    return <div>è·å–é¢˜ç›®è¯¦æƒ…å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>;
  }

  return (
    <div id="questionPage" className="max-width-content">
      <QuestionCard question={question} />
    </div>
  );
}
```

æ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/M9VvBl0Rs1Q08hfW-1737277028365-80.webp)

#### æ‰©å±•

1ï¼‰æ”¯æŒæŠ˜å é¢˜ç›®åˆ—è¡¨èœå•ï¼šAnt Design çš„ Menu ç»„ä»¶æ”¯æŒè‡ªå®šä¹‰èœå•æŠ˜å è§¦å‘å™¨ï¼Œ[å‚è€ƒæ–‡æ¡£](https://ant-design.antgroup.com/components/menu-cn#menu-demo-inline-collapsed)ã€‚

2ï¼‰é¢˜åº“å’Œé¢˜ç›®è¯¦æƒ…é¡µçš„å³ä¾§å¯ä»¥å±•ç¤ºç›®å½•ã€å†…å®¹æ¨èç­‰

3ï¼‰é¢˜ç›®è¯¦æƒ…é¡µå¯ä»¥å¢åŠ ä¸Šä¸€é¢˜ã€ä¸‹ä¸€é¢˜çš„è·³è½¬

## ä¸‰ã€é¢˜ç›®é¢˜åº“ç»‘å®š

ä¸šåŠ¡æµç¨‹ï¼šç›´æ¥å¤ç”¨å·²æœ‰çš„é¢˜ç›®ç®¡ç†é¡µé¢ï¼Œç®¡ç†å‘˜å¯ä»¥åœ¨è¯¥é¡µé¢æŸ¥è¯¢é¢˜ç›®åˆ—è¡¨ï¼ˆæ¯”å¦‚æ ¹æ®é¢˜åº“æŸ¥è¯¢ï¼‰ï¼Œç„¶åå¯¹è¿™äº›é¢˜ç›®è¿›è¡Œæ“ä½œï¼Œæ¯”å¦‚ä¿®æ”¹é¢˜ç›®æ‰€å±é¢˜åº“ï¼ˆæ·»åŠ æˆ–ç§»é™¤é¢˜ç›®é¢˜åº“ç»‘å®šå…³ç³»ï¼‰ã€‚

### æŒ‰ç…§é¢˜åº“æŸ¥è¯¢é¢˜ç›®

åœ¨é¢˜ç›®ç®¡ç†é¡µé¢çš„ columns ä¸­æ–°å¢å­—æ®µï¼Œè¦æ±‚è¡¨æ ¼ä¸­ä¸å¯è§ï¼Œä»…ç”¨äºè¡¨å•æŸ¥è¯¢ï¼š

```tsx
{
  title: "æ‰€å±é¢˜åº“",
  dataIndex: "questionBankId",
  hideInTable: true,
  hideInForm: true,
},
```

æ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/icR6nK92gCaC8kuX-1737277028366-84.webp)

### ä¿®æ”¹é¢˜ç›®æ‰€å±é¢˜åº“

å¯ä»¥å‚è€ƒä¿®æ”¹é¢˜ç›®ä¿¡æ¯çš„åšæ³•ï¼Œåœ¨é¢˜ç›®ç®¡ç†é¡µé¢çš„ç›®å½•ä¸‹ï¼Œæ–°å¢ä¸€ä¸ªå¼¹çª—è¡¨å•ç»„ä»¶ã€‚

#### 1ã€ä¿®æ”¹é¢˜åº“å¼¹çª—ç»„ä»¶

ç›´æ¥å¤åˆ¶é¢˜ç›®ä¿®æ”¹å¼¹çª—ç»„ä»¶ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹å³å¯ã€‚

åº”è¯¥å¦‚ä½•è®©ç”¨æˆ·æ·»åŠ æˆ–ç§»é™¤é¢˜ç›®ç»‘å®šçš„é¢˜åº“å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨ [Ant Design çš„ Select å¤šé€‰ç»„ä»¶](https://ant-design.antgroup.com/components/select-cn#select-methods)ï¼Œæ¥ä»é¢˜åº“åˆ—è¡¨ä¸­é€‰æ‹©é¢˜åº“ã€‚é€‰ä¸­æ—¶è°ƒç”¨åŠ å…¥é¢˜åº“æ¥å£ï¼Œå–æ¶ˆé€‰ä¸­æ—¶è°ƒç”¨ä»é¢˜åº“ç§»é™¤æ¥å£ã€‚

ğŸ’¡ è¿˜æœ‰å…¶ä»–çš„å®ç°æ–¹å¼ï¼Œæ¯”å¦‚å¤šé€‰æ‰€å±é¢˜åº“åˆ—è¡¨åï¼Œç‚¹å‡»æäº¤æŒ‰é’®ï¼Œæ‰æäº¤åˆ°åç«¯ï¼Œç”±åç«¯è®¡ç®—åº”è¯¥å¦‚ä½•å¤„ç†é¢˜åº“é¢˜ç›®ç»‘å®šå…³ç³»ã€‚

ç»„ä»¶å±æ€§å¦‚ä¸‹ï¼š

```tsx
interface Props {
  questionId?: number;
  visible: boolean;
  onCancel: () => void;
}
```

è¡¨å•ä»£ç å¦‚ä¸‹ï¼š

```tsx
<Form style={{ marginTop: 24 }}>
  <Form.Item label="æ‰€å±é¢˜åº“">
    <Select
      mode="multiple"
      style={{ width: "100%" }}
      defaultValue={["a10", "c12"]}
      onSelect={(value) => {
        alert("é€‰ä¸­ï¼š" + value);
      }}
      onDeselect={(value) => {
        alert("å–æ¶ˆé€‰ä¸­ï¼š" + value);
      }}
      options={[]}
    />
  </Form.Item>
</Form>
```

#### 2ã€ä½¿ç”¨å¼¹çª—ç»„ä»¶

1ï¼‰åœ¨é¢˜ç›®ç®¡ç†é¡µé¢æ–°å¢ visible å˜é‡ï¼Œç”¨äºæ§åˆ¶å¼¹çª—æ˜¯å¦æ˜¾ç¤ºï¼š

```tsx
// æ˜¯å¦æ˜¾ç¤ºæ›´æ–°æ‰€å±é¢˜åº“çš„å¼¹çª—
const [updateBankModalVisible, setUpdateBankModalVisible] = useState<boolean>(false);
```

2ï¼‰æ–°å¢æ“ä½œæŒ‰é’®ï¼Œè§¦å‘æ‰“å¼€å¼¹çª—ï¼š

```tsx
<Typography.Link
  onClick={() => {
    setCurrentRow(record);
    setUpdateBankModalVisible(true);
  }}
>
  ä¿®æ”¹æ‰€å±é¢˜åº“
</Typography.Link>
```

3ï¼‰å¼•å…¥å¼¹çª—ç»„ä»¶ï¼Œå¹¶ä¼ é€’å±æ€§ï¼š

```tsx
<UpdateBankModal
    visible={updateBankModalVisible}
    questionId={currentRow?.id}
    onCancel={() => {
      setCurrentRow(undefined);
      setUpdateBankModalVisible(false);
    }}
/>
```

#### 3ã€å¡«å……é»˜è®¤å€¼ - è·å–æ‰€å±é¢˜åº“åˆ—è¡¨

å¦‚æœé¢˜ç›®å·²æœ‰æ‰€å±é¢˜åº“ï¼Œåº”è¯¥åœ¨ä¿®æ”¹è¡¨å•ä¸­å±•ç¤ºã€‚

å¯ä»¥é€šè¿‡è·å–é¢˜åº“é¢˜ç›®å…³ç³»æ¥å£ï¼Œè·å–åˆ°å½“å‰é¢˜ç›®æ‰€å±çš„é¢˜åº“åˆ—è¡¨ï¼Œä»…éœ€è·å–ä¸€æ¬¡ï¼Œç„¶åå¡«å……åˆ°è¡¨å•ä¸­ä½œä¸ºåˆå§‹å€¼ã€‚ä»£ç å¦‚ä¸‹ï¼š

```tsx
const [form] = Form.useForm();

// è·å–æ‰€å±é¢˜åº“åˆ—è¡¨
const getCurrentQuestionBankIdList = async () => {
  try {
    const res = await listQuestionBankQuestionByPageUsingPost({
      questionId,
      pageSize: 20,
    });
    const list = (res.data.records ?? []).map((item) => item.questionBankId);
    form.setFieldValue("questionBankIdList" as any, list);
  } catch (e) {
    console.error("è·å–é¢˜ç›®æ‰€å±é¢˜åº“åˆ—è¡¨å¤±è´¥ï¼Œ" + e.message);
  }
};

useEffect(() => {
  if (questionId) {
    getCurrentQuestionBankIdList();
  }
}, [questionId]);
```

ç»™è¡¨å•ç»„ä»¶æ·»åŠ  form å¼•ç”¨ï¼š

```tsx
<Form form={form} style={{ marginTop: 24 }}>
</Form>
```

#### 4ã€è·å–å¯é€‰é¢˜åº“

é¢˜åº“å¾ˆå¤šï¼Œä¸å¯èƒ½è®©ç®¡ç†å‘˜æ‰‹åŠ¨è¾“å…¥ id æ¥é€‰é¢˜åº“ï¼Œåº”è¯¥æ˜¾ç¤ºå¯é€‰é¢˜åº“åˆ—è¡¨å’Œé¢˜åº“åç§°ï¼Œæé«˜é€‰æ‹©æ•ˆç‡ã€‚

ç”±äºé¢˜åº“æ•°é‡ä¸å¤šï¼Œç›´æ¥å…¨é‡è·å–åˆ°é¢˜åº“åˆ—è¡¨å³å¯ï¼š

```tsx
const [questionBankList, setQuestionBankList] = useState<
  API.QuestionBankVO[]
>([]);

// è·å–é¢˜åº“åˆ—è¡¨
const getQuestionBankList = async () => {
  // é¢˜åº“æ•°é‡ä¸å¤šï¼Œç›´æ¥å…¨é‡è·å–
  const pageSize = 200;
  try {
    const questionBankRes = await listQuestionBankVoByPageUsingPost({
      pageSize,
      sortField: "createTime",
      sortOrder: "descend",
    });
    setQuestionBankList(questionBankRes.data.records ?? []);
  } catch (e) {
    console.error("è·å–é¢˜åº“åˆ—è¡¨å¤±è´¥ï¼Œ" + e.message);
  }
};

useEffect(() => {
  getQuestionBankList();
}, []);
```

ç„¶åè®¡ç®—å‡º Select ç»„ä»¶éœ€è¦çš„é€‰é¡¹ï¼š

```tsx
<Select
  mode="multiple"
  style={{ width: "100%" }}
  defaultValue={currentQuestionBankIdList}
  onSelect={(value) => {
    alert("é€‰ä¸­ï¼š" + value);
  }}
  onDeselect={(value) => {
    alert("å–æ¶ˆé€‰ä¸­ï¼š" + value);
  }}
  options={questionBankList.map((questionBank) => {
    return {
      label: questionBank.title,
      value: questionBank.id,
    };
  })}
/>
```

#### 5ã€é€‰ä¸­æˆ–å–æ¶ˆé€‰ä¸­é¢˜åº“

åˆ©ç”¨ Select çš„é€‰ä¸­å’Œå–æ¶ˆé€‰ä¸­äº‹ä»¶ï¼Œè°ƒç”¨æ¥å£å®ç°é¢˜åº“ç»‘å®š / è§£ç»‘ï¼š

```tsx
onSelect={async (value) => {
  const hide = message.loading("æ­£åœ¨æ›´æ–°");
  try {
    await addQuestionBankQuestionUsingPost({
      questionId,
      questionBankId: value,
    });
    hide();
    message.success("ç»‘å®šé¢˜åº“æˆåŠŸ");
  } catch (error: any) {
    hide();
    message.error("ç»‘å®šé¢˜åº“å¤±è´¥ï¼Œ" + error.message);
  }
}}
onDeselect={async (value) => {
  const hide = message.loading("æ­£åœ¨æ›´æ–°");
  try {
    await removeQuestionBankQuestionUsingPost({
      questionId,
      questionBankId: value,
    });
    hide();
    message.success("å–æ¶ˆç»‘å®šé¢˜åº“æˆåŠŸ");
  } catch (error: any) {
    hide();
    message.error("å–æ¶ˆç»‘å®šé¢˜åº“å¤±è´¥ï¼Œ" + error.message);
  }
}}
```

æ•ˆæœå¦‚å›¾ï¼š

![img](./assets/04-å‰ç«¯å¼€å‘/IqeVm4t80DnFGk5F-1737277028366-82.webp)

#### æ‰©å±•

1ï¼‰æ”¯æŒåœ¨é¢˜åº“ç®¡ç†é¡µé¢ç›´æ¥æœç´¢å’Œæ·»åŠ é¢˜ç›®åˆ°é¢˜åº“ä¸­ï¼Œå®ç°æ–¹å¼å’Œä¸Šé¢ç±»ä¼¼ã€‚

2ï¼‰é¢˜åº“æ•°é‡è¾ƒå¤šæ—¶ï¼Œå¯ä»¥æ ¹æ®ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œé˜²æŠ–æœç´¢ï¼Œè€Œä¸æ˜¯å…¨é‡å°†é¢˜åº“åˆ—è¡¨åŠ è½½åˆ°å¯é€‰é¡¹ã€‚å¯å‚è€ƒ [å®˜æ–¹æ–‡æ¡£](https://ant-design.antgroup.com/components/select-cn#select-demo-select-users)ã€‚

## å››ã€æ‰©å±•æ€è·¯

ä»¥ä¸‹å†…å®¹å‰ç«¯åŒå­¦å…¨éƒ½å¯å†™åˆ°ç®€å†ä¸Šï¼š

#### 1ã€é¢„æ¸²æŸ“

é€šè¿‡ [å®˜æ–¹æ–‡æ¡£](https://nextjs.org/docs/app/api-reference/components/link#prefetch) äº†è§£ Next.js çš„ prefetch é¢„æ¸²æŸ“æœºåˆ¶ï¼Œè¿›è¡Œæ€§èƒ½ä¼˜åŒ–ã€‚

æ¯”å¦‚é¡µé¢å†…çš„é“¾æ¥è¿‡å¤šæ—¶ï¼Œé¢„æ¸²æŸ“æ¬¡æ•°ä¼šå¾ˆå¤šï¼Œå¯ä»¥å°† prefetch å…³é—­æ¥å‡å°‘é¢„æ¸²æŸ“ï¼š

```tsx
<Link href={`/question/${question.id}`} prefetch={false}>{question.title}</Link>
```

#### 2ã€Metadata

Next.js æ”¯æŒé€šè¿‡ Metadata è®¾ç½®é¡µé¢çš„ TDKï¼ˆæ ‡é¢˜ã€æè¿°ã€å…³é”®è¯ï¼‰ç­‰ç½‘é¡µå…ƒä¿¡æ¯ã€‚å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šhttps://nextjs.org/docs/app/building-your-application/optimizing/metadata

```tsx
import type { Metadata } from 'next'
 
export const metadata: Metadata = {
  title: '...',
  description: '...',
}
 
export default function Page() {}
```

#### 3ã€è¯·æ±‚ç¼“å­˜

Next.js æ‰©å±•äº†åŸç”Ÿçš„ fetchï¼Œæ”¯æŒè¯·æ±‚æ•°æ®çš„æœåŠ¡ç«¯ç¼“å­˜ï¼Œæ˜¯æå‡æ€§èƒ½ã€å‡å°‘èµ„æºå ç”¨çš„å¥½æ–¹æ³•ã€‚

å¯ä»¥å‚è€ƒå®˜æ–¹è·å–æ•°æ®çš„æ–‡æ¡£ï¼šhttps://nextjs.org/docs/app/building-your-application/data-fetching

ä½†æ˜¯ï¼Œæˆ‘ä»¬é¡¹ç›®ä¸­ä½¿ç”¨çš„ Axios åº“æ˜¯ä¸æ”¯æŒç¼“å­˜çš„ï¼æœ‰å…¶ä»–çš„æ–¹å¼æ¥å®ç°ç¼“å­˜ï¼š

1ï¼‰å¯ä»¥åœ¨ getStaticProps æˆ– getServerSideProps ä¸­ä½¿ç”¨ Axios æ¥è·å–æ•°æ®ï¼Œç„¶åé€šè¿‡ Next.js çš„ revalidate é€‰é¡¹æ¥æ§åˆ¶é¡µé¢æˆ–æ•°æ®çš„é‡æ–°ç”Ÿæˆæ—¶é—´ã€‚

å‚è€ƒä»£ç å¦‚ä¸‹ï¼š

```javascript
export async function getStaticProps() {
  const response = await axios.get('https://mianshiya.com/data', {
    headers: {
      'Cache-Control': 'no-store',
    },
  });

  return {
    props: {
      data: response.data,
    },
    revalidate: 10000, // åœ¨ 10,000 ç§’åé‡æ–°ç”Ÿæˆé¡µé¢
  };
}
```

2ï¼‰åˆ‡æ¢å…¶ä»–è¯·æ±‚åº“ï¼Œæ¯”å¦‚åŸç”Ÿçš„ fetchï¼Œæˆ–è€…å®˜æ–¹æ¨èçš„è¯·æ±‚åº“ï¼šhttps://swr.vercel.app/zh-CN

#### 4ã€å¹¶å‘è¯·æ±‚

å¦‚æœåŒä¸€ä¸ªé¡µé¢è¦å¤šæ¬¡è¯·æ±‚åç«¯ï¼Œä¸²è¡Œå¯èƒ½ä¼šå¾ˆæ…¢ï¼Œå¯¼è‡´é¡µé¢è¿Ÿè¿Ÿä¸è¿”å›ã€‚å› æ­¤å¯ä»¥å¹¶å‘è°ƒç”¨å¤šä¸ªæ¥å£æ¥è·å–æ•°æ®ï¼Œä½¿ç”¨ promise.all è¯­æ³•å³å¯ã€‚