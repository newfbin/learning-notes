# 

# 计算机网络



## * 介绍一下TCP/IP模型和OSI模型的区别

### OSI模型

OSI模型是国际标准化组织（ISO）指定的，它将计算机通信分为七层，每一层都负责特定的功能。
OSI包含七层，从下到上分别是是物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。每一层都基于上一层构建，并且为下一层提供服务。OSI模型虽然理论完善，但是它的并未被广泛使用，更多被作为教学和理论分析的参考框架。与OSI模型相比，TCP/IP模型完全以实用为导向，几乎所有现代网络都基于TCP/IP模型。

### TCP/IP模型

TCP/IP模型包含四层，从下到上分别是网络接口层、网络层，传输层、应用层。

**网络接口层**对应OSI模型的物理层和数据链路层，传输单位为帧，该层的主要功能是和物理介质进行交互，确保数据能够在物理网络中传输。网络接口层以mac地址标识设备，这一层包含以太网协议，该协议会在IP数据报前加上mac头形成以太网帧，用于物理传输。以太网协议的MTU为1500字节，超过该大小的数据会分片传输。

**网络层**对应OSI模型的网络层，传输单位为数据包。网络层功能为将数据进行路由和转发，选择最佳路径将数据从源主机传输到目的主机。网络层的主要具体实现是IP协议，IP协议会为每一台主机分配一个IP地址，在IPv4中该地址的长度为32位，IPv6中该地址的长度位128位。IP协议可以通过子网掩码，将IP地址划分为网络号和主机号，提高地址的分配效率。

**传输层**对应OSI模型的传输层，传输单位为TCP报文段或者UDP用户数据报。传输层负责端到端的数据传输，提供可靠的、无连接的数据传输服务。该层包含TCP协议和UDP协议。TCP协议提供的是可靠传输，通过超时重传、流量控制保证数据的可靠性和顺序性，适用于对数据可靠性要求较高的场景，如网页浏览，文件传输。UDP协议提供的是不可靠传输，只将数据发送出去，不考虑数据是否到达或者顺序是否正确。传输速度快，适用于音视频通话，网络直播的场景。UDP协议可以通过在应用层通过添加重传、校验等额外的机制使其变为可靠传输，但这样做也增加了UDP协议的复杂性。

**应用层**与OSI模型的会话层、表示层、应用层类似。该层提供直接与应用用户程序交互的接口,为网络上各种应用程序提供服务。主要协议有HTTP，FTP，SMTP等。

## * 从输入 URL 到页面展示到底发生了什么？

首先在输入URL后，浏览器会先检查浏览器缓存内是否有该URL的资源，如果有则直接展现出来，如果没有则会进行DNS域名解析，来获取URL的IP地址。

浏览器在进行DNS解析时，会依次查询浏览器缓存，本地Host文件，路由器缓存，DNS服务器，DNS根服务器。直到查找到URL的IP，DNS解析就算完成了。

DNS解析完成后，浏览器会通过TCP三次挥手和服务器建立连接，浏览器会构建请求头，请求行等信息。构建过程中会将Cookie等信息存到请求头中，构建完成后会向服务器发送HTTP请求，如果是HTTPS，还涉及到HTTPS的加解密流程。

服务器接收到浏览器发送的请求后，会生成响应数据并返回给浏览器。

浏览器接收到数据后和服务器进行TCP四次挥手断开连接，并开始解析数据，如果接收到的数据的请求头中含有301，302等状态码，则会重定向到新的地址；如果接收到的数据是字节流，浏览器会将请求提交给下载管理器；如果接收到的数据为HTML类型，浏览器则会构建DOM树，并将CSS样式和DOM树合并，构建出渲染树；最后布局和绘制渲染树，完成页面展示。

