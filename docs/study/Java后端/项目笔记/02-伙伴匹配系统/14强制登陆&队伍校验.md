# 14 å¼ºåˆ¶ç™»é™†+é˜Ÿä¼æ ¡éªŒ

## é±¼çš®ç¬”è®°

### ä¼˜åŒ–ã€ä¸Šçº¿

1ã€å¼ºåˆ¶ç™»å½•ï¼Œè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ  
è§£å†³ï¼šaxios å…¨å±€é…ç½®å“åº”æ‹¦æˆªã€å¹¶ä¸”æ·»åŠ é‡å®šå‘  
2ã€åŒºåˆ†å…¬å¼€å’ŒåŠ å¯†æˆ¿é—´ï¼›åŠ å…¥æœ‰å¯†ç çš„æˆ¿é—´ï¼Œè¦æŒ‡å®šå¯†ç   
3ã€å±•ç¤ºå·²åŠ å…¥é˜Ÿä¼äººæ•°  
4ã€é‡å¤åŠ å…¥é˜Ÿä¼çš„é—®é¢˜ï¼ˆåŠ é”ã€åˆ†å¸ƒå¼é”ï¼‰å¹¶å‘è¯·æ±‚æ—¶å¯èƒ½å‡ºç°é—®é¢˜  
**åˆ†å¸ƒå¼é”**



### ä¸Šçº¿


å…ˆåŒºåˆ†å¤šç¯å¢ƒï¼šå‰ç«¯åŒºåˆ†å¼€å‘å’Œçº¿ä¸Šæ¥å£ï¼Œåç«¯ prod æ”¹ä¸ºç”¨çº¿ä¸Šå…¬ç½‘å¯è®¿é—®çš„æ•°æ®åº“  
å‰ç«¯ï¼šVercelï¼ˆå…è´¹ï¼‰  
[https://vercel.com/](https://vercel.com/)  
åç«¯ï¼šå¾®ä¿¡äº‘æ‰˜ç®¡ï¼ˆéƒ¨ç½²å®¹å™¨çš„å¹³å°ï¼Œä»˜è´¹ï¼‰  
[https://cloud.weixin.qq.com/cloudrun/service](https://cloud.weixin.qq.com/cloudrun/service)  
**ï¼ˆå…å¤‡æ¡ˆï¼ï¼ï¼ï¼‰**



## ä¸€ã€todo


![1669515017093-57f9016f-8f91-4bdf-a50f-cf6e1717444b.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669515017093-57f9016f-8f91-4bdf-a50f-cf6e1717444b-177307.png)



### 1ã€å¼ºåˆ¶ç™»å½•ï¼Œè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ


è§£å†³ï¼šaxios å…¨å±€é…ç½®å“åº”æ‹¦æˆªã€å¹¶ä¸”æ·»åŠ é‡å®šå‘  
1.åœ¨myAxiosé‡Œé…ç½®å“åº”æ‹¦æˆª



![1669519375086-b917e48e-9954-4363-a16d-6161d70a98f1.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669519375086-b917e48e-9954-4363-a16d-6161d70a98f1-107134.png)



è¿™é‡Œæˆ‘ä»¬è¦æ”¹å˜history æ¨¡å¼çš„å®ç°ï¼Œåœ¨main.tsé‡Œä¿®æ”¹  
![1669519448606-950a00a4-1623-4520-a4e3-a0682be65113.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669519448606-950a00a4-1623-4520-a4e3-a0682be65113-043443.png)



å½“ç™»å½•æˆåŠŸåï¼Œé‡å®šå‘åˆ°ä¸ªäººç”¨æˆ·é¡µé¢ Â PSï¼šåˆ«å¿˜äº†å¼•å…¥route  
![1669519490767-51417409-85ad-40a3-bd7f-1c3a369cd65c.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669519490767-51417409-85ad-40a3-bd7f-1c3a369cd65c-727492.png)



### 2.ä¿®æ”¹é˜Ÿä¼é¡µé¢çš„åŠ å…¥é˜Ÿä¼æŒ‰é’®ä¸ºåˆ›å»ºé˜Ÿä¼


åœ¨TeamPageé¡µé¢ï¼Œä¿®æ”¹åŠ å…¥é˜Ÿä¼ä¸ºåˆ›å»ºé˜Ÿä¼ï¼ˆæŒ‰é’®éƒ¨åˆ†ï¼‰  
æŠŠdoJoinTeamå…¨å±€ä¿®æ”¹ä¸ºtoAddTeam  
è¿™ä¸ªæŒ‰é’®å¤ªä¸‘äº†ï¼Œæˆ‘ä»¬æ›´æ¢å®ƒçš„æ ·å¼ï¼Œå˜æˆåœ†å½¢æ”¾åœ¨å³ä¸‹è§’  
![1669523791586-aca4dbf6-bd27-4771-ae00-071a5de2c55f.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669523791586-aca4dbf6-bd27-4771-ae00-071a5de2c55f-373160.png)  
å†™ä¸€ä¸ªå…¨å±€æ ·å¼  
![1669523774330-6c1e951d-a23e-4a9f-8053-ded1499a6da7.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669523774330-6c1e951d-a23e-4a9f-8053-ded1499a6da7-467353.png)



åœ¨main.tsä¸­å¼•å…¥  
![1669523855499-d208c19a-c670-4c7b-bf58-cc69f9902c6e.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669523855499-d208c19a-c670-4c7b-bf58-cc69f9902c6e-837380.png)



å³ä¸‹è§’çš„æŒ‰é’®ï¼š



![](https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2767/image-20230208151422077.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_11%2Ctext_U2hpZXI%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10)



### 3.åŒºåˆ†å…¬å¼€å’ŒåŠ å¯†æˆ¿é—´ï¼›åŠ å…¥æœ‰å¯†ç çš„æˆ¿é—´ï¼Œè¦æŒ‡å®šå¯†ç 


åœ¨TeamPageé¡µé¢åŠ å…¥tabsæ ‡ç­¾ï¼Œæ¥åŒºåˆ†å…¬å¼€è¿˜æ˜¯åŠ å¯†  
![1669528592956-19f3c47b-b97e-4977-8663-cba5be2aeee8.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669528592956-19f3c47b-b97e-4977-8663-cba5be2aeee8-368647.png)



åç«¯æˆ‘ä»¬ä»¥å‰æ ¹æ®çŠ¶æ€æŸ¥è¯¢åªæŸ¥è¯¢å…¬å¼€ï¼Œç°åœ¨ä¿®æ”¹ä¸ºå½“ä¸æ˜¯ç®¡ç†å‘˜å’Œç§äººæ‰ä¼šæŠ¥æƒé™é”™è¯¯



![1669528721619-295753da-1131-45ce-9b50-5a393d9c926a.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669528721619-295753da-1131-45ce-9b50-5a393d9c926a-234672.png)



å›åˆ°å‰ç«¯ï¼Œæˆ‘ä»¬åœ¨TeamPageé¡µé¢å®ç°onTabChangeæ–¹æ³•



![1669529513805-af3c984e-fac4-4e21-9efa-7aa6d2473008.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669529513805-af3c984e-fac4-4e21-9efa-7aa6d2473008-587414.png)



ä¸Šé¢å®šä¹‰çš„activeæ˜¯ä¸ºäº†é¡µé¢é»˜è®¤æ˜¾ç¤ºå…¬å¼€é˜Ÿä¼  
ä¿®æ”¹æœç´¢é˜Ÿä¼ï¼Œä¼ å…¥çŠ¶æ€



![1669529713878-c444714c-4616-4d28-b321-e608833a8b75.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669529713878-c444714c-4616-4d28-b321-e608833a8b75-027111.png)



ç°åœ¨ç‚¹å‡»å…¬å¼€å’ŒåŠ å¯†å¯ä»¥åˆ‡æ¢æŸ¥çœ‹ä¸åŒç±»å‹çš„é˜Ÿä¼  
åŠ å¯†é˜Ÿä¼éœ€è¦è¾“å…¥å¯†ç æ‰å¯ä»¥åŠ å…¥ï¼Œæˆ‘ä»¬è¿™ä½¿ç”¨Dialog å¼¹å‡ºæ¡†ç»„ä»¶ï¼ŒæŠŠå®ƒæ”¾å…¥`team-card-list.vue`é‡Œï¼ˆæœ€ä¸‹é¢çš„ä½ç½®)



```vue
    <van-dialog v-model:show="showPasswordDialog" title="è¯·è¾“å…¥å¯†ç " show-cancel-button @confirm="doJoinTeam" @cancel="doJoinCancel">
      <van-field v-model="password" placeholder="è¯·è¾“å…¥å¯†ç "/>
    </van-dialog>
```



åœ¨é‡Œé¢ä¿®æ”¹åŠ å…¥doJoinTeamæ–¹æ³•ï¼Œå®ç°doJoinCancelæ–¹æ³•å’Œåˆ¤æ–­æ˜¯ä¸æ˜¯åŠ å¯†æˆ¿é—´preJoinTeamæ–¹æ³•



```javascript
/**
 * åŠ å…¥é˜Ÿä¼
 */
const doJoinTeam = async () => {
  if (!joinTeamId.value){
    return;
  }
  const res = await myAxios.post('/team/join', {
    teamId: joinTeamId.value,
    password: password.value
  });
  if (res?.code === 0) {
    Toast.success('åŠ å…¥æˆåŠŸ');
    doJoinCancel();
  } else {
    Toast.fail('åŠ å…¥å¤±è´¥' + (res.description ? `ï¼Œ${res.description}` : ''));
  }
}

const showPasswordDialog = ref(false);
const password = ref('');
const joinTeamId = ref(0);
  
/**
 * åˆ¤æ–­æ˜¯ä¸æ˜¯åŠ å¯†æˆ¿é—´ï¼Œæ˜¯çš„è¯æ˜¾ç¤ºå¯†ç æ¡†
 * @param team
 */
const preJoinTeam = (team: TeamType) => {
  joinTeamId.value = team.id;
  if (team.status === 0) {
    doJoinTeam()
  } else {
    showPasswordDialog.value = true;
  }
}

const doJoinCancel = () => {
  joinTeamId.value = 0;
  password.value = '';
}
```



![](https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2767/image-20230208150922390.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_34%2Ctext_U2hpZXI%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10)



æµ‹è¯•åŠ å…¥é˜Ÿä¼ï¼ˆåŠ å¯†)åŠŸèƒ½æ˜¯å¦æ­£å¸¸  
å‰æï¼šæ›´æ–°æµ‹è¯•é˜Ÿä¼æ˜¯idä¸º55007åˆ›å»ºçš„ï¼Œç°åœ¨ç™»å½•çš„idæ˜¯4  
ç‚¹å‡»åŠ å…¥é˜Ÿä¼ï¼Œè¾“å…¥å¯†ç   
![1669531230967-dc3dddb9-bbef-440c-a54f-de70950242e6.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669531230967-dc3dddb9-bbef-440c-a54f-de70950242e6-153131.png)![1669531253931-b59da68f-a7b2-40ab-947d-b5ae9bb6a223.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669531253931-b59da68f-a7b2-40ab-947d-b5ae9bb6a223-466603.png)  
åˆ·æ–°ä¸€ä¸‹ï¼Œæ˜¾ç¤ºé€€å‡ºé˜Ÿä¼ï¼ŒåŠŸèƒ½æ­£å¸¸  
![1669531279236-256ccf95-e9c8-4c07-b0b0-054708036837.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669531279236-256ccf95-e9c8-4c07-b0b0-054708036837-130464.png)



### 4.å±•ç¤ºå·²åŠ å…¥é˜Ÿä¼äººæ•°


è¿™ä¸ªæˆ‘ä»¬åç«¯è¿˜æœªå®ç°ï¼Œæ‰€ä»¥åœ¨è·å–é˜Ÿä¼åˆ—è¡¨æ¥å£ï¼Œè·å–è¿™ä¸ªå‚æ•°  
é¦–å…ˆåœ¨å°è£…ç±»é‡Œæ·»åŠ å­—æ®µï¼ˆTeamUserVOï¼‰  
![1669531702567-f5665def-a328-48f3-aa54-5d0cf50774db.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669531702567-f5665def-a328-48f3-aa54-5d0cf50774db-045395.png)  
ä¿®æ”¹listTeamsæ¥å£ï¼Œä¿®æ”¹æ•´ç†ä¸ºå¦‚ä¸‹



```java
@GetMapping("/list")
    public BaseResponse<List<TeamUserVO>> listTeams(TeamQuery teamQuery, HttpServletRequest request) {
        if (teamQuery == null) {
            throw new BusinessException(ErrorCode.PARAMS_ERROR);
        }
        boolean isAdmin = userService.isAdmin(request);
        // 1ã€æŸ¥è¯¢é˜Ÿä¼åˆ—è¡¨
        List<TeamUserVO> teamList = teamService.listTeams(teamQuery, isAdmin);
        final List<Long> teamIdList = teamList.stream().map(TeamUserVO::getId).collect(Collectors.toList());
        // 2ã€åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦å·²åŠ å…¥é˜Ÿä¼
        QueryWrapper<UserTeam> userTeamQueryWrapper = new QueryWrapper<>();
        try {
            User loginUser = userService.getLoginUser(request);
            userTeamQueryWrapper.eq("userId", loginUser.getId());
            userTeamQueryWrapper.in("teamId", teamIdList);
            List<UserTeam> userTeamList = userTeamService.list(userTeamQueryWrapper);
            // å·²åŠ å…¥çš„é˜Ÿä¼ id é›†åˆ
            Set<Long> hasJoinTeamIdSet = userTeamList.stream().map(UserTeam::getTeamId).collect(Collectors.toSet());
            teamList.forEach(team -> {
                boolean hasJoin = hasJoinTeamIdSet.contains(team.getId());
                team.setHasJoin(hasJoin);
            });
        } catch (Exception e) {}
        // 3ã€æŸ¥è¯¢å·²åŠ å…¥é˜Ÿä¼çš„äººæ•°
        QueryWrapper<UserTeam> userTeamJoinQueryWrapper = new QueryWrapper<>();
        userTeamJoinQueryWrapper.in("teamId", teamIdList);
        List<UserTeam> userTeamList = userTeamService.list(userTeamJoinQueryWrapper);
        // é˜Ÿä¼ id => åŠ å…¥è¿™ä¸ªé˜Ÿä¼çš„ç”¨æˆ·åˆ—è¡¨
        Map<Long, List<UserTeam>> teamIdUserTeamList = userTeamList.stream().collect(Collectors.groupingBy(UserTeam::getTeamId));
        teamList.forEach(team -> team.setHasJoinNum(teamIdUserTeamList.getOrDefault(team.getId(), new ArrayList<>()).size()));
        return ResultUtils.success(teamList);
    }
```



åœ¨å‰ç«¯çš„TeamCardListé‡Œä¿®æ”¹åŸæ¥çš„æœ€å¤§äººæ•°ä¸ºå·²åŠ å…¥äººæ•°  
![1669531854999-ff12e744-e99a-4907-8a9a-4fde3f357bb8.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669531854999-ff12e744-e99a-4907-8a9a-4fde3f357bb8-159881.png)



å¦‚æœçˆ†çº¢çš„åœ¨é˜Ÿä¼è§„èŒƒç±»å‹é‡Œæ·»åŠ å­—æ®µ  
![1669531903563-317d652b-d70b-4ace-a424-dacd5f5478d2.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669531903563-317d652b-d70b-4ace-a424-dacd5f5478d2-006834.png)  
åˆ·æ–°é¡µé¢ï¼ŒæˆåŠŸæ˜¾ç¤ºè¿˜å½“å‰é˜Ÿä¼äººæ•°å’Œæœ€å¤§äººæ•°  
![1669532183194-89a4d9fd-00ad-4eea-909e-87fdee92c2e6.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669532183194-89a4d9fd-00ad-4eea-909e-87fdee92c2e6-130886.png)



### 5.é‡å¤åŠ å…¥é˜Ÿä¼çš„é—®é¢˜ï¼ˆåŠ é”ã€åˆ†å¸ƒå¼é”ï¼‰å¹¶å‘è¯·æ±‚æ—¶å¯èƒ½å‡ºç°é—®é¢˜


åªè¦æˆ‘ä»¬ç‚¹çš„è¶³å¤Ÿå¿«ï¼Œå°±å¯ä»¥åœ¨åŒä¸€æ—¶é—´å†…å¾€æ•°æ®åº“æ’å…¥å¤šæ¡åŒæ ·çš„æ•°æ®ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨åˆ†å¸ƒå¼é”ï¼ˆæ¨èï¼‰  
ä½¿ç”¨ä¸¤æŠŠé”ï¼Œä¸€æŠŠé”é”é˜Ÿä¼ï¼Œä¸€æŠŠé”é”ç”¨æˆ·ï¼ˆå®ç°è¾ƒéš¾ï¼Œä¸æ¨èï¼‰  
ä¿®æ”¹jointeamçš„å®ç°æ–¹æ³•



```java
    @Override
    public boolean joinTeam(TeamJoinRequest teamJoinRequest, User loginUser) {
        if (teamJoinRequest == null) {
            throw new BusinessException(ErrorCode.PARAMS_ERROR);
        }
        Long teamId = teamJoinRequest.getTeamId();
        Team team = getTeamById(teamId);
        Date expireTime = team.getExpireTime();
        if (expireTime != null && expireTime.before(new Date())) {
            throw new BusinessException(ErrorCode.PARAMS_ERROR, "é˜Ÿä¼å·²è¿‡æœŸ");
        }
        Integer status = team.getStatus();
        TeamStatusEnum teamStatusEnum = TeamStatusEnum.getEnumByValue(status);
        if (TeamStatusEnum.PRIVATE.equals(teamStatusEnum)) {
            throw new BusinessException(ErrorCode.PARAMS_ERROR, "ç¦æ­¢åŠ å…¥ç§æœ‰é˜Ÿä¼");
        }
        String password = teamJoinRequest.getPassword();
        if (TeamStatusEnum.SECRET.equals(teamStatusEnum)) {
            if (StringUtils.isBlank(password) || !password.equals(team.getPassword())) {
                throw new BusinessException(ErrorCode.PARAMS_ERROR, "å¯†ç é”™è¯¯");
            }
        }
        // è¯¥ç”¨æˆ·å·²åŠ å…¥çš„é˜Ÿä¼æ•°é‡
        long userId = loginUser.getId();
        // åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è·å–åˆ°é”
        RLock lock = redissonClient.getLock("yupao:join_team");
        try {
            // æŠ¢åˆ°é”å¹¶æ‰§è¡Œ
            while (true) {
                if (lock.tryLock(0, -1, TimeUnit.MILLISECONDS)) {
                    System.out.println("getLock: " + Thread.currentThread().getId());
                    QueryWrapper<UserTeam> userTeamQueryWrapper = new QueryWrapper<>();
                    userTeamQueryWrapper.eq("userId", userId);
                    long hasJoinNum = userTeamService.count(userTeamQueryWrapper);
                    if (hasJoinNum > 5) {
                        throw new BusinessException(ErrorCode.PARAMS_ERROR, "æœ€å¤šåˆ›å»ºå’ŒåŠ å…¥ 5 ä¸ªé˜Ÿä¼");
                    }
                    // ä¸èƒ½é‡å¤åŠ å…¥å·²åŠ å…¥çš„é˜Ÿä¼
                    userTeamQueryWrapper = new QueryWrapper<>();
                    userTeamQueryWrapper.eq("userId", userId);
                    userTeamQueryWrapper.eq("teamId", teamId);
                    long hasUserJoinTeam = userTeamService.count(userTeamQueryWrapper);
                    if (hasUserJoinTeam > 0) {
                        throw new BusinessException(ErrorCode.PARAMS_ERROR, "ç”¨æˆ·å·²åŠ å…¥è¯¥é˜Ÿä¼");
                    }
                    // å·²åŠ å…¥é˜Ÿä¼çš„äººæ•°
                    long teamHasJoinNum = this.countTeamUserByTeamId(teamId);
                    if (teamHasJoinNum >= team.getMaxNum()) {
                        throw new BusinessException(ErrorCode.PARAMS_ERROR, "é˜Ÿä¼å·²æ»¡");
                    }
                    // ä¿®æ”¹é˜Ÿä¼ä¿¡æ¯ 
                    UserTeam userTeam = new UserTeam();
                    userTeam.setUserId(userId);
                    userTeam.setTeamId(teamId);
                    userTeam.setJoinTime(new Date());
                    return userTeamService.save(userTeam);
                }
            }
        } catch (InterruptedException e) {
            log.error("doCacheRecommendUser error", e);
            return false;
        } finally {
            // åªèƒ½é‡Šæ”¾è‡ªå·±çš„é”
            if (lock.isHeldByCurrentThread()) {
                System.out.println("unLock: " + Thread.currentThread().getId());
                lock.unlock();
            }
        }
    }
```



åˆ«å¿˜äº†å¼•å…¥ Â  Â RedissonClient  
![1669533277863-4427bdd4-b34a-429e-a3b8-ad7b75f417bf.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669533277863-4427bdd4-b34a-429e-a3b8-ad7b75f417bf-255449.png)  
**é¡¹ç›®åŸºæœ¬å®Œæˆ**



## äºŒã€éƒ¨ç½²ä¸Šçº¿


å…ˆåŒºåˆ†å¤šç¯å¢ƒï¼šå‰ç«¯åŒºåˆ†å¼€å‘å’Œçº¿ä¸Šæ¥å£ï¼Œåç«¯ prod æ”¹ä¸ºç”¨çº¿ä¸Šå…¬ç½‘å¯è®¿é—®çš„æ•°æ®åº“  
å‰ç«¯ï¼šVercelï¼ˆå…è´¹ï¼‰  
[https://vercel.com/](https://vercel.com/)  
åç«¯ï¼šå¾®ä¿¡äº‘æ‰˜ç®¡ï¼ˆéƒ¨ç½²å®¹å™¨çš„å¹³å°ï¼Œä»˜è´¹ï¼‰  
[https://cloud.weixin.qq.com/cloudrun/service](https://cloud.weixin.qq.com/cloudrun/service)  
**ï¼ˆå…å¤‡æ¡ˆï¼ï¼ï¼ï¼‰**



**è¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ï¼ˆå¯ä»¥çœ‹ç”¨æˆ·ä¸­å¿ƒç›´æ’­å’Œå›½åº†ä¸ƒå¤©çš„ç›´æ’­å­¦ä¹ ï¼‰**  
æ³¨æ„å¦‚æœåç«¯ä½¿ç”¨å¾®ä¿¡äº‘æ‰˜ç®¡ï¼Œä¸€å®šè¦å†™ä¸€ä¸ªdokerfile



```vue
FROM maven:3.5-jdk-8-alpine as builder

# Copy local code to the container image.
WORKDIR /app
COPY pom.xml .
COPY src ./src

# Build a release artifact.
RUN mvn package -DskipTests

# Run the web service on container startup.
CMD ["java","-jar","/app/target/yupao-backend-0.0.1-SNAPSHOT.jar","--spring.profiles.active=prod"]
```



å‰ç«¯éƒ¨ç½²éœ€è¦åŒºåˆ†çº¿ä¸Šå’Œæœ¬åœ°ç¯å¢ƒ  
é¦–å…ˆæ‰“åŒ…å¦‚æœæŠ¥é”™ï¼ˆå¤§æ¦‚ç‡æ˜¯å› ä¸ºtsè¯­æ³•çš„æ£€æŸ¥ï¼‰ï¼Œåœ¨packjsoné‡Œä¿®æ”¹build  
![1669534666307-348c7af2-cdbf-4528-919c-5acead223b05.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669534666307-348c7af2-cdbf-4528-919c-5acead223b05-339959.png)  
åŒºåˆ†ç¯å¢ƒ  
åœ¨myAxiosé‡Œé…ç½®ï¼ˆå®ç°è‡ªåŠ¨æ ¹æ®ç¯å¢ƒæ¥æ›´æ¢åœ°å€ï¼‰  
![1669534797087-94f5913c-e04c-4ad8-999c-b3f1d19c5508.png](./assets/14å¼ºåˆ¶ç™»é™†&é˜Ÿä¼æ ¡éªŒ/1669534797087-94f5913c-e04c-4ad8-999c-b3f1d19c5508-481984.png)



![](https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2767/image-20230208205518719.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_9%2Ctext_U2hpZXI%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10)



## ç¬¬åå››æœŸ ä¼™ä¼´åŒ¹é…ç³»ç»Ÿç¬”è®°å®Œç»“ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰


> æ›´æ–°: 2023-02-10 10:10:34  
> åŸæ–‡: <https://www.yuque.com/shierkcs/catstudy/cxu6sg2ebml2y3w6>